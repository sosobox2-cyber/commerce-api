<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
        "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="pacommon.pacommon">

    <insert id="insertPaOrderM" parameterType="com.cware.netshopping.domain.model.Paorderm" >
		INSERT INTO TPAORDERM( /* pacommon.xml : pacommon.common.insertPaOrderM */
	        MAPPING_SEQ
	      , PA_CODE
	      , PA_ORDER_GB
	      , PA_ORDER_NO
	      , PA_ORDER_SEQ
	      , PA_SHIP_NO
	      , PA_SHIP_SEQ
	      , PA_CLAIM_NO
	      , PA_PROC_QTY
	      , PA_DO_FLAG
	      , OUT_BEF_CLAIM_GB
	      , CHANGE_GOODS_CODE
	      , CHANGE_GOODSDT_CODE
	      , CHANGE_FLAG
	      , INSERT_DATE
	      , MODIFY_ID
	      , MODIFY_DATE
	      , PA_GROUP_CODE
	      , API_RESULT_CODE
	      , API_RESULT_MESSAGE
	      , CREATE_YN
	      <if test='paGroupCode != null and paGroupCode == "10" and remark1V != null and remark1V != ""'>
	      , REMARK1_V
	      </if>
	      <if test='paGroupCode != null and paGroupCode == "08" and remark6V != null and remark6V != ""'>
	      , REMARK6_V
	      </if>
	        )
		VALUES
           (SEQ_PAORDERM_SEQ.NEXTVAL
          , #{paCode,            	jdbcType=VARCHAR}
          , #{paOrderGb,         	jdbcType=VARCHAR}
          , #{paOrderNo,        	jdbcType=VARCHAR}
          , #{paOrderSeq,           jdbcType=VARCHAR}
          , #{paShipNo,         	jdbcType=VARCHAR}
          , #{paShipSeq,  	        jdbcType=VARCHAR}          
          , #{paClaimNo,   	        jdbcType=VARCHAR}
          , #{paProcQty,   	        jdbcType=VARCHAR}
          , #{paDoFlag,   	        jdbcType=VARCHAR}
          , #{outBefClaimGb,        jdbcType=VARCHAR}
          , #{changeGoodsCode,      jdbcType=VARCHAR}
          , #{changeGoodsdtCode,    jdbcType=VARCHAR}
          , #{changeFlag,           jdbcType=VARCHAR}
          , #{insertDate,           jdbcType=TIMESTAMP}
          , #{modifyId,             jdbcType=VARCHAR}
          , #{modifyDate,           jdbcType=TIMESTAMP} 
          , NVL(#{paGroupCode,      jdbcType=VARCHAR}, '01' )
          , #{apiResultCode,      	jdbcType=VARCHAR}
          , #{apiResultMessage,     jdbcType=VARCHAR}
          , NVL(#{createYn,         jdbcType=VARCHAR}, '0' )
          <if test='paGroupCode != null and paGroupCode == "10" and remark1V != null and remark1V != ""'>
          , #{remark1V,             jdbcType=VARCHAR}
          </if>
          <if test='paGroupCode != null and paGroupCode == "08" and remark6V != null and remark6V != ""'>
          , #{remark6V,             jdbcType=VARCHAR}
          </if>
          )
    </insert>
    
    <update id="updatePaOrderM" parameterType="com.cware.netshopping.domain.model.Paorderm" >
    	UPDATE /* pacommon.xml : pacommon.common.update updatePaOrderM*/
    		   TPAORDERM T
    	   SET T.PA_DO_FLAG 	= #{paDoFlag,   jdbcType=VARCHAR}
    	     , T.MODIFY_DATE	= #{modifyDate, jdbcType=TIMESTAMP}
    	 WHERE T.PA_ORDER_NO	= #{paOrderNo,  jdbcType=VARCHAR}
    	   AND T.PA_ORDER_SEQ	= #{paOrderSeq, jdbcType=VARCHAR}
    	   AND T.PA_CLAIM_NO   	= #{paClaimNo,  jdbcType=VARCHAR}
    </update>
    
    <delete id="deletePaGoodsKindsListMoment" parameterType="String">
        DELETE /* pacommon.xml : pacommon.common.deletePaGoodsKindsListMoment */ 
          FROM TPAGOODSKINDSMOMENT
         WHERE PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </delete>
    
    <insert id="insertPaGoodsKindsListMoment" parameterType="com.cware.netshopping.domain.model.PaGoodsKinds">
        INSERT /* pacommon.xml : pacommon.common.insertPaGoodsKindsListMoment */
          INTO TPAGOODSKINDSMOMENT
             ( PA_GROUP_CODE
             , PA_LMSD_KEY
             , PA_LGROUP
             , PA_MGROUP
             , PA_SGROUP
             , PA_DGROUP
             , PA_LGROUP_NAME
             , PA_MGROUP_NAME
             , PA_SGROUP_NAME
             , PA_DGROUP_NAME
             , LIFE_CERT_YN
             , ELECTRIC_CERT_YN
             , CHILD_CERT_YN
             , MEDICAL_YN
             , HEALTH_YN
             , FOOD_YN
             , REMARK )
        VALUES 
             ( #{paGroupCode, jdbcType=VARCHAR}
             , decode(#{paGroupCode, jdbcType=VARCHAR},'07',#{paLmsdKey, jdbcType=VARCHAR},nvl(#{paDgroup, jdbcType=VARCHAR}, #{paSgroup, jdbcType=VARCHAR}))
             , #{paLgroup, jdbcType=VARCHAR}
             , #{paMgroup, jdbcType=VARCHAR}
             , #{paSgroup, jdbcType=VARCHAR}
             , #{paDgroup, jdbcType=VARCHAR}
             , #{paLgroupName, jdbcType=VARCHAR}
             , #{paMgroupName, jdbcType=VARCHAR}
             , #{paSgroupName, jdbcType=VARCHAR}
             , #{paDgroupName, jdbcType=VARCHAR}
             , DECODE(#{lifeCertYn, jdbcType=VARCHAR},'Y','1','0')
             , DECODE(#{electricCertYn, jdbcType=VARCHAR},'Y','1','0')
             , DECODE(#{childCertYn, jdbcType=VARCHAR},'Y','1','0')
             , DECODE(#{medicalYn, jdbcType=VARCHAR},'Y','1','0')
             , DECODE(#{healthYn, jdbcType=VARCHAR},'Y','1','0')
             , DECODE(#{foodYn, jdbcType=VARCHAR},'Y','1','0')
             , DECODE(#{remark, jdbcType=VARCHAR},'null','',#{remark, jdbcType=VARCHAR})
             )  
    </insert>
    
    <insert id="insertPaGoodsKindsList" parameterType="com.cware.netshopping.domain.model.PaGoodsKinds">
        INSERT /* pacommon.xml : pacommon.common.insertPaGoodsKindsList */
          INTO TPAGOODSKINDS
             ( PA_GROUP_CODE
             , PA_LMSD_KEY
             , PA_LGROUP
             , PA_MGROUP
             , PA_SGROUP
             , PA_DGROUP
             , PA_LGROUP_NAME
             , PA_MGROUP_NAME
             , PA_SGROUP_NAME
             , PA_DGROUP_NAME
             , USE_YN
             , INSERT_DATE
             , INSERT_ID
             , MODIFY_DATE
             , MODIFY_ID
             , LIFE_CERT_YN
             , ELECTRIC_CERT_YN
             , CHILD_CERT_YN
             , MEDICAL_YN
             , HEALTH_YN
             , FOOD_YN
             , REMARK )
        SELECT KM.PA_GROUP_CODE
             , KM.PA_LMSD_KEY
             , KM.PA_LGROUP
             , KM.PA_MGROUP
             , KM.PA_SGROUP
             , KM.PA_DGROUP
             , KM.PA_LGROUP_NAME
             , KM.PA_MGROUP_NAME
             , KM.PA_SGROUP_NAME
             , KM.PA_DGROUP_NAME
             , '1'
             , #{insertDate, jdbcType=TIMESTAMP}
             , UPPER(#{insertId, jdbcType=VARCHAR})
             , #{insertDate, jdbcType=TIMESTAMP}
             , UPPER(#{insertId, jdbcType=VARCHAR})
             , LIFE_CERT_YN
             , ELECTRIC_CERT_YN
             , CHILD_CERT_YN
             , MEDICAL_YN
             , HEALTH_YN
             , FOOD_YN
             , KM.REMARK
          FROM TPAGOODSKINDSMOMENT KM
         WHERE 1=1
           AND KM.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND NOT EXISTS ( SELECT 'X'
                              FROM TPAGOODSKINDS GK
                             WHERE GK.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
                               AND GK.PA_LMSD_KEY = KM.PA_LMSD_KEY
                          )
    </insert>
    
    <update id="updatePaGoodsKindsList" parameterType="com.cware.netshopping.domain.model.PaGoodsKinds">
        UPDATE /* pacommon.xml : pacommon.common.updatePaGoodsKindsList */
             ( SELECT GK.PA_LGROUP AS OLD_PA_LGROUP
                    , GK.PA_MGROUP AS OLD_PA_MGROUP
                    , GK.PA_SGROUP AS OLD_PA_SGROUP
                    , GK.PA_DGROUP AS OLD_PA_DGROUP
                    , GK.PA_LGROUP_NAME AS OLD_PA_LGROUP_NAME
                    , GK.PA_MGROUP_NAME AS OLD_PA_MGROUP_NAME
                    , GK.PA_SGROUP_NAME AS OLD_PA_SGROUP_NAME
                    , GK.PA_DGROUP_NAME AS OLD_PA_DGROUP_NAME
                    , GK.LIFE_CERT_YN		AS OLD_LIFE_CERT_YN
                    , GK.ELECTRIC_CERT_YN	AS OLD_ELECTRIC_CERT_YN
                    , GK.CHILD_CERT_YN 		AS OLD_CHILD_CERT_YN
                    , GK.MEDICAL_YN			AS OLD_MEDICAL_YN
                    , GK.HEALTH_YN			AS OLD_HEALTH_YN
                    , GK.FOOD_YN			AS OLD_FOOD_YN
                    , GK.MODIFY_DATE AS MODIFY_DATE
                    , GK.MODIFY_ID AS MODIFY_ID
                    , GKM.PA_LGROUP AS NEW_PA_LGROUP
                    , GKM.PA_MGROUP AS NEW_PA_MGROUP
                    , GKM.PA_SGROUP AS NEW_PA_SGROUP
                    , GKM.PA_DGROUP AS NEW_PA_DGROUP
                    , GKM.PA_LGROUP_NAME AS NEW_PA_LGROUP_NAME
                    , GKM.PA_MGROUP_NAME AS NEW_PA_MGROUP_NAME
                    , GKM.PA_SGROUP_NAME AS NEW_PA_SGROUP_NAME
                    , GKM.PA_DGROUP_NAME AS NEW_PA_DGROUP_NAME
                    , GKM.LIFE_CERT_YN		AS NEW_LIFE_CERT_YN
                    , GKM.ELECTRIC_CERT_YN	AS NEW_ELECTRIC_CERT_YN
                    , GKM.CHILD_CERT_YN 	AS NEW_CHILD_CERT_YN
                    , GKM.MEDICAL_YN		AS NEW_MEDICAL_YN
                    , GKM.HEALTH_YN			AS NEW_HEALTH_YN
                    , GKM.FOOD_YN			AS NEW_FOOD_YN
                    , GK.USE_YN AS USE_YN
                 FROM TPAGOODSKINDS GK
                    , TPAGOODSKINDSMOMENT GKM
                WHERE GK.PA_LMSD_KEY = GKM.PA_LMSD_KEY
                  AND GK.PA_GROUP_CODE = GKM.PA_GROUP_CODE
                  AND GK.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
                  AND (GK.PA_LGROUP_NAME != GKM.PA_LGROUP_NAME
                    OR GK.PA_MGROUP_NAME != GKM.PA_MGROUP_NAME
                    OR GK.PA_SGROUP_NAME != GKM.PA_SGROUP_NAME
                    OR GK.PA_DGROUP_NAME != GKM.PA_DGROUP_NAME
                    OR GK.PA_LGROUP != GKM.PA_LGROUP
                    OR GK.PA_MGROUP != GKM.PA_MGROUP
                    OR GK.PA_SGROUP != GKM.PA_SGROUP
                    OR GK.PA_DGROUP != GKM.PA_DGROUP                    
                    OR GK.USE_YN != '1'                    
                    )
               )
           SET OLD_PA_LGROUP = NEW_PA_LGROUP
             , OLD_PA_MGROUP = NEW_PA_MGROUP
             , OLD_PA_SGROUP = NEW_PA_SGROUP
             , OLD_PA_DGROUP = NEW_PA_DGROUP
             , OLD_PA_LGROUP_NAME = NEW_PA_LGROUP_NAME
             , OLD_PA_MGROUP_NAME = NEW_PA_MGROUP_NAME
             , OLD_PA_SGROUP_NAME = NEW_PA_SGROUP_NAME
             , OLD_PA_DGROUP_NAME = NEW_PA_DGROUP_NAME
             , OLD_LIFE_CERT_YN 	= NEW_LIFE_CERT_YN
             , OLD_ELECTRIC_CERT_YN = NEW_ELECTRIC_CERT_YN
             , OLD_CHILD_CERT_YN 	= NEW_CHILD_CERT_YN
             , OLD_MEDICAL_YN 		= NEW_MEDICAL_YN
             , OLD_HEALTH_YN 		= NEW_HEALTH_YN
             , OLD_FOOD_YN 			= NEW_FOOD_YN
             , USE_YN = '1'
             , MODIFY_ID = UPPER(#{modifyId, jdbcType=VARCHAR})
             , MODIFY_DATE = #{modifyDate, jdbcType=TIMESTAMP}
    </update>
    
    <update id="updatePaGoodsKindsListUseYn" parameterType="com.cware.netshopping.domain.model.PaGoodsKinds">
        UPDATE /* pacommon.xml : pacommon.common.updatePaGoodsKindsListUseYn */
               TPAGOODSKINDS GK
           SET GK.USE_YN = '0'
             , GK.MODIFY_ID = UPPER(#{modifyId, jdbcType=VARCHAR})
             , GK.MODIFY_DATE = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE GK.USE_YN = '1'
           AND GK.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND NOT EXISTS ( SELECT 'X'
                              FROM TPAGOODSKINDSMOMENT GKM
                             WHERE GK.PA_LMSD_KEY = GKM.PA_LMSD_KEY
                               AND GKM.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
                          )
    </update>
    
    
    <insert id="insertPaGoodsTransLog" parameterType="com.cware.netshopping.domain.model.PaGoodsTransLog">
        INSERT INTO /* pacommon.xml : pacommon.common.insertPaGoodsTransLog */
                    TPAGOODSTRANSLOG
                   ( TRANS_SEQ
                   , GOODS_CODE
                   , PA_CODE
                   , ITEM_NO
                   , SUCCESS_YN
                   , RTN_CODE
                   , RTN_MSG
                   , PROC_DATE
                   , PROC_ID
                   )  
            VALUES ( TO_CHAR(SYSDATE,'YYMMDD')||LPAD(SEQ_PA_GOODS_TRANS.NEXTVAL,'7','0')
                   , #{goodsCode, jdbcType=VARCHAR}
                   , #{paCode, jdbcType=VARCHAR}
                   , #{itemNo, jdbcType=VARCHAR}
                   , #{successYn, jdbcType=VARCHAR}
                   , NVL(#{rtnCode, jdbcType=VARCHAR},'999')
                   , NVL(#{rtnMsg, jdbcType=VARCHAR},'ERROR')
                   , NVL(#{procDate, jdbcType=TIMESTAMP},SYSDATE)
                   , NVL(#{procId, jdbcType=VARCHAR},'999999')
                   )
    </insert>
    
    <select id="selectCheckOpenApiCode" resultType="String">
        SELECT /* pacommon.xml : pacommon.common.selectCheckOpenApiCode */
               DECODE(  cware_enc_dec( TC.CODE_NAME,'E'),#{openApiCode , jdbcType=VARCHAR},'Y','N') AS CHECK_RESULT
          FROM TCODE TC
         WHERE TC.CODE_LGROUP = 'B713'  
           AND TC.CODE_MGROUP = #{paCode , jdbcType=VARCHAR}           
    </select>
    
    <select id="selectGoodsSaleGb" parameterType="String" resultType="String" >
        SELECT /* pacommon.xml : pacommon.common.selectGoodsSaleGb*/
               FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB 
          FROM TGOODS GD
         WHERE GD.GOODS_CODE = #{goodsCode , jdbcType=VARCHAR}
    </select>
    
    <delete id="deletePa11stSettlementList" parameterType="String">
        DELETE /* pacommon.xml : pacommon.common.deletePa11stSettlementList */ 
          FROM TPA11STSETTLEMENT
         WHERE GATHER_DATE = TO_DATE(#{gatherDate, jdbcType=VARCHAR},'YYYY/MM/DD')
    </delete>
    
    <insert id="insertPa11stSettlementList" parameterType="com.cware.netshopping.domain.model.Pa11stSettlement">
        INSERT /* pacommon.xml : pacommon.common.insertPa11stSettlementList */
          INTO TPA11STSETTLEMENT
             ( 
               GATHER_DATE
              ,ORD_NO
              ,ORD_PRD_SEQ
              ,ORD_QTY
              ,ABRD_CN_DLV_CST
              ,ADD_CLM_DLV_CST
              ,BM_CLM_FST_DLV_CST
              ,BM_STL_DLV_CST
              ,CLM_DLV_CST
              ,CLM_FST_DLV_CST
              ,COUPN_AMT
              ,DEBA_GTN_STL_AMT
              ,DEDUCT_AMT
              ,DLV_AMT
              ,DLV_NO
              ,FEE_TYPE_NM
              ,MEM_ID
              ,MEM_NM
              ,OPT_AMT
              ,ORD_STL_END_DT
              ,PROCNFRM_DT
              ,PRD_NM
              ,PRD_NO
              ,SEL_FEE
              ,SEL_FIXED_FEE
              ,SEL_PRC
              ,SEL_PRC_AMT
              ,SELLER_CUPN_AMT
              ,SELLER_DFRM_APP_DLV_AMT
              ,SELLER_DFRM_CHP_CST_PRD
              ,SELLER_DFRM_DEFERRE_AD_FEE
              ,SELLER_DFRM_INTFREE_FEE
              ,SELLER_DFRM_MULTI_DSC_CST
              ,SELLER_DFRM_OCB_AMT
              ,SELLER_DFRM_PNT_PRD
              ,SELLER_PRD_NO
              ,SEQ_NO
              ,SLCT_PRD_OPT_NO
              ,SND_END_DT
              ,STL_AMT
              ,STL_PLN_DY
              ,TMALL_APPLY_DSC_AMT
              ,TMALL_OVER_DSC_AMT
              ,TOTAL_COUNT
            )
        VALUES 
             ( 
              TO_DATE(#{gatherDate, jdbcType=VARCHAR},'YYYY/MM/DD')
             ,#{ordNo, jdbcType=VARCHAR}
             ,#{ordPrdSeq, jdbcType=VARCHAR}
             ,#{ordQty, jdbcType=NUMERIC}
             ,#{abrdCnDlvCst, jdbcType=NUMERIC}
             ,#{addClmDlvCst, jdbcType=NUMERIC}
             ,#{bmClmFstDlvCst, jdbcType=NUMERIC}
             ,#{bmStlDlvCst, jdbcType=NUMERIC}
             ,#{clmDlvCst, jdbcType=NUMERIC}
             ,#{clmFstDlvCst, jdbcType=NUMERIC}
             ,#{cupnAmt, jdbcType=NUMERIC}
             ,#{debaGtnStlAmt, jdbcType=NUMERIC}
             ,#{deductAmt, jdbcType=NUMERIC}
             ,#{dlvAmt, jdbcType=NUMERIC}
             ,#{dlvNo, jdbcType=NUMERIC}
             ,#{feeTypeNm, jdbcType=VARCHAR}
             ,#{memId, jdbcType=VARCHAR}
             ,#{memNm, jdbcType=VARCHAR}
             ,#{optAmt, jdbcType=NUMERIC}
             ,TO_DATE(#{ordStlEndDt, jdbcType=VARCHAR},'YYYY/MM/DD')
             ,TO_DATE(#{pocnfrmDt, jdbcType=VARCHAR},'YYYY/MM/DD')
             ,#{prdNm, jdbcType=VARCHAR}
             ,#{prdNo, jdbcType=NUMERIC}
             ,#{selFee, jdbcType=NUMERIC}
             ,#{selFixedFee, jdbcType=VARCHAR}
             ,#{selPrc, jdbcType=NUMERIC}
             ,#{selPrcAmt, jdbcType=NUMERIC}
             ,#{sellerCupnAmt, jdbcType=NUMERIC}
             ,#{sellerDfrmAppDlvAmt, jdbcType=NUMERIC}
             ,#{sellerDfrmChpCstPrd, jdbcType=NUMERIC}
             ,#{sellerDfrmDeferredAdFee, jdbcType=NUMERIC}
             ,#{sellerDfrmIntfreeFee, jdbcType=NUMERIC}
             ,#{sellerDfrmMultiDscCst, jdbcType=NUMERIC}
             ,#{sellerDfrmOcbAmt, jdbcType=NUMERIC}
             ,#{sellerDfrmPntPrd, jdbcType=NUMERIC}
             ,#{sellerPrdNo, jdbcType=VARCHAR}
             ,#{seqNo, jdbcType=NUMERIC}
             ,#{slctPrdOptNm, jdbcType=VARCHAR}
             ,TO_DATE(#{sndEndDt, jdbcType=VARCHAR},'YYYY/MM/DD')
             ,#{stlAmt, jdbcType=NUMERIC}
             ,TO_DATE(#{stlPlnDy, jdbcType=VARCHAR},'YYYY/MM/DD')
             ,#{tmallApplyDscAmt, jdbcType=NUMERIC}
             ,#{tmallOverDscAmt, jdbcType=NUMERIC}
             ,#{totalCount, jdbcType=NUMERIC}
             )  
    </insert>
    
    <select id="selectPaGoodsInsertTarget" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
	    WITH BUF AS (
	    SELECT G.ROWID AS G_RID
	         , GT.INSERT_DATE
	         , ROWNUM
	         , GT.GOODS_CODE
	         , G.SOURCING_MEDIA
	         , GT.PA_GROUP_CODE
	         , GT.PA_CODE
	         , G.ORIGIN_CODE
	         , (CASE WHEN GT.PA_GROUP_CODE = '05'
                     THEN NVL((SELECT OM.OFFER_TYPE
                                 FROM TPAGOODSOFFER PO
                                    , TPAOFFERCODEMAPPING OM
                                WHERE PO.PA_GROUP_CODE = GT.PA_GROUP_CODE
                                  AND PO.PA_OFFER_TYPE = OM.PA_OFFER_TYPE
                                  AND PO.PA_OFFER_CODE = OM.PA_OFFER_CODE
                                  AND OM.PA_GROUP_CODE = PO.PA_GROUP_CODE
                                  AND PO.GOODS_CODE    = G.GOODS_CODE
                                  AND PO.USE_YN 	   = '1'
                                  AND ROWNUM 		   = 1 ) ,
                              (SELECT O.OFFER_TYPE
                                 FROM TOFFER O
                                WHERE O.GOODS_CODE = G.GOODS_CODE
                                  AND O.USE_YN 	   = '1'
                                  AND ROWNUM 	   = 1 ))
	                 ELSE (SELECT O.OFFER_TYPE
	                         FROM TOFFER O
	                        WHERE O.GOODS_CODE = G.GOODS_CODE
	                          AND O.USE_YN 	   = '1'
	                          AND ROWNUM 	   = 1 )
		                  END) AS OFFER_TYPE
	         , G.SHIP_COST_CODE
	         , G.ENTP_CODE
	         , DECODE( GP.SALE_PRICE, 0, 0, TRUNC((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100) )  AS MARGIN_RATE
	         , GP.SALE_PRICE
	         , G.BRAND_CODE
	         , G.LMSD_CODE
	         , G.GOODS_NAME
	         , G.MAKECO_CODE
	         , G.ENTP_BUY_MED
	         , G.GOODS_NAME_MC
	         , G.DELY_TYPE
	         , MC.MAKECO_NAME
	         , G.SOURCING_CODE
	         , AF.MOBILE_ETV_YN
	      FROM TGOODS G
	         , TGOODSADDINFO AF
	         , TPAGOODSTARGET GT
	         , TGOODSPRICE GP
	         , TMAKECOMP MC
	     WHERE G.GOODS_CODE = AF.GOODS_CODE
	       AND G.GOODS_CODE = GT.GOODS_CODE
	       AND G.GOODS_CODE = GP.GOODS_CODE
	       AND GP.ROWID = ( SELECT /*+ INDEX_DESC ( GPS PK_TGOODSPRICE ) */
	                               GPS.ROWID
	                          FROM TGOODSPRICE GPS
	                         WHERE GPS.GOODS_CODE = G.GOODS_CODE
	                           AND GPS.APPLY_DATE &lt;= SYSDATE
	                           AND ROWNUM = 1 )
	       AND G.MAKECO_CODE = MC.MAKECO_CODE
	       AND G.INVI_GOODS_TYPE = '00'
	       AND G.BROAD_SALE_YN   = '0'
	       AND G.OMBUDSMAN_YN    = '0'
	       AND G.SIGN_GB 		 = '80'
	       AND G.SALE_GB 		 = '00'
	       AND G.GIFT_YN 		 = '0'
	       AND G.SOURCING_MEDIA IN ('01', '61')
	       AND G.SQC_GB IN ('16', '18')
	       AND G.DESCRIBE_SQC_GB IN ('16', '18')
	       AND (G.ORDER_MEDIA_ALL_YN = '1' OR INSTR(G.ORDER_MEDIA, '61') > 0 OR INSTR(G.ORDER_MEDIA, '62') > 0)
	       AND NOT EXISTS (SELECT /*+ USE_HASH(TG) */ 1
	                         FROM TGOODS TG
	                        WHERE TG.GOODS_CODE = G.GOODS_CODE
	                          AND TG.SOURCING_CODE IN ('HALFCLUB', 'BORI', 'TLIFE')) 
	      <!--  AND (G.SOURCING_CODE NOT IN ('HALFCLUB', 'BORI', 'YIC') OR G.SOURCING_CODE IS NULL)	        -->                   
	       AND AF.EM_GOODS_YN = '0'
	       AND AF.GLOBAL_DELY_YN = '0'
	       AND AF.DAWN_YN = '0'
	       AND AF.ALCOHOL_YN != '1'	       
	       AND GP.SALE_PRICE > 0
	       AND GT.PA_SALE_GB IS NULL
	       AND GT.PA_GROUP_CODE NOT IN ('01','02','03','05','06','07','08','09','11')
	       AND SYSDATE BETWEEN G.SALE_START_DATE AND NVL(G.SALE_END_DATE, SYSDATE + 1) 
           AND NOT EXISTS ( SELECT '1'
		                              FROM TPATARGETEXCEPT PT
		                             WHERE PT.TARGET_GB   = '00'
		                               AND PT.TARGET_CODE = GT.GOODS_CODE
		                               AND (PT.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PT.PA_GROUP_CODE,GT.PA_GROUP_CODE) > 0)
		                               AND PT.USE_YN = '1' )
           AND NOT EXISTS ( SELECT '1'
						               FROM TPATARGETEXCEPT PT
						              WHERE PT.TARGET_GB   = '20'
						                  AND PT.TARGET_CODE = G.ENTP_CODE
						                  AND (PT.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PT.PA_GROUP_CODE,GT.PA_GROUP_CODE) > 0)
						                  AND PT.USE_YN = '1' )                               
            AND NOT EXISTS ( SELECT '1'
                                        FROM TPATARGETEXCEPT PT
                                      WHERE PT.TARGET_GB   = '30'
                                          AND PT.TARGET_CODE = G.BRAND_CODE
                                          AND (PT.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PT.PA_GROUP_CODE,GT.PA_GROUP_CODE) > 0)
                                          AND PT.USE_YN = '1' )   
           AND NOT EXISTS ( SELECT '1' 
                              FROM TPAEXCEPTENTP PEE
                              LEFT OUTER JOIN TPAEXCEPTBRAND PEB ON PEE.EXCEPT_SEQ = PEB.EXCEPT_SEQ AND PEE.ENTP_CODE = PEB.ENTP_CODE AND PEB.USE_YN = '1'
                             WHERE PEE.USE_YN    = '1'
                               AND PEE.ENTP_CODE = G.ENTP_CODE
                               AND (PEE.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PEE.PA_GROUP_CODE, GT.PA_GROUP_CODE) > 0)
                               AND (PEE.ALL_BRAND_YN = '1' OR PEB.BRAND_CODE = G.BRAND_CODE)
                               AND (PEE.SOURCING_MEDIA = '00' OR INSTR(PEE.SOURCING_MEDIA, G.SOURCING_MEDIA) > 0) 
                               AND 1 = CASE WHEN GT.PA_GROUP_CODE IN ('01', '02', '03') AND PEE.ENTP_CODE = '109153'
                                            THEN 0
                                            ELSE 1 END)
	     <if test='paGroupCode != null and paGroupCode != "" '>
	       AND GT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
	     </if>
	     <if test='goodsCode != null and goodsCode != "" '>
	       AND GT.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	     </if>
	    )
	
		SELECT TOTAL.* FROM (
		    SELECT MAIN.GOODS_CODE
		         , MAIN.SOURCING_MEDIA
		         , MAIN.PA_GROUP_CODE
		         , MAIN.PA_CODE
		         , MAIN.INSERT_DATE
		         , GKM.PA_LMSD_KEY
		         , MAIN.ORIGIN_CODE
		         , MAIN.OFFER_TYPE
		         , MAIN.SHIP_COST_CODE
		         , MAIN.ENTP_CODE
		         , MAIN.MARGIN_RATE
		         , MAIN.SALE_PRICE
		         , 'N' AS EVENT_YN
		         , MAIN.BRAND_CODE
		         , MAIN.LMSD_CODE
		         , EP.EPGOODS_NAME
		         , MAIN.GOODS_NAME
		         , MAIN.MAKECO_CODE
		         , MAIN.ENTP_BUY_MED
		         , MAIN.GOODS_NAME_MC
		         , MAIN.DELY_TYPE
		         , '' AS PA_LMSDN_KEY
		         , MAIN.MAKECO_NAME
		         , G.MD_KIND
		         , MAIN.SOURCING_CODE
		         , MAIN.MOBILE_ETV_YN
		         , G.TAX_YN
		      FROM TGOODS G
		         , TPAGOODSKINDSMAPPING GKM
		         , TEPGOODSNAME EP
		         , BUF MAIN
		     WHERE MAIN.G_RID = G.ROWID
		       AND MAIN.PA_GROUP_CODE = GKM.PA_GROUP_CODE
		       AND G.LGROUP = GKM.LGROUP
		       AND G.MGROUP = GKM.MGROUP
		       AND G.SGROUP = GKM.SGROUP
		       AND G.DGROUP = GKM.DGROUP
		       AND G.GOODS_CODE = EP.GOODS_CODE(+)
		       AND MAIN.PA_GROUP_CODE IN ('04','10')
		       AND 0 = CASE WHEN MAIN.PA_GROUP_CODE = '04' THEN DECODE(G.LGROUP, '10', 1, '15', 1, '20', 1, '65', 1, '70', 1, '75', 1, '82', 1, '85', 1, 0)
		                    ELSE 0 END
		       AND 0 = CASE WHEN MAIN.PA_GROUP_CODE = '04' THEN (SELECT COUNT(1)
		                                                           FROM TPANAVERGOODSKINDS PGK
		                                                              , TPANAVERGOODSKINDSINFO PGKI
		                                                          WHERE GKM.PA_LMSD_KEY = PGK.CATEGORY_ID
		                                                            AND PGK.CATEGORY_ID = PGKI.CATEGORY_ID)
		                    ELSE 0 END
		                    
		       AND 0 = CASE WHEN MAIN.PA_GROUP_CODE = '04' THEN (SELECT COUNT(1)
											                                                       FROM TOFFER TOF
											                                                     WHERE TOF.GOODS_CODE = G.GOODS_CODE
											                                                         AND TOF.OFFER_TYPE IN ('39','40','41'))
		                    ELSE 0 END
		       AND 0 = CASE WHEN MAIN.PA_GROUP_CODE = '04' THEN (SELECT COUNT(1) FROM TPANAVERGOODS PA WHERE PA.PA_CODE = MAIN.PA_CODE AND PA.GOODS_CODE = G.GOODS_CODE)
		                    WHEN MAIN.PA_GROUP_CODE = '10' THEN (SELECT COUNT(1) FROM TPASSGGOODS  PA WHERE PA.PA_CODE = MAIN.PA_CODE AND PA.GOODS_CODE = G.GOODS_CODE)
		                    ELSE 1 END
		       AND NOT EXISTS ( SELECT '1' 
		                          FROM TPAGOODSEVENT PGE
		                         WHERE PGE.GOODS_CODE    = G.GOODS_CODE
		                           AND PGE.USE_YN 	     = '1'
		                           AND PGE.PA_GROUP_CODE = MAIN.PA_GROUP_CODE )
		                           
		 UNION ALL
		
		    SELECT MAIN.GOODS_CODE
		         , MAIN.SOURCING_MEDIA
		         , MAIN.PA_GROUP_CODE
		         , MAIN.PA_CODE
		         , MAIN.INSERT_DATE
		         , GKM.PA_LMSD_KEY
		         , MAIN.ORIGIN_CODE
		         , MAIN.OFFER_TYPE
		         , MAIN.SHIP_COST_CODE
		         , MAIN.ENTP_CODE
		         , MAIN.MARGIN_RATE
		         , MAIN.SALE_PRICE
		         , 'Y' AS EVENT_YN
		         , MAIN.BRAND_CODE
		         , MAIN.LMSD_CODE
		         , EP.EPGOODS_NAME
		         , MAIN.GOODS_NAME
		         , MAIN.MAKECO_CODE
		         , MAIN.ENTP_BUY_MED
		         , MAIN.GOODS_NAME_MC
		         , MAIN.DELY_TYPE
		         , '' AS PA_LMSDN_KEY
		         , MAIN.MAKECO_NAME
		         , G.MD_KIND
		         , MAIN.SOURCING_CODE
		         , MAIN.MOBILE_ETV_YN
		         , G.TAX_YN
		      FROM TGOODS G
		         , TPAGOODSKINDSMAPPING GKM
		         , TEPGOODSNAME EP
		         , TPAGOODSEVENT PGE
		         , BUF MAIN
		     WHERE MAIN.G_RID = G.ROWID
		       AND MAIN.PA_GROUP_CODE = GKM.PA_GROUP_CODE
		       AND G.LGROUP = GKM.LGROUP
		       AND G.MGROUP = GKM.MGROUP
		       AND G.SGROUP = GKM.SGROUP
		       AND G.DGROUP = GKM.DGROUP
		       AND G.GOODS_CODE = EP.GOODS_CODE(+)
		       AND MAIN.PA_GROUP_CODE = PGE.PA_GROUP_CODE
		       AND MAIN.GOODS_CODE = PGE.GOODS_CODE
		       AND MAIN.PA_GROUP_CODE IN ('04','10')
		       AND 0 = CASE WHEN MAIN.PA_GROUP_CODE = '04' THEN DECODE(G.LGROUP, '10', 1, '15', 1, '20', 1, '65', 1, '70', 1, '75', 1, '82', 1, '85', 1, 0)
		                    ELSE 0 END
		      /*
		       AND 0 = CASE WHEN MAIN.PA_GROUP_CODE = '04' THEN (SELECT COUNT(1)
		                                                           FROM TPANAVERGOODSKINDS PGK
		                                                              , TPANAVERGOODSKINDSINFO PGKI
		                                                          WHERE GKM.PA_LMSD_KEY = PGK.CATEGORY_ID
		                                                            AND PGK.CATEGORY_ID = PGKI.CATEGORY_ID)
		                    ELSE 0 END
		       */
		       AND 0 = CASE WHEN MAIN.PA_GROUP_CODE = '04' THEN (SELECT COUNT(1) FROM TPANAVERGOODS PA WHERE PA.PA_CODE = MAIN.PA_CODE AND PA.GOODS_CODE = G.GOODS_CODE)
		                    WHEN MAIN.PA_GROUP_CODE = '10' THEN (SELECT COUNT(1) FROM TPASSGGOODS  PA WHERE PA.PA_CODE = MAIN.PA_CODE AND PA.GOODS_CODE = G.GOODS_CODE)
		                    ELSE 1 END
		       AND PGE.USE_YN = '1'
		       AND PGE.START_DATE &lt;= SYSDATE
		       AND (PGE.END_DATE > SYSDATE OR PGE.END_DATE IS NULL)
		       ) TOTAL
		 ORDER BY TOTAL.PA_GROUP_CODE, TOTAL.PA_CODE
    </select>
    
    <select id="selectEtvMarginCheck" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectEtvMarginCheck by PaCommonController */
		       TO_NUMBER(T.VAL)
          FROM TCONFIG T
         WHERE T.ITEM = 'ETV_MOBILE_MARGIN'
	</select>
    
    <select id="selectPaOfferCheck" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaOfferCheck by PaCommonController */
		       COUNT(1)
          FROM TPAOFFERCODEMAPPING OM
         WHERE OM.OFFER_TYPE    = #{offerType, jdbcType=VARCHAR}
           AND OM.PA_GROUP_CODE = DECODE(#{paGroupCode, jdbcType=VARCHAR}, '03', '02', #{paGroupCode, jdbcType=VARCHAR})
	</select>
	
	<select id="selectOriginMappingNaver" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
		SELECT /* pacommon.xml: pacommon.pacommon.selectOriginMappingNaver by PaCommonController */
			   NVL(OM.NAVER_ORIGIN_CODE, 'XX') AS NAVER_ORIGIN_CODE
      	  FROM TPANAVERORIGINMAPPING OM
    	 WHERE OM.ORIGIN_CODE = #{originCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectOriginMapping" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
		SELECT /* pacommon.xml: pacommon.pacommon.selectOriginMapping by PaCommonController */
			   NVL((SELECT OM.PA_ORIGIN_CODE 
					  FROM TPAORIGINMAPPING OM
					 WHERE OM.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
					   AND OM.ORIGIN_CODE   = #{originCode,  jdbcType=VARCHAR} )
				   , DECODE(#{paGroupCode, jdbcType=VARCHAR},'10','1000000000',''))
		       FROM DUAL
	</select>
	
	<select id="selectImageCheck" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectImageCheck by PaCommonController */
		       COUNT(1)
          FROM TGOODSIMAGE GI
         WHERE GI.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
           AND NVL(IMAGE_C,IMAGE_G) IS NOT NULL
           AND ROWNUM = 1
	</select>
	
	<select id="selectPaDescribeCheck" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaDescribeCheck by PaCommonController */
          	   COUNT(1)
          FROM TDESCRIBE DB
         WHERE DB.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
           AND DB.DESCRIBE_CODE IN ('998', '999')
           AND DB.DESCRIBE_EXT IS NOT NULL
           <if test='paGroupCode == "01"'>
           	AND DBMS_LOB.getlength(DB.DESCRIBE_EXT) &lt;= 6000
           </if>
	</select>
	
	<select id="selectPaStockCheck" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaStockCheck by PaCommonController */
          CASE WHEN NVL(CEIL(FUN_GET_ORDER_ABLE_QTY(G.GOODS_CODE, '', G.WH_CODE) * C.CODE_GROUP), 0) &gt;= 3 OR G.BUY_MED = '13' THEN
                    1
               ELSE
                    0
                END
          FROM TGOODS G
             , (SELECT CODE_GROUP
                  FROM TCODE
                 WHERE CODE_LGROUP = 'O505'
                   AND CODE_MGROUP = #{paCode, jdbcType=VARCHAR}) C
         WHERE G.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectPaShipCostCheck" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaShipCostCheck by PaCommonController */
       	  CASE WHEN #{paGroupCode, jdbcType=VARCHAR}  = '05' 
       	  			AND (SUBSTR(SHIP_COST_CODE, 0, 2) = 'CN' OR SUBSTR(SHIP_COST_CODE, 0, 2) = 'PL')
       	  			AND (MOD_COST_AMT &gt; 0 OR SHIP_COST_BASE_AMT &lt; 100) 
       	  	   THEN
                    0
               WHEN #{paGroupCode, jdbcType=VARCHAR} = '05' 
                    AND RET_COST_AMT_10 &gt; 250000 
               THEN
                    0
               WHEN #{paGroupCode, jdbcType=VARCHAR} = '09' 
                    AND (( SUBSTR(SHIP_COST_CODE, 0, 2) != 'FR' AND ORD_COST_AMT_10 &lt; 100 ) 
                      OR ( (SUBSTR(SHIP_COST_CODE, 0, 2) = 'CN' OR SUBSTR(SHIP_COST_CODE, 0, 2) = 'PL') AND SHIP_COST_BASE_AMT &lt; 100) )
               THEN
                    0
               WHEN #{paGroupCode, jdbcType=VARCHAR} = '07' 
                    AND ( (SUBSTR(SHIP_COST_CODE, 0, 2) != 'FR' AND ORD_COST_AMT_10 &lt; 100) 
                       OR ((SUBSTR(SHIP_COST_CODE, 0, 2) = 'CN' OR SUBSTR(SHIP_COST_CODE, 0, 2) = 'PL') AND SHIP_COST_BASE_AMT &lt; 100))
               THEN
                    0
               WHEN #{paGroupCode, jdbcType=VARCHAR} = '11'
               /* 카카오 배송비
  				기본 배송비는 최소 10원 이상 최대 10만원 이하로 설정 가능합니다. 입력 단위는 10원 단위 입니다.
				배송비 유형이 무료일 경우에는 기본 배송비는 0원 입력 가능합니다.
				조건부 무료 금액은 최소 10원 이상 설정 가능합니다. 입력 단위는 10원 단위 입니다.
				반품/교환 배송비는 최소 0원 이상 최대 10만원(반품일 경우) 및 20만원(교환일 경우) 설정 가능합니다. 입력 단위는 10원 단위 입니다.
               */
               	AND ( MOD(ORD_COST_AMT_10,10) > 0 
				   OR ORD_COST_AMT_10 > 100000
				   OR (SUBSTR(SHIP_COST_CODE,0,2) IN ('CN','PL') AND SHIP_COST_BASE_AMT &lt; 10)
				   OR MOD(SHIP_COST_BASE_AMT,10) > 0
				   OR RET_COST_AMT_10 > 100000
				   OR EXCH_COST_AMT_10 > 200000 )
               THEN
                    0
               WHEN #{paGroupCode, jdbcType=VARCHAR} = '04' 
                    OR SUBSTR(SHIP_COST_CODE,0,2) != 'QN' 
               THEN
                    1
               ELSE
                    0
                END
          FROM (
	             SELECT CD.ENTP_CODE
	                  , CD.SHIP_COST_CODE
	               	  , SUM(DECODE(CUST_AREA_GB, '10', ORD_COST_AMT,  0)) AS ORD_COST_AMT_10
	                  , SUM(DECODE(CUST_AREA_GB, '10', RET_COST_AMT,  0)) AS RET_COST_AMT_10
	                  , SUM(DECODE(CUST_AREA_GB, '10', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT_10
	                  , SUM(DECODE(CUST_AREA_GB, '20', ORD_COST_AMT,  0)) AS ORD_COST_AMT_20
	                  , SUM(DECODE(CUST_AREA_GB, '20', RET_COST_AMT,  0)) AS RET_COST_AMT_20
	                  , SUM(DECODE(CUST_AREA_GB, '20', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT_20
	                  , SUM(DECODE(CUST_AREA_GB, '30', ORD_COST_AMT,  0)) AS ORD_COST_AMT_30
	                  , SUM(DECODE(CUST_AREA_GB, '30', RET_COST_AMT,  0)) AS RET_COST_AMT_30
	                  , SUM(DECODE(CUST_AREA_GB, '30', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT_30
	                  , (SELECT CM.SHIP_COST_BASE_AMT FROM TSHIPCOSTM CM WHERE CM.ENTP_CODE = CD.ENTP_CODE AND CM.SHIP_COST_CODE = CD.SHIP_COST_CODE) AS SHIP_COST_BASE_AMT
	                  , MOD((SELECT CM.SHIP_COST_BASE_AMT FROM TSHIPCOSTM CM WHERE CM.ENTP_CODE = CD.ENTP_CODE AND CM.SHIP_COST_CODE = CD.SHIP_COST_CODE), 100) AS MOD_COST_AMT
	               FROM TSHIPCOSTDT CD
	              WHERE CD.APPLY_DATE = (SELECT MAX(APPLY_DATE)
	                                       FROM TSHIPCOSTDT CD1
	                                      WHERE CD1.ENTP_CODE = CD.ENTP_CODE
	                                        AND CD1.CUST_AREA_GB IN ('10', '20', '30')
	                                        AND CD1.SHIP_COST_CODE = CD.SHIP_COST_CODE
	                                        AND CD1.APPLY_DATE &lt; SYSDATE)
	                AND CD.ENTP_CODE = DECODE(#{delyType, jdbcType=VARCHAR}, '10', '100001', #{entpCode, jdbcType=VARCHAR})
	                AND CD.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
	              GROUP BY CD.ENTP_CODE
	                     , CD.SHIP_COST_CODE
        ) X
	</select>
	
	<select id="selectChkMinMarSale" parameterType="hashMap" resultType="int">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectChkMinMarSale by PaCommonController */
	    	   CASE WHEN ((#{eventYn, jdbcType=VARCHAR} = 'Y' AND TO_NUMBER(FUN_GETCONFIG('PA_EVENT_LIMIT_MARGIN')) &lt;= #{marginRate, jdbcType=VARCHAR}) OR (#{eventYn, jdbcType=VARCHAR} = 'N' AND SUM(X.MIN_MARGIN) &lt;= #{marginRate, jdbcType=VARCHAR})) AND SUM(X.MIN_SALE_PRICE) &lt;= #{salePrice, jdbcType=VARCHAR} THEN
                 			1
           		    ELSE
                			0
           			END
		  FROM (
		          SELECT CASE WHEN #{compareGroup, jdbcType=VARCHAR} = 'A1' AND #{taxYn, jdbcType=VARCHAR} = '0' AND C.REMARK2 IS NOT NULL
						       THEN TO_NUMBER(C.REMARK2)
						      ELSE TO_NUMBER(DECODE(#{paCode, jdbcType=VARCHAR}, #{compareGroup, jdbcType=VARCHAR}, C.REMARK, C.REMARK1))
						 END AS MIN_MARGIN
		               , 0 AS MIN_SALE_PRICE
		            FROM TCODE C
		           WHERE C.CODE_LGROUP = 'O582'
		             AND C.CODE_MGROUP = #{marginCode, jdbcType=VARCHAR}
		             
		           UNION ALL
		           
		          SELECT 0 AS MIN_MARGIN
		               , TO_NUMBER(DECODE(#{paCode, jdbcType=VARCHAR}, #{compareGroup, jdbcType=VARCHAR}, C.REMARK, C.REMARK1)) AS MIN_SALE_PRICE
		            FROM TCODE C
		           WHERE C.CODE_LGROUP = 'O582'
		             AND C.CODE_MGROUP = #{minimumCode, jdbcType=VARCHAR}
		       ) X
	</select>
	
	<select id="selectBrandMapping11st" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectBrandMapping11st by PaCommonController */
	   		   NVL(MAX(TPB.BRAND_NO), '')
          FROM TPA11STBRAND TPB
         WHERE TPB.BRAND_CODE = #{brandCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectBrandMappingGmkt" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectBrandMappingGmkt by PaCommonController */
	   		   NVL(MAX(TPB.BRAND_NO), '')
          FROM TPAGMKTBRAND TPB
         WHERE TPB.BRAND_CODE = #{brandCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectMakerMappingGmkt" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectMakerMappingGmkt by PaCommonController */
	   		   NVL(MAX(PGM.MAKER_NO), '')
          FROM TPAGMKTMAKER PGM
         WHERE PGM.MAKER_CODE = #{makecoCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectMakerMapping" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectMakerMapping by PaCommonController */
	   		   PGM.PA_MAKER_NO
          FROM TPAMAKERMAPPING PGM
         WHERE PGM.MAKER_CODE = #{makecoCode, jdbcType=VARCHAR}
           AND PGM.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectBrandMapping" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectBrandMapping by PaCommonController */
	   		   NVL((SELECT BM.PA_BRAND_NO 
	   		   	  FROM TPABRANDMAPPING BM 
	   		   	 WHERE BM.BRAND_CODE = #{brandCode, jdbcType=VARCHAR} 
	   		   	   AND BM.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}),DECODE(#{paGroupCode, jdbcType=VARCHAR},'10','9999999999','')) AS PA_BRAND_NO
          FROM DUAL
	</select>
	
	<select id="selectPaOriginCheck" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaOriginCheck by PaCommonController */
		       COUNT(1)
          FROM TGOODS G
             , TBRAND B
             , TCODE  C
         WHERE G.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
           AND G.BRAND_CODE   = B.BRAND_CODE
           AND C.CODE_LGROUP  = 'B023'
           AND G.ORIGIN_CODE  = C.CODE_MGROUP
	</select>
	
	<select id="selectPaMobGiftGbCheck" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaMobGiftGbCheck by PaCommonController */
		       COUNT(1)
          FROM TGOODSADDINFO GA
         WHERE GA.GOODS_CODE  = #{goodsCode, jdbcType=VARCHAR}
           AND GA.MOB_GIFT_GB = '90'
	</select>
	
	<select id="selectPaEntpuserCheckCopn" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaEntpuserCheckCopn by PaCommonController */
		       COUNT(1)
          FROM TGOODS GD
             , TENTPUSER EU
         WHERE DECODE(GD.DELY_TYPE, '10', '100001', GD.ENTP_CODE) = EU.ENTP_CODE
           AND DECODE(GD.DELY_TYPE, '10', '003', GD.SHIP_MAN_SEQ) = EU.ENTP_MAN_SEQ
           AND NVL(EU.STD_POST_ADDR1, EU.POST_ADDR) IS NOT NULL
           AND NVL(EU.STD_POST_ADDR2, EU.ADDR) 		IS NOT NULL
           AND LENGTH(EU.ENTP_MAN_DDD || '-' || EU.ENTP_MAN_TEL1 || '-' || EU.ENTP_MAN_TEL2) &gt;= 11
           AND LENGTH(EU.ENTP_MAN_DDD || '-' || EU.ENTP_MAN_TEL1 || '-' || EU.ENTP_MAN_TEL2) &lt;= 14
           AND LENGTH(EU.ENTP_MAN_HP1 || DECODE(EU.ENTP_MAN_HP1, NULL, '', '-') || EU.ENTP_MAN_HP2 || DECODE(EU.ENTP_MAN_HP2, NULL, '', '-') || EU.ENTP_MAN_HP3) &gt;= 11
           AND LENGTH(EU.ENTP_MAN_HP1 || DECODE(EU.ENTP_MAN_HP1, NULL, '', '-') || EU.ENTP_MAN_HP2 || DECODE(EU.ENTP_MAN_HP2, NULL, '', '-') || EU.ENTP_MAN_HP3) &lt;= 14
           AND GD.GOODS_CODE  = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectEntpuserCheck" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectEntpuserCheck by PaCommonController */
		       COUNT(1)
          FROM TGOODS GD
             , TENTPUSER EU
         WHERE GD.ENTP_CODE = EU.ENTP_CODE
           AND GD.RETURN_MAN_SEQ = EU.ENTP_MAN_SEQ
           AND LENGTH(NVL(EU.STD_POST, EU.POST_NO)) = 5
           AND NVL(EU.STD_POST_ADDR1, EU.POST_ADDR) IS NOT NULL
           AND NVL(EU.STD_POST_ADDR2, EU.ADDR) IS NOT NULL
           AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectEntpuserCheckSsg" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectEntpuserCheckSsg by PaCommonController */
		       COUNT(1)
          FROM TGOODS GD
			 , TENTPUSER EU1
			 , TENTPUSER EU2
		 WHERE DECODE(GD.DELY_TYPE,'10','100001',GD.ENTP_CODE) = EU1.ENTP_CODE
		   AND DECODE(GD.DELY_TYPE, '10', '003', GD.SHIP_MAN_SEQ) = EU1.ENTP_MAN_SEQ
		   AND EU1.ENTP_MAN_GB = '30'
		   AND DECODE(GD.DELY_TYPE,'10','100001',GD.ENTP_CODE) = EU2.ENTP_CODE
		   AND DECODE(GD.DELY_TYPE, '10', '002', GD.RETURN_MAN_SEQ) = EU2.ENTP_MAN_SEQ
		   AND EU2.ENTP_MAN_GB = '20'
		   AND EU1.STD_ROAD_POST IS NOT NULL 
		   AND EU1.STD_POST IS NOT NULL 
		   AND EU2.STD_ROAD_POST IS NOT NULL 
		   AND EU2.STD_POST IS NOT NULL
           AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectPaGoodsdtCnt" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaGoodsdtCnt by PaCommonController */
		       CASE WHEN COUNT(1) &lt;= 200 THEN 1
                 	ELSE 0
               		END
          FROM TGOODSDT A
         WHERE A.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
         GROUP BY GOODS_CODE
	</select>
	
	<select id="selectPaGoodsdtLength" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaGoodsdtLength by PaCommonController */
		       CASE WHEN MAX(LENGTH(GOODSDT_INFO)) &lt;= 30 THEN 1
                    ELSE 0
             		END
          FROM TGOODSDT A
         WHERE A.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectChkPagoodsYn" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
		SELECT /* pacommon.xml: pacommon.pacommon.selectChkPagoodsYn by PaCommonController */
		       COUNT(1)
          FROM TPAGOODS PG
         WHERE PG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectOriginMapping11st" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
		SELECT /* pacommon.xml: pacommon.pacommon.selectOriginMapping11st by PaCommonController */
			   NVL(OM.ORGN_TYP_DTLS_CD, 'XX') AS ORGN_TYP_DTLS_CD
      	  FROM TPA11STORIGINMAPPING OM
    	 WHERE OM.ORIGIN_CODE = #{originCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectOriginMappingGmkt" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="String">
		SELECT /* pacommon.xml: pacommon.pacommon.selectOriginMappingGmkt by PaCommonController */
			   NVL(PGO.ORGN_TYP_DTLS_CD, 'XX') AS ORGN_TYP_DTLS_CD
      	  FROM TPAGMKTORIGINMAPPING PGO
    	 WHERE PGO.ORIGIN_CODE = #{originCode, jdbcType=VARCHAR}
	</select>
	
	<insert id="insertPa11stGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPa11stGoods by PaCommonController */
			   TPA11STGOODS( GOODS_CODE
                           , PA_CODE
                           , PA_GROUP_CODE
                           , PA_SALE_GB
                           , PA_STATUS
                           , PA_LMSD_KEY
                           , ORGN_TYP_CD
                           , ORGN_TYP_DTLS_CD
                           , BRAND_NO
                           , ORGN_NM_VAL
                           , BEEF_TRACE_NO
                           , MEDICAL_KEY
                           , MEDICAL_RETAIL
                           , MEDICAL_AD
                           , TRANS_TARGET_YN
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE
                           )
                    VALUES ( #{goodsCode, 	  jdbcType=VARCHAR}
                           , #{paCode,        jdbcType=VARCHAR}
                           , #{paGroupCode,   jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,     jdbcType=VARCHAR}
                           , #{orgnTypCd, 	  jdbcType=VARCHAR}
                           , #{orgnTypDtlsCd, jdbcType=VARCHAR}
                           , #{brandNo, 	  jdbcType=VARCHAR}
                           , ''
                           , ''
                           , ''
                           , ''
                           , ''
                           , '1'
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}
                           )
	</insert>
	
	<insert id="insertPaGmktGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGmktGoods by PaCommonController */
			   TPAGMKTGOODS( GOODS_CODE
                           , PA_CODE
                           , PA_GROUP_CODE
                           , PA_SALE_GB
                           , PA_STATUS
                           , PA_SGROUP
                           , ORIGIN_ENUM
                           , BRAND_NO
                           , MAKER_NO
                           , TRANS_TARGET_YN
                           , TRANS_DISCOUNT_YN
                           , RETURN_NOTE
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , ESM_CATEGORY_CODE
                           , SITE_CATEGORY_CODE
                           , ORIGIN_DT
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE                           
                           )
                    VALUES ( #{goodsCode,  jdbcType=VARCHAR}
                           , #{paCode,     jdbcType=VARCHAR}
                           , #{paGroupCode,jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , '1'
                           , #{originEnum, jdbcType=VARCHAR}
                           , #{brandNo,    jdbcType=VARCHAR}
                           , #{makerNo,    jdbcType=VARCHAR}
                           , '1'
                           , '1'
                           , ''
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , #{paLmsdnKey,    jdbcType=VARCHAR}
                           , #{paLmsdKey,     jdbcType=VARCHAR}
                           , #{orgnTypDtlsCd, jdbcType=VARCHAR}
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}                           
                           )
	</insert>
	
	<insert id="insertPaNaverGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaNaverGoods by PaCommonController */
			   TPANAVERGOODS( GOODS_CODE
                            , PA_CODE
                            , PA_GROUP_CODE
                            , PA_GOODS_NAME
                            , PA_SALE_GB
                            , PA_STATUS
                            , PA_LMSD_KEY
                            , NAVER_ORIGIN_CODE
                            , TRANS_TARGET_YN
                            , INSERT_ID
                            , INSERT_DATE
                            , MODIFY_ID
                            , MODIFY_DATE
                            , MASS_TARGET_YN
                            , MASS_TARGET_CODE                             
                           )
                    VALUES ( #{goodsCode,   jdbcType=VARCHAR}
                           , #{paCode,      jdbcType=VARCHAR}
                           , #{paGroupCode, jdbcType=VARCHAR}
                           , #{epgoodsName, jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,       jdbcType=VARCHAR}
                           , #{naverOriginCode, jdbcType=VARCHAR}
                           , '1'
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}     
                           )
	</insert>
	
	<insert id="insertPaCopnGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaCopnGoods by PaCommonController */
			   TPACOPNGOODS( GOODS_CODE
                           , PA_CODE
                           , PA_GROUP_CODE
                           , PA_SALE_GB
                           , PA_STATUS
                           , PA_LMSD_KEY
                           , DISPLAY_CATEGORY_CODE
                           , DISPLAY_PRODUCT_NAME
                           , GENERAL_PRODUCT_NAME
                           , TRANS_TARGET_YN
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE                                 
                           )
                    VALUES ( #{goodsCode,   jdbcType=VARCHAR}
                           , #{paCode,      jdbcType=VARCHAR}
                           , #{paGroupCode, jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,   jdbcType=VARCHAR}
                           , #{paLmsdKey,   jdbcType=VARCHAR}
                           , #{goodsName,   jdbcType=VARCHAR}
                           , #{goodsNameMc, jdbcType=VARCHAR}
                           , '1'
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}                             
                           )
	</insert>
	
	<insert id="insertPaWempGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaWempGoods by PaCommonController */
			   TPAWEMPGOODS( GOODS_CODE
                           , PA_CODE
                           , PA_GROUP_CODE
                           , PA_SALE_GB
                           , PA_STATUS
                           , PA_LMSD_KEY
                           , DISPLAY_YN
                           , BRAND_NO
                           , TRANS_TARGET_YN
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE                            
                           )
                    VALUES ( #{goodsCode,   jdbcType=VARCHAR}
                           , #{paCode,      jdbcType=VARCHAR}
                           , #{paGroupCode, jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,   jdbcType=VARCHAR}
                           , '1'
                           , (SELECT B.BRAND_NO FROM TGOODS A, TPAWEMPBRAND B WHERE A.BRAND_CODE = B.BRAND_CODE AND A.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR} AND ROWNUM = 1)
                           , '1'
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}                            
                           )
	</insert>
	
	<insert id="insertPaIntpGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaIntpGoods by PaCommonController */
			   TPAINTPGOODS( GOODS_CODE
                           , PA_CODE
                           , PA_GROUP_CODE
                           , PA_SALE_GB
                           , PA_STATUS
                           , PA_LMSD_KEY
                           , BRAND_NO
                           , TRANS_TARGET_YN
                           , TRANS_SALE_YN
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE                           
                           )
                    VALUES ( #{goodsCode,   jdbcType=VARCHAR}
                           , #{paCode,      jdbcType=VARCHAR}
                           , #{paGroupCode, jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,   jdbcType=VARCHAR}
                           , #{brandNo,     jdbcType=VARCHAR}
                           , '1'
                           , '1'
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}                             
                           )
	</insert>
	
	<insert id="insertPaLtonGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaLtonGoods by PaCommonController */
			   TPALTONGOODS( PA_CODE
                           , GOODS_CODE
                           , PA_GROUP_CODE
                           , PA_SALE_GB
                           , PA_STATUS
                           , SCAT_NO
                           , LF_DCAT_NO
                           , TRANS_TARGET_YN
                           , TRANS_SALE_YN
                           , BRD_NO
                           , MFCR_NM
                           , OPLC_CD
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE                              
                           )
                    VALUES ( #{paCode,       jdbcType=VARCHAR}
                           , #{goodsCode,    jdbcType=VARCHAR}
                           , #{paGroupCode,  jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey, jdbcType=VARCHAR}
                           , (SELECT LISTAGG(DISP_CAT_ID, ',') FROM TPALTONSTANDARDDISPLIST WHERE STD_CAT_ID = #{paLmsdKey, jdbcType=VARCHAR})
                           , '1'
                           , '1'
                           , #{brandNo,      jdbcType=VARCHAR}
                           , #{makecoName,   jdbcType=VARCHAR}
                           , #{paOriginCode, jdbcType=VARCHAR}
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}                           
                           )
	</insert>
	
	<insert id="insertPaGmktGoodsPrice" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGmktGoodsPrice by PaCommonController */
			   TPAGOODSPRICE ( GOODS_CODE
                             , PA_CODE
                             , APPLY_DATE
                             , SALE_PRICE
                             , SUPPLY_PRICE
                             , COMMISION
                             , DC_AMT
                             , INSERT_ID
                             , INSERT_DATE
                             , MODIFY_ID
                             , MODIFY_DATE
                             , PRICE_SEQ
                             , LUMP_SUM_DC_AMT
                             , LUMP_SUM_ENTP_DC_AMT
                             , LUMP_SUM_OWN_DC_AMT
                             )
                        SELECT GP.GOODS_CODE
                             , #{paCode, jdbcType=VARCHAR}
                             , GP.APPLY_DATE
                             , GP.SALE_PRICE
                             , CASE WHEN C.CODE_GROUP = '01' THEN
                                         ROUND((GP.SALE_PRICE-GP.ARS_DC_AMT) * ((100 - DECODE(#{paCode, jdbcType=VARCHAR}, '21', C.REMARK, C.REMARK1)) / 100))
                                    ELSE
                                         ROUND(((GP.SALE_PRICE) * ((100 - DECODE(#{paCode, jdbcType=VARCHAR}, '21', C.REMARK, C.REMARK1)) / 100)) - GP.ARS_DC_AMT)
                                     END SUPPLY_PRICE
                             , DECODE(#{paCode, jdbcType=VARCHAR}, '21', C.REMARK, C.REMARK1) AS REMARK
                             , GP.ARS_DC_AMT
                             , '999999'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                             , GP.PRICE_SEQ
                             , GP.LUMP_SUM_DC_AMT
                             , GP.LUMP_SUM_ENTP_DC_AMT
                             , GP.LUMP_SUM_OWN_DC_AMT
                          FROM TGOODSPRICE GP
                             , TCODE  C
                             , TGOODS G
                         WHERE GP.GOODS_CODE  = G.GOODS_CODE
                           AND C.CODE_LGROUP  = 'O579'
                           AND C.ROWID = ( SELECT /*+ INDEX_DESC (TD IDX_TCODE_02)*/
                                                  CS.ROWID
                                             FROM TCODE CS
                                            WHERE CS.CODE_LGROUP = C.CODE_LGROUP
                                              AND TO_DATE(CS.CODE_MGROUP, 'YYYYMMDD') &lt; SYSDATE
                                              AND ROWNUM = 1
                                         )
                           AND C.CODE_GROUP = DECODE(#{paGroupCode, jdbcType=VARCHAR}, '03', '02', #{paGroupCode, jdbcType=VARCHAR})
                           AND G.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                           AND GP.ROWID = ( SELECT /*+ INDEX_DESC (GPS PK_TGOODSPRICE)*/
                                                   GPS.ROWID
                                              FROM TGOODSPRICE GPS
                                             WHERE GPS.GOODS_CODE = GP.GOODS_CODE
                                               AND GPS.APPLY_DATE &lt;= SYSDATE
                                               AND ROWNUM = 1
                                           )
                           AND NOT EXISTS ( SELECT '1'
                                              FROM TPAGOODSPRICE TPG
                                             WHERE TPG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                                               AND TPG.PA_CODE    = #{paCode, jdbcType=VARCHAR}
                                               AND TPG.APPLY_DATE = GP.APPLY_DATE
                                           )
	</insert>
	
	<insert id="insertPaGoodsPrice" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsPrice by PaCommonController */
			   TPAGOODSPRICE ( GOODS_CODE
                             , PA_CODE
                             , APPLY_DATE
                             , SALE_PRICE
                             , SUPPLY_PRICE
                             , COMMISION
                             , DC_AMT
                             , INSERT_ID
                             , INSERT_DATE
                             , MODIFY_ID
                             , MODIFY_DATE
                             , PRICE_SEQ
                             , LUMP_SUM_DC_AMT
                             , LUMP_SUM_OWN_DC_AMT
                             , LUMP_SUM_ENTP_DC_AMT
                             )
                        SELECT GP.GOODS_CODE
                             , #{paCode, jdbcType=VARCHAR}
                             , GP.APPLY_DATE
                             , GP.SALE_PRICE
                             , CASE WHEN C.CODE_GROUP = '01' OR C.CODE_GROUP = '05' OR C.CODE_GROUP = '06' THEN
                                         ROUND((GP.SALE_PRICE-GP.ARS_DC_AMT) * ((100 - DECODE(#{paCode, jdbcType=VARCHAR}, #{compareGroup, jdbcType=VARCHAR}, C.REMARK , C.REMARK1)) / 100))
                                    ELSE
                                         ROUND(((GP.SALE_PRICE) * ((100 - DECODE(#{paCode, jdbcType=VARCHAR}, #{compareGroup, jdbcType=VARCHAR}, C.REMARK, C.REMARK1)) / 100)) - GP.ARS_DC_AMT)
                                     END SUPPLY_PRICE
                             , DECODE(#{paCode, jdbcType=VARCHAR}, #{compareGroup, jdbcType=VARCHAR}, C.REMARK , C.REMARK1) AS REMARK
                             , GP.ARS_DC_AMT
                             , '999999'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                             , GP.PRICE_SEQ
                             , GP.LUMP_SUM_DC_AMT
                             , GP.LUMP_SUM_OWN_DC_AMT
                             , GP.LUMP_SUM_ENTP_DC_AMT
                          FROM TGOODSPRICE GP
                             , TCODE  C
                             , TGOODS G
                         WHERE GP.GOODS_CODE = G.GOODS_CODE
                           AND C.CODE_LGROUP = #{codeGroup, jdbcType=VARCHAR}
                           AND C.ROWID = ( SELECT /*+ INDEX_DESC (CS IDX_TCODE_02)*/
                                                  CS.ROWID
                                             FROM TCODE CS
                                            WHERE CS.CODE_LGROUP = C.CODE_LGROUP
                                              AND TO_DATE(CS.CODE_MGROUP, 'YYYYMMDD') &lt; SYSDATE
                                              AND ROWNUM = 1
                                         )
                           AND C.CODE_GROUP = #{paGroupCode, jdbcType=VARCHAR}
                           AND G.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                           AND GP.ROWID = ( SELECT /*+ INDEX_DESC (GPS PK_TGOODSPRICE)*/
                                                   GPS.ROWID
                                              FROM TGOODSPRICE GPS
                                             WHERE GPS.GOODS_CODE = GP.GOODS_CODE
                                               AND GPS.APPLY_DATE &lt;= SYSDATE
                                               AND ROWNUM = 1
                                          )
                           AND NOT EXISTS ( SELECT '1'
                                              FROM TPAGOODSPRICE TPG
                                             WHERE TPG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                                               AND TPG.PA_CODE    = #{paCode, jdbcType=VARCHAR}
                                               AND TPG.APPLY_DATE = GP.APPLY_DATE
                                           ) 
	</insert>
	
	<insert id="insertPaPromoTarget" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaPromoTarget by PaCommonController */
			   TPAPROMOTARGET PPMT
                             (PPMT.PROMO_NO
                            , PPMT.PA_CODE
                            , PPMT.GOODS_CODE
                            , PPMT.SEQ
                            , PPMT.DO_TYPE
                            , PPMT.COUPON_YN
                            , PPMT.IMMEDIATELY_YN
                            , PPMT.PROMO_BDATE
                            , PPMT.PROMO_EDATE
                            , PPMT.AMT_RATE_FLAG
                            , PPMT.DO_RATE
                            , PPMT.DO_AMT
                            , PPMT.STANDARD_APP_AMT
                            , PPMT.LIMIT_AMT
                            , PPMT.USE_CODE
                            , PPMT.OWN_COST
                            , PPMT.ENTP_COST
                            , PPMT.INSERT_ID
                            , PPMT.MODIFY_ID
                            , PPMT.PROC_GB
                            , PPMT.PA_GROUP_CODE
                            )
                      SELECT XX.PROMO_NO
                      	   , XX.PA_CODE
                      	   , XX.GOODS_CODE
                      	   , XX.SEQ
                      	   , XX.DO_TYPE
                      	   , XX.COUPON_YN
                      	   , XX.IMMEDIATELY_YN
                      	   , XX.PROMO_BDATE
                      	   , XX.PROMO_EDATE
                      	   , XX.AMT_RATE_FLAG
                      	   , XX.DO_RATE
                      	   , XX.DO_AMT
                      	   , XX.STANDARD_APP_AMT
                      	   , XX.LIMIT_AMT
                      	   , XX.USE_CODE
                      	   , XX.OWN_COST
                      	   , XX.ENTP_COST
                      	   , XX.INSERT_ID
                      	   , XX.MODIFY_ID
                      	   , XX.PROC_GB
                      	   , XX.PA_GROUP_CODE
                        FROM( SELECT PM.PROMO_NO
		                           , PGP.PA_CODE
		                           , PMT.GOODS_CODE
		                           , (SELECT LTRIM(TO_CHAR(NVL(MAX(TO_NUMBER(PPMT2.SEQ)), 0) + 1, '0000'))
		                                FROM TPAPROMOTARGET PPMT2
		                               WHERE PPMT2.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		                                 AND PPMT2.PROMO_NO = PMT.PROMO_NO
		                                 AND PPMT2.PA_CODE = PGP.PA_CODE) AS SEQ
		                           , PM.DO_TYPE
		                           , PM.COUPON_YN
		                           , PM.IMMEDIATELY_YN
		                           , PM.PROMO_BDATE
		                           , PM.PROMO_EDATE
		                           , PM.AMT_RATE_FLAG
		                           , PM.DO_RATE
		                           , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
		                              (CASE WHEN PM.LIMIT_AMT &gt; 0
		                                 THEN (
		                                   CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) &gt; PM.LIMIT_AMT
		                                     THEN PM.LIMIT_AMT
		                                     ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                   END
		                              ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                              END )
		                              ELSE
		                             PM.DO_AMT END AS DO_AMT
		                           , PM.STANDARD_APP_AMT
		                           , PM.LIMIT_AMT
		                           , PM.USE_CODE
		                           , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                            THEN TRUNC(
		                                (CASE WHEN PM.LIMIT_AMT &gt; 0
		                                   THEN (
		                                     CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) &gt; PM.LIMIT_AMT
		                                       THEN PM.LIMIT_AMT
		                                       ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                     END
		                                ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                END )
		                             * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                           ELSE NVL(PMT.OWN_COST,0) END AS OWN_COST
		                           , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                          THEN
		                              (CASE WHEN PM.LIMIT_AMT &gt; 0
		                                 THEN (
		                                   CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) &gt; PM.LIMIT_AMT
		                                     THEN PM.LIMIT_AMT
		                                     ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                   END
		                              ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                              END )
		
		                          - TRUNC(
		
		                              (CASE WHEN PM.LIMIT_AMT &gt; 0
		                                 THEN (
		                                   CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) &gt; PM.LIMIT_AMT
		                                     THEN PM.LIMIT_AMT
		                                     ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                   END
		                              ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                              END )
		
		                           * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                       ELSE NVL(PMT.ENTP_COST, 0) END AS ENTP_COST
		                           , 'PAE' AS INSERT_ID
		                           , 'PAE' AS MODIFY_ID
		                           , 'I'   AS PROC_GB
		                           , #{paGroupCode, jdbcType=VARCHAR} AS PA_GROUP_CODE
		                           , PGP.SALE_PRICE - PGP.DC_AMT - PGP.LUMP_SUM_DC_AMT AS PROMO_CHECK_AMT		                           
		                        FROM TPROMOM       PM
		                           , TPPROMOTARGET  PMT
		                           , TPAGOODSPRICE PGP
		                       WHERE PM.PROMO_NO        = PMT.PROMO_NO
		                         AND PGP.GOODS_CODE     = PMT.GOODS_CODE
		                         <if test='paGroupCode == "02" or paGroupCode == "03"'>
		                         	AND PGP.PA_CODE        IN ('21', '22')
		                         </if>
		                         AND PM.COUPON_YN       = '1'
		                         AND PM.DO_TYPE         = '30'
		                         AND PM.IMMEDIATELY_YN  = '1'
		                         AND PM.PROMO_BDATE &lt;= SYSDATE
		                         AND PM.PROMO_EDATE &gt; SYSDATE - 1
		                         <if test='paGroupCode == "01"'>
			                         AND ((INSTR(PGP.PA_CODE, '11') &gt; 0) OR (INSTR(PGP.PA_CODE, '12') &gt; 0))
			                         AND (INSTR(PM.MEDIA_CODE, 'EX01') &gt; 0)
		                         </if>
		                         <if test='paGroupCode == "02"'>
		                         	AND INSTR(PM.MEDIA_CODE, 'EX02') &gt; 0
		                         </if>
		                         <if test='paGroupCode == "03"'>
		                         	AND INSTR(PM.MEDIA_CODE, 'EX03') &gt; 0
		                         </if>
		                         AND PMT.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		                         AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                                                 GP.ROWID
		                                            FROM TPAGOODSPRICE GP
		                                           WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                                             AND GP.APPLY_DATE &lt; SYSDATE
		                                             AND GP.PA_CODE = PGP.PA_CODE
		                                             AND ROWNUM = 1)
				                 AND NOT EXISTS ( SELECT 'X' 
							                        FROM TPAPROMOEXCEPTENTP PEE
							                           , TPAPROMOEXCEPTBRAND PEB
							                           , TGOODS TG 
							                       WHERE PMT.GOODS_CODE = TG.GOODS_CODE
							                         AND TG.ENTP_CODE = PEE.ENTP_CODE
							                         AND PEE.ENTP_CODE = PEB.ENTP_CODE
							                         AND TG.BRAND_CODE = PEB.BRAND_CODE
							                         AND PEB.USE_YN = '1'
							                         AND (INSTR(PEE.PA_GROUP_CODE, #{paGroupCode, jdbcType=VARCHAR}) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
							                         AND (PEB.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEB.PA_EXCEPT_EDATE >= SYSDATE)
					                            )                               
					 			 AND NOT EXISTS ( SELECT 'X' 
					                          	    FROM TPAPROMOEXCEPTENTP PEE
					                      		       , TGOODS TG 
					                     		   WHERE PMT.GOODS_CODE = TG.GOODS_CODE
					                      		     AND TG.ENTP_CODE = PEE.ENTP_CODE
					                     		     AND PEE.USE_YN = '1'
					                      		     AND (INSTR(PEE.PA_GROUP_CODE, #{paGroupCode, jdbcType=VARCHAR}) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
					                      			 AND (PEE.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEE.PA_EXCEPT_EDATE >= SYSDATE)
					                      			 AND PEE.ALL_BRAND_YN = '1'
					                            ) )XX
								LEFT OUTER JOIN TPAPROMOTARGETEXCEPT TPE ON TPE.TARGET_CODE = XX.GOODS_CODE AND TPE.USE_YN = '1' AND (INSTR(TPE.PA_GROUP_CODE, XX.PA_GROUP_CODE ) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1) 
					                                                    AND SYSDATE BETWEEN TPE.PA_EXCEPT_BDATE AND TPE.PA_EXCEPT_EDATE AND TPE.TARGET_GB = '00'
					   WHERE (TPE.TARGET_CODE IS NULL OR ((XX.PROMO_CHECK_AMT - XX.DO_AMT) >= TPE.PA_EXCEPT_MARGIN) )
					                            
	</insert>
	
	<insert id="insertPaPromoTargetCommon" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaPromoTargetCommon by PaCommonController */
			   TPAPROMOTARGET PPMT
                             (PPMT.PROMO_NO
                            , PPMT.PA_CODE
                            , PPMT.GOODS_CODE
                            , PPMT.SEQ
                            , PPMT.DO_TYPE
                            , PPMT.COUPON_YN
                            , PPMT.IMMEDIATELY_YN
                            , PPMT.PROMO_BDATE
                            , PPMT.PROMO_EDATE
                            , PPMT.AMT_RATE_FLAG
                            , PPMT.DO_RATE
                            , PPMT.DO_AMT
                            , PPMT.STANDARD_APP_AMT
                            , PPMT.LIMIT_AMT
                            , PPMT.USE_CODE
                            , PPMT.OWN_COST
                            , PPMT.ENTP_COST
                            , PPMT.INSERT_ID
                            , PPMT.MODIFY_ID
                            , PPMT.PROC_GB
                            , PPMT.PA_GROUP_CODE
                            )
                      SELECT XX.PROMO_NO
                      	   , XX.PA_CODE
                      	   , XX.GOODS_CODE
                      	   , XX.SEQ
                      	   , XX.DO_TYPE
                      	   , XX.COUPON_YN
                      	   , XX.IMMEDIATELY_YN
                      	   , XX.PROMO_BDATE
                      	   , XX.PROMO_EDATE
                      	   , XX.AMT_RATE_FLAG
                      	   , XX.DO_RATE
                      	   , XX.DO_AMT
                      	   , XX.STANDARD_APP_AMT
                      	   , XX.LIMIT_AMT
                      	   , XX.USE_CODE
                      	   , XX.OWN_COST
                      	   , XX.ENTP_COST
                      	   , XX.INSERT_ID
                      	   , XX.MODIFY_ID
                      	   , XX.PROC_GB
                      	   , XX.PA_GROUP_CODE
                      	FROM ( SELECT PM.PROMO_NO
		                            , PGP.PA_CODE
		                            , PMT.GOODS_CODE
		                            , (SELECT LTRIM(TO_CHAR(NVL(MAX(TO_NUMBER(PPMT2.SEQ)), 0) + 1, '0000'))
		                                FROM TPAPROMOTARGET PPMT2
		                               WHERE PPMT2.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		                                 AND PPMT2.PROMO_NO   = PMT.PROMO_NO
		                                 AND PPMT2.PA_CODE    = PGP.PA_CODE) AS SEQ
		                            , PM.DO_TYPE
		                            , PM.COUPON_YN
		                            , PM.IMMEDIATELY_YN
		                            , PM.PROMO_BDATE
		                            , PM.PROMO_EDATE
		                            , PM.AMT_RATE_FLAG
		                            , PM.DO_RATE
		                            , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
		                               (CASE WHEN PM.LIMIT_AMT > 0
		                                 THEN (
		                                   CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                     THEN PM.LIMIT_AMT
		                                     ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                   END
		                              ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                              END )
		                              ELSE
		                              PM.DO_AMT END AS DO_AMT
		                            , PM.STANDARD_APP_AMT
		                            , PM.LIMIT_AMT
		                            , PM.USE_CODE
		                            , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                             THEN TRUNC(
		                                (CASE WHEN PM.LIMIT_AMT > 0
		                                   THEN (
		                                     CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                       THEN PM.LIMIT_AMT
		                                       ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                     END
		                                ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                END )
		                             * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                           ELSE NVL(PMT.OWN_COST, 0) END AS OWN_COST
		                           , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                          THEN
		                              (CASE WHEN PM.LIMIT_AMT > 0
		                                 THEN (
		                                   CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                     THEN PM.LIMIT_AMT
		                                     ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                   END
		                              ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                              END )
		
		                          - TRUNC(
		
		                              (CASE WHEN PM.LIMIT_AMT > 0
		                                 THEN (
		                                   CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                     THEN PM.LIMIT_AMT
		                                     ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                   END
		                              ) ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                              END )
		
		                           * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                       ELSE NVL(PMT.ENTP_COST, 0) END AS ENTP_COST
		                           , '999999' AS INSERT_ID
		                           , '999999' AS MODIFY_ID
		                           , 'I' AS PROC_GB
		                           , #{paGroupCode, jdbcType=VARCHAR} AS PA_GROUP_CODE
								   , PGP.SALE_PRICE - PGP.DC_AMT - PGP.LUMP_SUM_DC_AMT AS PROMO_CHECK_AMT	
		                           
		                        FROM TPROMOM       PM
		                           , TPPROMOTARGET  PMT
		                           , TPAGOODSPRICE PGP
		                           , TCODE TC
		                           , TPAGOODSTARGET PT
		                       WHERE PM.PROMO_NO        = PMT.PROMO_NO
		                         AND PGP.GOODS_CODE     = PMT.GOODS_CODE
		                         AND PM.COUPON_YN       = '1'
		                         AND PM.DO_TYPE         = '30'
		                         AND PM.IMMEDIATELY_YN  = '1'
		                         AND PM.PROMO_BDATE &lt;= SYSDATE
		                         AND PM.PROMO_EDATE > SYSDATE - 1
		                         /* (TCODE, TPAGOODSTARGET 조인 후 이 아래쪽 수정함. 공통으로 사용하기 위해) */
		                         AND TC.CODE_LGROUP     = 'O500'
		                         AND TC.CODE_MGROUP     = #{paGroupCode, jdbcType=VARCHAR}
		                         AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		                         AND PT.PA_GROUP_CODE   = TC.CODE_MGROUP
		                         AND PGP.GOODS_CODE     = PT.GOODS_CODE
		                         AND PGP.PA_CODE        = PT.PA_CODE
		                         AND PMT.GOODS_CODE     = #{goodsCode, jdbcType=VARCHAR}
		                         AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                                                 GP.ROWID
		                                            FROM TPAGOODSPRICE GP
		                                           WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                                             AND GP.APPLY_DATE &lt; SYSDATE
		                                             AND GP.PA_CODE = PGP.PA_CODE
		                                             AND ROWNUM = 1)   
				                 AND NOT EXISTS ( SELECT 'X' 
							                        FROM TPAPROMOEXCEPTENTP PEE
							                           , TPAPROMOEXCEPTBRAND PEB
							                           , TGOODS TG 
							                       WHERE PMT.GOODS_CODE = TG.GOODS_CODE
							                         AND TG.ENTP_CODE = PEE.ENTP_CODE
							                         AND PEE.ENTP_CODE = PEB.ENTP_CODE
							                         AND TG.BRAND_CODE = PEB.BRAND_CODE
							                         AND PEB.USE_YN = '1'
							                         AND (INSTR(PEE.PA_GROUP_CODE, #{paGroupCode, jdbcType=VARCHAR}) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
							                         AND (PEB.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEB.PA_EXCEPT_EDATE >= SYSDATE)
					                            )                               
					 			 AND NOT EXISTS ( SELECT 'X' 
					                          	    FROM TPAPROMOEXCEPTENTP PEE
					                      		       , TGOODS TG 
					                     		   WHERE PMT.GOODS_CODE = TG.GOODS_CODE
					                      		     AND TG.ENTP_CODE = PEE.ENTP_CODE
					                     		     AND PEE.USE_YN = '1'
					                      		     AND (INSTR(PEE.PA_GROUP_CODE, #{paGroupCode, jdbcType=VARCHAR}) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
					                      			 AND (PEE.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEE.PA_EXCEPT_EDATE >= SYSDATE)
					                      			 AND PEE.ALL_BRAND_YN = '1' ))XX
								LEFT OUTER JOIN TPAPROMOTARGETEXCEPT TPE ON TPE.TARGET_CODE = XX.GOODS_CODE AND TPE.USE_YN = '1' AND (INSTR(TPE.PA_GROUP_CODE, XX.PA_GROUP_CODE ) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1) 
					                                                    AND SYSDATE BETWEEN TPE.PA_EXCEPT_BDATE AND TPE.PA_EXCEPT_EDATE AND TPE.TARGET_GB = '00'
					   WHERE (TPE.TARGET_CODE IS NULL OR ((XX.PROMO_CHECK_AMT - XX.DO_AMT) >= TPE.PA_EXCEPT_MARGIN) )
					                      			    
	</insert>
	
	<insert id="insertPaGoodsImage" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsImage by PaCommonController */
			   TPAGOODSIMAGE ( GOODS_CODE
                             , PA_GROUP_CODE
                             , IMAGE_P
                             , IMAGE_AP
                             , IMAGE_BP
                             , IMAGE_CP
                             , IMAGE_DP
                             , IMAGE_URL
                             , TRANS_TARGET_YN
                             , LAST_SYNC_DATE
                             , INSERT_ID
                             , INSERT_DATE
                             , MODIFY_ID
                             , MODIFY_DATE
                             )
                        SELECT GI.GOODS_CODE
                             , DECODE(#{paGroupCode, jdbcType=VARCHAR}, '03', '02', #{paGroupCode, jdbcType=VARCHAR})
                             , NVL(GI.IMAGE_C,  GI.IMAGE_G)
                             , NVL(GI.IMAGE_AT, GI.IMAGE_AG)
                             , NVL(GI.IMAGE_BT, GI.IMAGE_BG)
                             , NVL(GI.IMAGE_CT, GI.IMAGE_CG)
                             , NVL(GI.IMAGE_DT, GI.IMAGE_DG)
                             , GI.IMAGE_URL
                             , '1'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                          FROM TGOODSIMAGE GI
                         WHERE GI.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                           AND NOT EXISTS ( SELECT '1'
                                              FROM TPAGOODSIMAGE TGI
                                             WHERE TGI.GOODS_CODE    = GI.GOODS_CODE
                                               AND TGI.PA_GROUP_CODE = DECODE(#{paGroupCode, jdbcType=VARCHAR}, '03', '02', #{paGroupCode, jdbcType=VARCHAR})
                                           )
	</insert>
	
	<insert id="insertPaGoodsDt" parameterType="String">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsDt by PaCommonController */
			   TPAGOODSDT ( GOODS_CODE
                          , GOODSDT_CODE
                          , GOODSDT_INFO
                          , GOODSDT_INFO_KIND
                          , SORT_TYPE
                          , INSERT_ID
                          , INSERT_DATE
                          , MODIFY_ID
                          , MODIFY_DATE
                          , SALE_GB
                          )
                    SELECT GD.GOODS_CODE
                         , GD.GOODSDT_CODE
                         , GD.GOODSDT_INFO
                         , NVL(DECODE(GD.COLOR_CODE, '000', '', '색상/') || DECODE(GD.SIZE_CODE, '000', '', '사이즈/') ||
                           DECODE(GD.PATTERN_CODE, '000', '', '무늬/')   || DECODE(GD.FORM_CODE, '000', '', '형태/')  ||
                           DECODE(GD.OTHER_TEXT, '', '', '기타'), GD.GOODSDT_INFO)
                         , '00'
                         , '999999'
                         , SYSDATE
                         , '999999'
                         , SYSDATE
                         , GD.SALE_GB
                      FROM TGOODSDT GD
                     WHERE GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                       AND NOT EXISTS ( SELECT '1'
                                          FROM TPAGOODSDT GDS
                                         WHERE GDS.GOODS_CODE   = GD.GOODS_CODE
                                           AND GDS.GOODSDT_CODE = GD.GOODSDT_CODE
                                       )
                       AND GD.SALE_GB != '19'
                  ORDER BY GD.GOODSDT_CODE
	</insert>
	
	<insert id="insertPaGoodsDtMapping" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsDtMapping by PaCommonController */
		       TPAGOODSDTMAPPING ( GOODS_CODE
		                         , GOODSDT_CODE
		                         , PA_CODE
		                         , TRANS_TARGET_YN
		                         , LAST_SYNC_DATE
		                         , INSERT_ID
		                         , INSERT_DATE
		                         , MODIFY_ID
		                         , MODIFY_DATE
		                         , COMBINATION_YN
		                         )
		                    SELECT PD.GOODS_CODE
		                         , PD.GOODSDT_CODE
		                         , #{paCode, jdbcType=VARCHAR}
		                         , '1'
		                         , SYSDATE
		                         , '999999'
		                         , SYSDATE
		                         , '999999'
		                         , SYSDATE
		                         , CASE WHEN #{paGroupCode, jdbcType=VARCHAR} = '02' OR #{paGroupCode, jdbcType=VARCHAR} = '03' THEN
		                                    (SELECT CASE WHEN COUNT(DISTINCT PD2.GOODSDT_INFO_KIND) = 1 THEN 1 ELSE 0 END COMBINATION_YN
		                                       FROM TPAGOODSDT PD2
		                                      WHERE PD2.GOODS_CODE = PD.GOODS_CODE
		                                        AND EXISTS ( SELECT (1)
		                                                      FROM TPAGOODSDT PD3
		                                                     WHERE PD3.GOODS_CODE = PD2.GOODS_CODE
		                                                       AND PD3.GOODSDT_INFO_KIND = '색상/사이즈/'
		                                                   ))
		                                ELSE 0 END
		                      FROM TPAGOODSDT PD
		                         , TGOODSDT GD
		                     WHERE PD.GOODS_CODE   = #{goodsCode, jdbcType=VARCHAR}
		                       AND PD.GOODS_CODE   = GD.GOODS_CODE
		                       AND PD.GOODSDT_CODE = GD.GOODSDT_CODE
		                       AND GD.SALE_GB &lt;&gt; '19'
		                       AND NOT EXISTS ( SELECT '1'
		                                          FROM TPAGOODSDTMAPPING GDS
		                                         WHERE GDS.GOODS_CODE   = GD.GOODS_CODE
		                                           AND GDS.GOODSDT_CODE = GD.GOODSDT_CODE
		                                           AND GDS.PA_CODE      = #{paCode, jdbcType=VARCHAR}
		                                      )
		                  ORDER BY PD.GOODSDT_CODE
	</insert>
	
	<select id="selectPaCopnCheckGoodsOffer" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaCopnCheckGoodsOffer by PaCommonController */
		       COUNT(1)
          FROM TPAGOODSOFFER GO
         WHERE GO.PA_GROUP_CODE = '05'
           AND GO.USE_YN = '1'
           AND GO.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectPaCopnPaOfferBo" parameterType="String" resultType="String">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaCopnPaOfferBo by PaCommonController */
			   NVL(MAX(PC.PA_OFFER_TYPE_NAME),'999999')
	      FROM TPAOFFERCODE PC
             , TPAGOODSOFFER PO
         WHERE PC.PA_OFFER_TYPE = PO.PA_OFFER_TYPE
           AND PC.PA_OFFER_CODE = PO.PA_OFFER_CODE
           AND PC.USE_YN 		= '1'
           AND PO.USE_YN 		= '1'
           AND PC.PA_GROUP_CODE = '05'
           AND PO.PA_GROUP_CODE = '05'
           AND PO.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectCheckPaCopnAttr" parameterType="hashMap" resultType="int">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectCheckPaCopnAttr by PaCommonController */
	    	   COUNT(1)
	      FROM TPACOPNCTGRATTRLIST PT
         WHERE PT.PA_LMSD_KEY  = #{paLmsdKey, jdbcType=VARCHAR}
           AND PT.NOTICE_CATEGORY_NAME LIKE '%'||#{paOfferTypeName, jdbcType=VARCHAR}||'%'
           AND ROWNUM = 1
	</select>
	
	<select id="selectPaCopnPaOffer" parameterType="String" resultType="String">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaCopnPaOffer by PaCommonController */
			   NVL(MAX(PC.PA_OFFER_TYPE_NAME),'999999')
	      FROM TPAOFFERCODE PC
             , TPAOFFERCODEMAPPING PM
             , TOFFER O
         WHERE PC.PA_OFFER_TYPE = PM.PA_OFFER_TYPE
           AND PC.PA_OFFER_CODE = PM.PA_OFFER_CODE
           AND PM.OFFER_TYPE 	= O.OFFER_TYPE
           AND PM.OFFER_CODE 	= O.OFFER_CODE
           AND PC.USE_YN 		= '1'
           AND O.USE_YN 		= '1'
           AND PC.PA_GROUP_CODE = '05'
           AND O.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectCheckPaCopnAttrEtc" parameterType="hashMap" resultType="int">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectCheckPaCopnAttrEtc by PaCommonController */
	    	   COUNT(1)
	      FROM TPACOPNCTGRATTRLIST PT
         WHERE PT.PA_LMSD_KEY  = #{paLmsdKey, jdbcType=VARCHAR}
           AND REPLACE(REPLACE(PT.NOTICE_CATEGORY_NAME, ' ', ''), '기타재화(유통기간)', '') LIKE '%'||#{paOfferTypeName, jdbcType=VARCHAR}||'%'
           AND ROWNUM = 1
	</select>
	
	<select id="selectPaCopnAttrEtcName" parameterType="hashMap" resultType="String">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectPaCopnAttrEtcName by PaCommonController */
	    	   NVL(SUBSTR(REPLACE(REPLACE(PT.NOTICE_CATEGORY_NAME, '"', ''),' ',''), 1, INSTR(REPLACE(REPLACE(PT.NOTICE_CATEGORY_NAME, '"', ''),' ',''),',')-1)
                  ,REPLACE(REPLACE(PT.NOTICE_CATEGORY_NAME, '"', ''),' ','')) AS NOTICE_CATEGORY_NAME
	      FROM TPACOPNCTGRATTRLIST PT
         WHERE PT.PA_LMSD_KEY  = #{paLmsdKey, jdbcType=VARCHAR}
           AND ROWNUM = 1
	</select>
	
	<insert id="insertPaGoodsOfferCopnEtc" parameterType="String">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsOfferCopnEtc by PaCommonController */
			   TPAGOODSOFFER ( GOODS_CODE
                             , PA_GROUP_CODE
                             , PA_OFFER_TYPE
                             , PA_OFFER_CODE
                             , PA_OFFER_EXT
                             , REMARK1
                             , REMARK2
                             , USE_YN
                             , TRANS_TARGET_YN
                             , LAST_SYNC_DATE
                             , INSERT_ID
                             , INSERT_DATE
                             , MODIFY_ID
                             , MODIFY_DATE
                             )
                        SELECT #{goodsCode, jdbcType=VARCHAR}
                             , PO.PA_GROUP_CODE
                             , PO.PA_OFFER_TYPE
                             , PO.PA_OFFER_CODE
                             , '상세설명 참조' AS OFFER_CONTENTS
                             , ''
                             , ''
                             , '1'
                             , '1'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                          FROM TPAOFFERCODE PO
                         WHERE PO.PA_OFFER_TYPE = '0529'
                           AND PO.PA_GROUP_CODE = '05'
	</insert>
	
	<insert id="insertPaGoodsOfferCopnName" parameterType="hashMap">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsOfferCopnName by PaCommonController */
			   TPAGOODSOFFER ( GOODS_CODE
                             , PA_GROUP_CODE
                             , PA_OFFER_TYPE
                             , PA_OFFER_CODE
                             , PA_OFFER_EXT
                             , REMARK1
                             , REMARK2
                             , USE_YN
                             , TRANS_TARGET_YN
                             , LAST_SYNC_DATE
                             , INSERT_ID
                             , INSERT_DATE
                             , MODIFY_ID
                             , MODIFY_DATE
                             )
                        SELECT #{goodsCode, jdbcType=VARCHAR}
                             , PO.PA_GROUP_CODE
                             , PO.PA_OFFER_TYPE
                             , PO.PA_OFFER_CODE
                             , '상세설명 참조' AS OFFER_CONTENTS
                             , ''
                             , ''
                             , '1'
                             , '1'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                             , '999999'
                             , SYSDATE
                          FROM TPAOFFERCODE PO
                         WHERE REPLACE(PO.PA_OFFER_TYPE_NAME, ' ', '') = #{paCtgEtcName, jdbcType=VARCHAR}
                           AND PO.PA_GROUP_CODE = '05'
	</insert>
	
	<insert id="insertPaGoodsOffer" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsOffer by PaCommonController */
			   TPAGOODSOFFER ( GOODS_CODE
                             , PA_GROUP_CODE
                             , PA_OFFER_TYPE
                             , PA_OFFER_CODE
                             , PA_OFFER_EXT
                             , REMARK1
                             , REMARK2
                             , USE_YN
                             , TRANS_TARGET_YN
                             , LAST_SYNC_DATE
                             , INSERT_ID
                             , INSERT_DATE
                             , MODIFY_ID
                             , MODIFY_DATE
                             )
			WITH PAOM AS (
			SELECT PO.PA_GROUP_CODE, PO.PA_OFFER_TYPE, PO.PA_OFFER_CODE, OM.OFFER_TYPE, OM.OFFER_CODE
			  FROM TPAOFFERCODE PO
				 , TPAOFFERCODEMAPPING OM
			 WHERE PO.USE_YN = '1'
			   AND PO.REQUIRED_YN = '1'
			   AND PO.PA_GROUP_CODE = OM.PA_GROUP_CODE(+)
			   AND PO.PA_OFFER_TYPE = OM.PA_OFFER_TYPE(+)
			   AND PO.PA_OFFER_CODE = OM.PA_OFFER_CODE(+)
						 )
			SELECT #{goodsCode, jdbcType=VARCHAR}
				 , DECODE(#{paGroupCode, jdbcType=VARCHAR}, '03', '02', #{paGroupCode, jdbcType=VARCHAR})
				 , A.PA_OFFER_TYPE
				 , A.PA_OFFER_CODE
				 , NVL(B.OFFER_CONTENTS, '상세설명 참조') AS OFFER_CONTENTS
				 , ''
				 , ''
				 , '1'
				 , '1'
				 , SYSDATE
				 , '999999'
				 , SYSDATE
				 , '999999'
				 , SYSDATE
			  FROM PAOM A
				 , TOFFER B
			   <if test='paGroupCode != null and paGroupCode == "10" and  offerType != null and offerType == "20"'>
                 , TGOODSSSGFOOD SF
               </if>
			 WHERE EXISTS ( SELECT 1
							  FROM TPAOFFERCODEMAPPING OMS
							 WHERE OMS.OFFER_TYPE    = #{offerType, jdbcType=VARCHAR}
							   AND OMS.PA_GROUP_CODE = DECODE(#{paGroupCode, jdbcType=VARCHAR}, '03', '02', #{paGroupCode, jdbcType=VARCHAR})
							   AND OMS.PA_OFFER_TYPE = A.PA_OFFER_TYPE
							   AND OMS.PA_GROUP_CODE = A.PA_GROUP_CODE
						  )
			   AND B.GOODS_CODE(+) = #{goodsCode, jdbcType=VARCHAR}
			   AND A.OFFER_TYPE = B.OFFER_TYPE(+)
			   AND A.OFFER_CODE = B.OFFER_CODE(+)
			   AND NOT EXISTS ( SELECT '1'
								  FROM TPAGOODSOFFER GDS
								 WHERE GDS.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
								   AND GDS.PA_GROUP_CODE = DECODE(#{paGroupCode, jdbcType=VARCHAR}, '03', '02', #{paGroupCode, jdbcType=VARCHAR})
							  )
	         <if test='paGroupCode != null and paGroupCode == "10" and  offerType != null and offerType == "20"'>       
               AND SF.GOODS_CODE(+) = B.GOODS_CODE 
               AND A.PA_OFFER_TYPE = CASE WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}) = '1') THEN '0000000019'
                                          WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}) = '2') THEN '0000000021'
                                          WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}) = '3') THEN '0000000020' END
             </if>  
	</insert>
	
	<insert id="insertPaCopnAttriNoLimit" parameterType="String">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaCopnAttriNoLimit by PaCommonController */
			   TPACOPNGOODSATTRI( GOODS_CODE
	                            , ATTRIBUTE_SEQ
	                            , ATTRIBUTE_TYPE_NAME
	                            , ATTRIBUTE_VALUE_NAME
	                            , ATTRIBUTE_TYPE_MAPPING
	                            , DATA_TYPE
	                            , BASIC_UNIT
	                            , USABLE_UNITS
	                            , GROUP_NUMBER
	                            , EXPOSED
	                            , REQUIRED_YN
	                            , INSERT_ID
	                            , INSERT_DATE
	                            , MODIFY_ID
	                            , MODIFY_DATE
	                            )
	                     VALUES ( #{goodsCode, jdbcType=VARCHAR}
	                            , (SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(PCR.ATTRIBUTE_SEQ)) + 1), 3, '0'), '001')
	                                 FROM TPACOPNGOODSATTRI PCR
	                                WHERE PCR.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	                              )
	                            , '색상/크기/무늬/형태'
	                            , ''
	                            , '색상,사이즈,무늬,형태'
	                            , 'STRING'
	                            , '없음'
	                            , ''
	                            , 'NONE'
	                            , '1'
	                            , '0'
	                            , '999999'
	                            , SYSDATE
	                            , '999999'
	                            , SYSDATE
	                           )
	</insert>
	
	<select id="selectChkPaCustShipCostYn" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectChkPaCustShipCostYn by PaCommonController */
			   COUNT(1)
	      FROM TPACUSTSHIPCOST PC
         	 , TGOODS          G
	     WHERE PC.ENTP_CODE      = DECODE(G.DELY_TYPE, '10', '100001', G.ENTP_CODE)
	       AND PC.SHIP_COST_CODE = G.SHIP_COST_CODE
	       AND PC.PA_CODE        = #{paCode,    jdbcType=VARCHAR}
	       AND G.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectChkPaTmonCustShipCostYn" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectChkPaTmonCustShipCostYn by PaCommonController */
			   COUNT(1)
	      FROM TGOODS G
			 , TGOODSADDINFO AI
			 , TSHIPCOSTM  CM
			 , TSHIPCOSTDT CD1
			 , TSHIPCOSTDT CD2
			 , TSHIPCOSTDT CD3
			 , TPATMONSHIPCOST PC
		 WHERE G.GOODS_CODE = AI.GOODS_CODE
		   AND DECODE(G.DELY_TYPE, '10', '100001', G.ENTP_CODE) = CM.ENTP_CODE
		   AND G.SHIP_COST_CODE		= CM.SHIP_COST_CODE
		   AND CM.ENTP_CODE			= CD1.ENTP_CODE
		   AND CM.ENTP_CODE			= CD2.ENTP_CODE
		   AND CM.ENTP_CODE			= CD3.ENTP_CODE
		   AND CM.SHIP_COST_CODE	= CD1.SHIP_COST_CODE
		   AND CM.SHIP_COST_CODE	= CD2.SHIP_COST_CODE
		   AND CM.SHIP_COST_CODE	= CD3.SHIP_COST_CODE
		   AND CD1.CUST_AREA_GB		= '10'
		   AND CD2.CUST_AREA_GB		= '20'
		   AND CD3.CUST_AREA_GB		= '30'
		   AND CD1.APPLY_DATE		= CD2.APPLY_DATE
		   AND CD1.APPLY_DATE		= CD3.APPLY_DATE
		   AND CD1.APPLY_DATE		= ( SELECT MAX(CD.APPLY_DATE)
										  FROM TSHIPCOSTDT CD
										 WHERE CD.ENTP_CODE      = CM.ENTP_CODE
										   AND CD.SHIP_COST_CODE = CM.SHIP_COST_CODE
										   AND SYSDATE        &gt; APPLY_DATE )
		   AND G.GOODS_CODE			= #{goodsCode, jdbcType=VARCHAR}
		   AND PC.PA_CODE			= #{paCode,    jdbcType=VARCHAR}
		   AND PC.ENTP_CODE			= CM.ENTP_CODE
		   AND PC.PRODUCT_TYPE		= DECODE(G.INSTALL_YN, '1', 'DP04', DECODE(AI.ORDER_CREATE_YN, '1', 'DP05', 'DP07'))
		   AND PC.SHIP_MAN_SEQ		= DECODE(G.DELY_TYPE, '10', '003', G.SHIP_MAN_SEQ)
		   AND PC.RETURN_MAN_SEQ	= DECODE(G.DELY_TYPE, '10', '002', G.RETURN_MAN_SEQ)
		   AND PC.SHIP_COST_CODE	= G.SHIP_COST_CODE
		   AND PC.APPLY_DATE		= CD1.APPLY_DATE
		   AND PC.NO_SHIP_ISLAND	= NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = G.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0)
	</select>
	
	<insert id="insertPaCustShipCost" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaCustShipCost by PaCommonController */
			   TPACUSTSHIPCOST ( PA_CODE
                               , ENTP_CODE
                               , SHIP_COST_CODE
                               , GROUP_CODE
                               , SHIP_COST_BASE_AMT
                               , ORD_COST
                               , RETURN_COST
                               , CHANGE_COST
                               , ISLAND_COST
                               , JEJU_COST
                               , TRANS_TARGET_YN
                               , LAST_SYNC_DATE
                               , INSERT_ID
                               , INSERT_DATE
                               , MODIFY_ID
                               , MODIFY_DATE
                               )
                          SELECT #{paCode, jdbcType=VARCHAR}
                               , CM.ENTP_CODE
                               , CM.SHIP_COST_CODE
                               , ''
                               , SUBSTR(CM.SHIP_COST_BASE_AMT, 0, 7)
                               , CD1.ORD_COST_AMT
                               , CD1.RET_COST_AMT AS RET_COST_AMT
                               , CD1.EXCH_COST_AMT AS EXCH_COST_AMT
                               , CD2.ORD_COST_AMT
                               , CD3.ORD_COST_AMT
                               , '1'
                               , SYSDATE
                               , '999999'
                               , SYSDATE
                               , '999999'
                               , SYSDATE
                            FROM TSHIPCOSTM  CM
                               , TSHIPCOSTDT CD1
                               , TSHIPCOSTDT CD2
                               , TSHIPCOSTDT CD3
                               , TGOODS TG
                           WHERE TG.GOODS_CODE     = #{goodsCode, jdbcType=VARCHAR}
                             AND CM.ENTP_CODE      = CD1.ENTP_CODE
                             AND CM.ENTP_CODE      = CD2.ENTP_CODE
                             AND CM.ENTP_CODE      = CD3.ENTP_CODE
                             AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
                             AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
                             AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
                             AND CM.ENTP_CODE      = DECODE(TG.DELY_TYPE, '10', '100001', TG.ENTP_CODE)
                             AND CM.SHIP_COST_CODE = TG.SHIP_COST_CODE
                             AND CD1.CUST_AREA_GB  = '10'
                             AND CD2.CUST_AREA_GB  = '20'
                             AND CD3.CUST_AREA_GB  = '30'
                             AND CD1.APPLY_DATE    = CD2.APPLY_DATE
                             AND CD1.APPLY_DATE    = CD3.APPLY_DATE
                             AND CD1.APPLY_DATE    = ( SELECT MAX(APPLY_DATE)
                                                         FROM TSHIPCOSTDT
                                                        WHERE ENTP_CODE      = CM.ENTP_CODE
                                                          AND SHIP_COST_CODE = CM.SHIP_COST_CODE
                                                          AND SYSDATE        &gt; APPLY_DATE )
	</insert>
	
	<insert id="insertPaTmonCustShipCost" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaTmonCustShipCost by PaCommonController */
			   TPATMONSHIPCOST ( PA_CODE
                               , ENTP_CODE
                               , PRODUCT_TYPE
                               , SHIP_MAN_SEQ
                               , RETURN_MAN_SEQ
                               , SHIP_COST_CODE
                               , APPLY_DATE
                               , NO_SHIP_ISLAND
                               , SHIP_COST_BASE_AMT
                               , ORD_COST
                               , RETURN_COST
                               , CHANGE_COST
                               , ISLAND_COST
                               , JEJU_COST
                               , INSERT_ID
                               , INSERT_DATE
                               , MODIFY_ID
                               , MODIFY_DATE
                               )
                          SELECT #{paCode, jdbcType=VARCHAR}
							   , CM.ENTP_CODE
							   , DECODE(G.INSTALL_YN, '1', 'DP04', DECODE(AI.ORDER_CREATE_YN, '1', 'DP05', 'DP07')) AS PRODUCT_TYPE
							   , DECODE(G.DELY_TYPE, '10', '003', G.SHIP_MAN_SEQ)
							   , DECODE(G.DELY_TYPE, '10', '002', G.RETURN_MAN_SEQ)
							   , G.SHIP_COST_CODE
							   , CD1.APPLY_DATE
							   , NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = G.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0) AS NO_SHIP_ISLAND
							   , SUBSTR(CM.SHIP_COST_BASE_AMT, 0, 7)
							   , CD1.ORD_COST_AMT
							   , CD1.RET_COST_AMT AS RET_COST_AMT
							   , CD1.EXCH_COST_AMT AS EXCH_COST_AMT
							   , CD2.ORD_COST_AMT
							   , CD3.ORD_COST_AMT
							   , '999999'
							   , SYSDATE
							   , '999999'
							   , SYSDATE
							FROM TGOODS G
							   , TGOODSADDINFO AI
							   , TSHIPCOSTM  CM
							   , TSHIPCOSTDT CD1
							   , TSHIPCOSTDT CD2
							   , TSHIPCOSTDT CD3
						   WHERE G.GOODS_CODE = AI.GOODS_CODE
							 AND DECODE(G.DELY_TYPE, '10', '100001', G.ENTP_CODE) = CM.ENTP_CODE
							 AND G.SHIP_COST_CODE	= CM.SHIP_COST_CODE
							 AND CM.ENTP_CODE		= CD1.ENTP_CODE
							 AND CM.ENTP_CODE		= CD2.ENTP_CODE
							 AND CM.ENTP_CODE		= CD3.ENTP_CODE
							 AND CM.SHIP_COST_CODE	= CD1.SHIP_COST_CODE
							 AND CM.SHIP_COST_CODE	= CD2.SHIP_COST_CODE
							 AND CM.SHIP_COST_CODE	= CD3.SHIP_COST_CODE
							 AND CD1.CUST_AREA_GB	= '10'
							 AND CD2.CUST_AREA_GB	= '20'
							 AND CD3.CUST_AREA_GB	= '30'
							 AND CD1.APPLY_DATE		= CD2.APPLY_DATE
							 AND CD1.APPLY_DATE		= CD3.APPLY_DATE
							 AND CD1.APPLY_DATE		= ( SELECT MAX(CD.APPLY_DATE)
														  FROM TSHIPCOSTDT CD
														 WHERE CD.ENTP_CODE      = CM.ENTP_CODE
														   AND CD.SHIP_COST_CODE = CM.SHIP_COST_CODE
														   AND SYSDATE        &gt; APPLY_DATE )       
							 AND G.GOODS_CODE		= #{goodsCode, jdbcType=VARCHAR}
	</insert>
	
	<update id="updateTransCnCostYn" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateTransCnCostYn by PaCommonController */
        	   TPACUSTSHIPCOST PC
           SET PC.TRANS_CN_COST_YN = '1'
    	 WHERE PC.ENTP_CODE        = DECODE(#{delyType, jdbcType=VARCHAR}, '10', '100001', #{entpCode, jdbcType=VARCHAR})
       	   AND PC.SHIP_COST_CODE   = #{shipCostCode, 	jdbcType=VARCHAR}
       	   AND PC.PA_CODE          = #{paCode, 		 	jdbcType=VARCHAR}
    </update>
    
	<update id="updateTpaGoodsTarget" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateTpaGoodsTarget by PaCommonController */
        	   TPAGOODSTARGET GT
	       SET GT.PA_SALE_GB  = '10'
	         , GT.MODIFY_DATE = SYSDATE
	         , GT.MODIFY_ID   = '999999'
	     WHERE GT.GOODS_CODE  = #{goodsCode, jdbcType=VARCHAR}
	       AND GT.PA_CODE     = #{paCode, 	 jdbcType=VARCHAR}
	       AND GT.PA_SALE_GB IS NULL
	       AND GT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <insert id="inertPaGoodsQaLog" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.inertPaGoodsQaLog by PaCommonController */
			   TPAGOODSQALOG
              (
                 PA_GROUP_CODE
               , PA_CODE
               , GOODS_CODE
               , SEQ
               , NOTE
               , INSERT_DATE
              )
               VALUES
              (
                 #{paGroupCode, jdbcType=VARCHAR}
               , #{paCode, 		jdbcType=VARCHAR}
               , #{goodsCode, 	jdbcType=VARCHAR}
               ,(SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(QL.SEQ)) + 1), 5, '0'), '00001')
                   FROM TPAGOODSQALOG QL
                  WHERE QL.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
                    AND QL.PA_CODE       = #{paCode, 	  jdbcType=VARCHAR}
                    AND QL.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR})
               , #{rtnMsg, jdbcType=VARCHAR}
               , SYSDATE
               )
	</insert>
	
	<delete id="deletePaGoodsTarget" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		DELETE FROM /* pacommon.xml: pacommon.pacommon.deletePaGoodsTarget by PaCommonController */
			   TPAGOODSTARGET GT
         WHERE GT.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR}
           AND GT.PA_CODE       = #{paCode, 	 jdbcType=VARCHAR}
           AND GT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
	</delete>
	
	<select id="selectChkPaGoodsYn" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectChkPaGoodsYn by PaCommonController */
			   COUNT(1)
      	  FROM TPAGOODS PG
     	 WHERE PG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
	</select>
	
	<update id="updatePaGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoods by PaCommonController */
        	   TPAGOODS A
	       SET A.SALE_PA_CODE = A.SALE_PA_CODE || ',' || #{paCode, jdbcType=VARCHAR}
    	 WHERE A.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <insert id="insertPaGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoods by PaCommonController */
			   TPAGOODS( GOODS_CODE
                       , GOODS_NAME
                       , SALE_GB
                       , LMSD_CODE
                       , MAKECO_CODE
                       , BRAND_NAME
                       , ORIGIN_CODE
                       , ORIGIN_NAME
                       , TAX_YN
                       , TAX_SMALL_YN
                       , ADULT_YN
                       , ORDER_MIN_QTY
                       , ORDER_MAX_QTY
                       , CUST_ORD_QTY_CHECK_TERM
                       , DO_NOT_ISLAND_DELY_YN
                       , ENTP_CODE
                       , SHIP_MAN_SEQ
                       , RETURN_MAN_SEQ
                       , SHIP_COST_CODE
                       , SALE_PA_CODE
                       , AVG_DELY_LEADTIME
                       , LAST_SYNC_DATE
                       , LAST_DESCRIBE_SYNC_DATE
                       , INSERT_ID
                       , INSERT_DATE
                       , MODIFY_ID
                       , MODIFY_DATE
                       , SALE_START_DATE
                       , SALE_END_DATE
                       , KEYWORD
                       , COLLECT_YN
                       )
                 SELECT G.GOODS_CODE
                      , G.GOODS_NAME
                      , FUN_GET_PA_SALE_GB(G.SALE_GB, G.SALE_START_DATE, G.SALE_END_DATE) AS SALE_GB
                      , G.LMSD_CODE
                      , G.MAKECO_CODE
                      , B.BRAND_NAME
                      , G.ORIGIN_CODE
                      , C.CODE_NAME
                      , G.TAX_YN
                      , G.TAX_SMALL_YN
                      , G.ADULT_YN
                      , G.ORDER_MIN_QTY
                      , G.ORDER_MAX_QTY
                      , G.CUST_ORD_QTY_CHECK_TERM
                      , NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = G.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0) AS DO_NOT_ISLAND_DELY_YN
                      , G.ENTP_CODE
                      , G.SHIP_MAN_SEQ
                      , G.RETURN_MAN_SEQ
                      , G.SHIP_COST_CODE
                      , #{paCode, jdbcType=VARCHAR}
                      , G.AVG_DELY_LEADTIME
                      , SYSDATE
                      , SYSDATE
                      , '999999'
                      , SYSDATE
                      , '999999'
                      , SYSDATE
                      , G.SALE_START_DATE
                      , G.SALE_END_DATE
                      , G.KEYWORD
                      , G.COLLECT_YN
                   FROM TGOODS G
                      , TBRAND B
                      , TCODE  C
                  WHERE G.GOODS_CODE  = #{goodsCode, jdbcType=VARCHAR}
                    AND G.BRAND_CODE  = B.BRAND_CODE
                    AND C.CODE_LGROUP = 'B023'
                    AND G.ORIGIN_CODE = C.CODE_MGROUP
                    AND C.USE_YN      = '1'
	</insert>
	
	<select id="selectOfferInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.SpPaOfferInfo">
		SELECT /* pacommon.xml: pacommon.pacommon.selectOfferInfoList by PaCommonController */
		       'U' AS PROC_GB
	         , T.GOODS_CODE
	         , P.PA_GROUP_CODE
	         , T.OFFER_TYPE
	         , T.OFFER_CODE
	         , M.PA_OFFER_TYPE
	         , M.PA_OFFER_CODE
	         , TO_CLOB(T.OFFER_CONTENTS) AS OFFER_EXT
	      FROM TGOODS              GD
	         , TOFFER              T
	         , TPAGOODSOFFER       P
	         , TPAOFFERCODEMAPPING M
	     WHERE GD.GOODS_CODE   = T.GOODS_CODE
	       AND GD.OFFER_TYPE   = T.OFFER_TYPE
	       AND T.GOODS_CODE    = P.GOODS_CODE
	       AND T.OFFER_TYPE    = M.OFFER_TYPE
	       AND T.OFFER_CODE    = M.OFFER_CODE
	       AND P.PA_OFFER_TYPE = M.PA_OFFER_TYPE
	       AND P.PA_OFFER_CODE = M.PA_OFFER_CODE
	       AND P.PA_GROUP_CODE = M.PA_GROUP_CODE
	       AND T.MODIFY_DATE   > P.LAST_SYNC_DATE
	       AND P.USE_YN        = '1'
	       AND P.PA_GROUP_CODE NOT IN ('01','02','03','05','06','07','08','09','11')
	       AND T.MODIFY_DATE  >= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
	       AND GD.MODIFY_DATE >= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
		<if test='goodsCode != null and goodsCode != ""'>
		   AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		</if>
	
	    UNION ALL

	    SELECT 'I' AS PROC_GB
	         , GOODS_CODE
	    	 , PA_GROUP_CODE
	    	 , OFFER_TYPE
	    	 , ''  AS OFFER_CODE
	    	 , ''  AS PA_OFFER_TYPE
	    	 , ''  AS PA_OFFER_CODE
	    	 , TO_CLOB('') AS OFFER_EXT
	      FROM (  
			    SELECT GD.GOODS_CODE
			         , OM.PA_GROUP_CODE
			         , GD.OFFER_TYPE
			         , CASE WHEN OM.PA_GROUP_CODE = '04' THEN (SELECT 1 FROM TPANAVERGOODS PA WHERE PA.GOODS_CODE = PG.GOODS_CODE AND PA.PA_STATUS = '30')
			                WHEN OM.PA_GROUP_CODE = '10' THEN (SELECT 1 FROM TPASSGGOODS  PA WHERE PA.GOODS_CODE = PG.GOODS_CODE AND PA.PA_STATUS = '30')
			                ELSE 0 END AS PA_STATUS
			      FROM TGOODS   GD
			         , TPAGOODS PG
			         , ( SELECT PA_GROUP_CODE
			                  , OFFER_TYPE
			               FROM TPAOFFERCODEMAPPING
			           GROUP BY PA_GROUP_CODE, OFFER_TYPE ) OM
			     WHERE GD.GOODS_CODE  = PG.GOODS_CODE
			       AND GD.MODIFY_DATE > PG.LAST_SYNC_DATE
			       AND GD.OFFER_TYPE = OM.OFFER_TYPE
			       AND NOT EXISTS ( SELECT '1'
			                          FROM TPAGOODSOFFER       PAOF
			                             , TPAOFFERCODEMAPPING PAOFM
			                         WHERE PAOF.PA_GROUP_CODE = PAOFM.PA_GROUP_CODE
			                           AND PAOF.PA_OFFER_TYPE = PAOFM.PA_OFFER_TYPE
			                           AND PAOF.USE_YN        = '1'
			                           AND PAOF.GOODS_CODE    = GD.GOODS_CODE
			                           AND PAOFM.OFFER_TYPE   = GD.OFFER_TYPE
			                           AND PAOFM.PA_GROUP_CODE = OM.PA_GROUP_CODE
			                           AND PAOF.PA_OFFER_TYPE = CASE WHEN OM.PA_GROUP_CODE = '10' AND GD.OFFER_TYPE = '20'
                                                                     THEN (
	                                                                    CASE WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = GD.GOODS_CODE) = '1') THEN '0000000019'
	                                                                         WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = GD.GOODS_CODE) = '2') THEN '0000000021'
	                                                                         WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE =GD.GOODS_CODE) = '3') THEN '0000000020' END)
                                                                     ELSE PAOF.PA_OFFER_TYPE END
			                      )
			       AND GD.MODIFY_DATE >= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
				<if test='goodsCode != null and goodsCode != ""'>
				   AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
		       )
		   WHERE PA_STATUS = 1    
	  <!--  ORDER BY PA_GROUP_CODE, GOODS_CODE-->
	</select>
	
	<update id="updatePaOfferData" parameterType="com.cware.netshopping.domain.model.SpPaOfferInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaOfferData by PaCommonController */
        	   TPAGOODSOFFER PF
	       SET PF.PA_OFFER_EXT   = #{offerExt,   jdbcType=VARCHAR}
             , PF.LAST_SYNC_DATE = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PF.MODIFY_DATE    = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PF.MODIFY_ID      = '999999'
         WHERE PF.GOODS_CODE     = #{goodsCode,   jdbcType=VARCHAR}
           AND PF.PA_GROUP_CODE  = #{paGroupCode, jdbcType=VARCHAR}
           AND PF.PA_OFFER_TYPE  = #{paOfferType, jdbcType=VARCHAR}
           AND PF.PA_OFFER_CODE  = #{paOfferCode, jdbcType=VARCHAR}
    </update>
    
    <select id="selectOfferTypeCheck" parameterType="com.cware.netshopping.domain.model.SpPaOfferInfo" resultType="hashMap">
		SELECT /* pacommon.xml: pacommon.pacommon.selectOfferTypeCheck by PaCommonController */
		       DISTINCT S.PA_OFFER_TYPE
           	 , NVL( (SELECT '1'
                       FROM TPAGOODSOFFER PAOF
                      WHERE PAOF.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
                        AND PAOF.PA_GROUP_CODE = S.PA_GROUP_CODE
                        AND PAOF.PA_OFFER_TYPE = S.PA_OFFER_TYPE
                        AND ROWNUM = 1
                  ), '0') AS PRE_INPUT_YN
          FROM TPAOFFERCODEMAPPING S
         WHERE S.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND S.OFFER_TYPE    = #{offerType,   jdbcType=VARCHAR}
         <if test='paGroupCode != null and paGroupCode == "10" and  offerType != null and offerType == "20"'> 
           AND S.PA_OFFER_TYPE = CASE WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}) = '1') THEN '0000000019'
                                      WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}) = '2') THEN '0000000021'
                                      WHEN ((SELECT FOOD_TYPE FROM TGOODSSSGFOOD WHERE GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}) = '3') THEN '0000000020' END
         </if>
	</select>
	
	<update id="updatePaOfferUseYn" parameterType="com.cware.netshopping.domain.model.SpPaOfferInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaOfferUseYn by PaCommonController */
        	   TPAGOODSOFFER PAOF
	       SET PAOF.USE_YN = '0'
             , PAOF.TRANS_TARGET_YN = '0'
             , PAOF.MODIFY_ID       = '999999'
             , PAOF.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PAOF.GOODS_CODE      = #{goodsCode,   jdbcType=VARCHAR}
           AND PAOF.PA_GROUP_CODE   = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <insert id="insertPaofferData" parameterType="com.cware.netshopping.domain.model.SpPaOfferInfo">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaofferData by PaCommonController */
			   TPAGOODSOFFER
        SELECT OE.GOODS_CODE
             , PAOF.PA_GROUP_CODE
             , PAOF.PA_OFFER_TYPE
             , PAOF.PA_OFFER_CODE
             , TO_CLOB(OE.OFFER_CONTENTS) AS PA_OFFER_EXT
             , ''                         AS REMARK1
             , ''                         AS REMARK2
             , '1'                        AS USE_YN
             , '1'                        AS TRANS_TARGET_YN
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , '999999'
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , '999999'
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         FROM TPAOFFERCODE PAOF
            , TPAOFFERCODEMAPPING PAOFM
            , TOFFER OE
        WHERE PAOF.PA_GROUP_CODE = PAOFM.PA_GROUP_CODE
          AND PAOF.PA_OFFER_TYPE = PAOFM.PA_OFFER_TYPE
          AND PAOF.PA_OFFER_CODE = PAOFM.PA_OFFER_CODE
          AND PAOF.USE_YN        = '1'
          AND PAOFM.OFFER_TYPE   = OE.OFFER_TYPE
          AND PAOFM.OFFER_CODE   = OE.OFFER_CODE
          AND OE.GOODS_CODE      = #{goodsCode,   jdbcType=VARCHAR}
          AND PAOF.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
          AND PAOF.PA_OFFER_TYPE = #{paOfferType, jdbcType=VARCHAR}

        UNION ALL

        SELECT #{goodsCode, jdbcType=VARCHAR}
             , PAOF.PA_GROUP_CODE
             , PAOF.PA_OFFER_TYPE
             , PAOF.PA_OFFER_CODE
             , TO_CLOB('상품상세설명참조') AS PA_OFFER_EXT
             , ''                     AS REMARK1
             , ''                     AS REMARK2
             , '1'                    AS USE_YN
             , '1'                    AS TRANS_TARGET_YN
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , '999999'
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , '999999'
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
          FROM TPAOFFERCODE PAOF
         WHERE PAOF.USE_YN        = '1'
           AND PAOF.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND PAOF.PA_OFFER_TYPE = #{paOfferType, jdbcType=VARCHAR}
           AND NOT EXISTS ( SELECT '1'
                              FROM TPAOFFERCODEMAPPING PAOFM
                                 , TOFFER OE
                                 , TGOODS GD
                             WHERE PAOF.PA_GROUP_CODE = PAOFM.PA_GROUP_CODE
                               AND PAOF.PA_OFFER_TYPE = PAOFM.PA_OFFER_TYPE
                               AND PAOF.PA_OFFER_CODE = PAOFM.PA_OFFER_CODE
                               AND PAOFM.OFFER_TYPE   = OE.OFFER_TYPE
                               AND PAOFM.OFFER_CODE   = OE.OFFER_CODE
                               AND OE.GOODS_CODE      = GD.GOODS_CODE
                               AND OE.OFFER_TYPE      = GD.OFFER_TYPE
                               AND OE.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
                           )
	</insert>
	
	<update id="updatePaoffergoodsData" parameterType="com.cware.netshopping.domain.model.SpPaOfferInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaoffergoodsData by PaCommonController */
        	   TPAGOODSOFFER PAOF
	       SET PAOF.PA_OFFER_EXT  = NVL(( SELECT TO_CLOB(OE.OFFER_CONTENTS)
	                                        FROM TPAOFFERCODEMAPPING PAOFM
	                                           , TOFFER OE
	                                       WHERE PAOF.PA_GROUP_CODE = PAOFM.PA_GROUP_CODE
	                                         AND PAOF.PA_OFFER_TYPE = PAOFM.PA_OFFER_TYPE
	                                         AND PAOF.PA_OFFER_CODE = PAOFM.PA_OFFER_CODE
	                                         AND OE.GOODS_CODE      = PAOF.GOODS_CODE
	                                         AND PAOFM.OFFER_TYPE   = OE.OFFER_TYPE
	                                         AND PAOFM.OFFER_CODE   = OE.OFFER_CODE
	                                    ), TO_CLOB('상품상세설명참조'))
             , PAOF.USE_YN        = '1'
             , PAOF.MODIFY_ID     = '999999'
             , PAOF.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PAOF.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR}
           AND PAOF.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND PAOF.PA_OFFER_TYPE = #{paOfferType, jdbcType=VARCHAR}
           AND PAOF.USE_YN = '0'
    </update>
    
	<update id="updatePa11stGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePa11stGoodsSaleGb by PaCommonController */
        	   TPA11STGOODS PA11
	       SET PA11.PA_SALE_GB    = '30'
             , PA11.TRANS_SALE_YN = '1'
             , PA11.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PA11.MODIFY_ID     = '999999'
         WHERE PA11.GOODS_CODE    = #{goodsCode,  jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaGoodsTargetAutoYnOff" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoodsTargetAutoYnOff by PaCommonController */
        	   TPAGOODSTARGET GT
	       SET GT.AUTO_YN       = '0'
             , GT.MODIFY_ID     = 'BATCH'
             , GT.MODIFY_DATE   = SYSDATE
         WHERE GT.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR}
           AND GT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="insertPa11stAutoYnOffLog" parameterType="com.cware.netshopping.domain.model.SpPaOfferInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.insertPa11stAutoYnOffLog by PaCommonController */
        	   TPAGOODSTARGET GT
	       SET GT.AUTO_YN       = '0'
             , GT.MODIFY_ID     = 'BATCH'
             , GT.MODIFY_DATE   = SYSDATE
         WHERE GT.GOODS_CODE    = #{goodsCode,  jdbcType=VARCHAR}
           AND GT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <insert id="insertPaGoodsAutoYnOffLog" parameterType="hashMap">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsAutoYnOffLog by PaCommonController */
			   TPAGOODSAUTHYNLOG
               (
                PA_GROUP_CODE
              , PA_CODE
              , GOODS_CODE
              , SEQ_NO
              , AUTO_YN
              , INSERT_ID
              , INSERT_DATE
              , NOTE
                )
         VALUES (
         	    #{paGroupCode, jdbcType=VARCHAR}
         	  , #{paCode,      jdbcType=VARCHAR}
         	  , #{goodsCode,   jdbcType=VARCHAR}
         	  , ( SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(AL.SEQ_NO)) + 1), 3, '0'), '001')
	                FROM TPAGOODSAUTHYNLOG AL
	               WHERE AL.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
	                 AND AL.PA_CODE       = #{paCode,      jdbcType=VARCHAR}
	                 AND AL.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR} )
	          ,'0'
	          , '999999'
	          , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
	          , '정보고시'
         		)
	</insert>
	
	<update id="updatePaGmktGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGmktGoodsSaleGb by PaCommonController */
        	   TPAGMKTGOODS PAGK
           SET PAGK.PA_SALE_GB    = '30'
             , PAGK.TRANS_SALE_YN = '1'
             , PAGK.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PAGK.MODIFY_ID     = '999999'
         WHERE PAGK.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaNaverGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaNaverGoodsSaleGb by PaCommonController */
        	   TPANAVERGOODS PANA
           SET PANA.PA_SALE_GB    = '30'
             , PANA.TRANS_SALE_YN = '1'
             , PANA.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PANA.MODIFY_ID     = '999999'
         WHERE PANA.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaCopnGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaCopnGoodsSaleGb by PaCommonController */
        	   TPACOPNGOODS PACO
           SET PACO.PA_SALE_GB    = '30'
             , PACO.TRANS_SALE_YN = '1'
             , PACO.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PACO.MODIFY_ID     = '999999'
         WHERE PACO.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaWempGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaWempGoodsSaleGb by PaCommonController */
        	   TPAWEMPGOODS PAWE
           SET PAWE.PA_SALE_GB    = '30'
             , PAWE.DISPLAY_YN    = '0'
             , PAWE.TRANS_SALE_YN = '1'
             , PAWE.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PAWE.MODIFY_ID     = '999999'
         WHERE PAWE.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaIntpGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaIntpGoodsSaleGb by PaCommonController */
        	   TPAINTPGOODS PAWE
           SET PAWE.PA_SALE_GB    = '30'
             , PAWE.TRANS_SALE_YN = '1'
             , PAWE.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PAWE.MODIFY_ID     = '999999'
         WHERE PAWE.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <select id="selectGoodsInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
		SELECT /* pacommon.xml: pacommon.pacommon.selectGoodsInfoList by PaCommonController */
			   GD.GOODS_CODE
			 , (CASE WHEN (INSTR(PG.SALE_PA_CODE, '41') &gt; 0) 
			 		  THEN 1
                      ELSE 0
                     END ) AS PA_CODE_CHK
	         , PG.GOODS_NAME               AS OLD_GOODS_NAME
	         , GD.GOODS_NAME               AS NEW_GOODS_NAME
	         , PG.SALE_GB                  AS OLD_SALE_GB
	         , FUN_GET_PA_SALE_GB(GD.SALE_GB,GD.SALE_START_DATE,GD.SALE_END_DATE) AS NEW_SALE_GB
	         , PG.LMSD_CODE                AS OLD_LMSD_CODE
	         , GD.LMSD_CODE                AS NEW_LMSD_CODE
	         , PG.MAKECO_CODE              AS OLD_MAKECO_CODE
	         , GD.MAKECO_CODE              AS NEW_MAKECO_CODE
	         , GD.BRAND_CODE               AS NEW_BRAND_CODE
	         , PG.BRAND_NAME               AS OLD_BRAND_NAME
	         , TB.BRAND_NAME               AS NEW_BRAND_NAME
	         , PG.ORIGIN_CODE              AS OLD_ORIGIN_CODE
	         , GD.ORIGIN_CODE              AS NEW_ORIGIN_CODE
	         , PG.ORIGIN_NAME              AS OLD_ORIGIN_NAME
	         , TC.CODE_NAME                AS NEW_ORIGIN_NAME
	         , PG.TAX_YN                   AS OLD_TAX_YN
	         , GD.TAX_YN                   AS NEW_TAX_YN
	         , PG.TAX_SMALL_YN             AS OLD_TAX_SMALL_YN
	         , GD.TAX_SMALL_YN             AS NEW_TAX_SMALL_YN
	         , PG.ADULT_YN                 AS OLD_ADULT_YN
	         , GD.ADULT_YN                 AS NEW_ADULT_YN
	         , PG.ORDER_MIN_QTY            AS OLD_ORDER_MIN_QTY
	         , GD.ORDER_MIN_QTY            AS NEW_ORDER_MIN_QTY
	         , PG.ORDER_MAX_QTY            AS OLD_ORDER_MAX_QTY
	         , GD.ORDER_MAX_QTY            AS NEW_ORDER_MAX_QTY
	         , PG.CUST_ORD_QTY_CHECK_TERM  AS OLD_CUST_ORD_QTY_CHECK_TERM
	         , GD.CUST_ORD_QTY_CHECK_TERM  AS NEW_CUST_ORD_QTY_CHECK_TERM
	         , PG.ENTP_CODE                AS OLD_ENTP_CODE
	         , GD.ENTP_CODE                AS NEW_ENTP_CODE
	         , PG.SHIP_MAN_SEQ             AS OLD_SHIP_MAN_SEQ
	         , GD.SHIP_MAN_SEQ             AS NEW_SHIP_MAN_SEQ
	         , PG.RETURN_MAN_SEQ           AS OLD_RETURN_MAN_SEQ
	         , GD.RETURN_MAN_SEQ           AS NEW_RETURN_MAN_SEQ
	         , PG.SHIP_COST_CODE           AS OLD_SHIP_COST_CODE
	         , GD.SHIP_COST_CODE           AS NEW_SHIP_COST_CODE
	         , PG.AVG_DELY_LEADTIME        AS OLD_AVG_DELY_LEADTIME
	         , GD.AVG_DELY_LEADTIME        AS NEW_AVG_DELY_LEADTIME
	         , 'U'                         AS SYNC_MODE
	         , PG.SALE_START_DATE          AS OLD_SALE_START_DATE
	         , GD.SALE_START_DATE          AS NEW_SALE_START_DATE
	         , PG.SALE_END_DATE            AS OLD_SALE_END_DATE
	         , GD.SALE_END_DATE            AS NEW_SALE_END_DATE
	         , GD.GOODS_NAME_MC            AS NEW_GOODS_NAME_MC
	         , GI.ORDER_CREATE_YN          AS NEW_ORDER_CREATE_YN
	         , PG.ORDER_CREATE_YN          AS OLD_ORDER_CREATE_YN
	         , PG.KEYWORD                  AS OLD_KEYWORD
	         , GD.KEYWORD                  AS NEW_KEYWORD
	         , PG.COLLECT_YN               AS OLD_COLLECT_YN
	         , GD.COLLECT_YN               AS NEW_COLLECT_YN
	         , PG.DO_NOT_ISLAND_DELY_YN    AS OLD_DO_NOT_ISLAND_DELY_YN
	         , NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = GD.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0) AS NEW_DO_NOT_ISLAND_DELY_YN
	      FROM TGOODS   	 GD
	         , TGOODSADDINFO GI
	         , TPAGOODS 	 PG
	         , TCODE    	 TC
	         , TBRAND   	 TB
	     WHERE GD.GOODS_CODE  = GI.GOODS_CODE
	       AND GD.GOODS_CODE  = PG.GOODS_CODE
	       AND PG.SALE_PA_CODE IS NOT NULL
	       AND GD.MODIFY_DATE &gt; PG.LAST_SYNC_DATE
	       AND GD.ORIGIN_CODE = TC.CODE_MGROUP
	       AND TC.CODE_LGROUP = 'B023'
	       AND TC.USE_YN      = '1'
	       AND GD.BRAND_CODE  = TB.BRAND_CODE
	       AND GD.MODIFY_DATE &gt;= SYSDATE - 2
		<if test='goodsCode != null and goodsCode != ""'>
			AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		</if>
	</select>
	
	<update id="updatePaGoodsData" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoodsData by PaCommonController */
        	   TPAGOODS PG
           SET PG.GOODS_NAME              = #{newGoodsName, 		  jdbcType=VARCHAR}
             , PG.MAKECO_CODE             = #{newMakecoCode, 		  jdbcType=VARCHAR}
             , PG.BRAND_NAME              = #{newBrandName, 		  jdbcType=VARCHAR}
             , PG.ORIGIN_CODE             = #{newOriginCode, 		  jdbcType=VARCHAR}
             , PG.ORIGIN_NAME             = #{newOriginName, 		  jdbcType=VARCHAR}
             , PG.TAX_YN                  = #{newTaxYn, 			  jdbcType=VARCHAR}
             , PG.TAX_SMALL_YN            = #{newTaxSmallYn, 		  jdbcType=VARCHAR}
             , PG.ADULT_YN                = #{newAdultYn, 			  jdbcType=VARCHAR}
             , PG.ORDER_MIN_QTY           = #{newOrderMinQty, 		  jdbcType=NUMERIC}
             , PG.ORDER_MAX_QTY           = #{newOrderMaxQty, 		  jdbcType=NUMERIC}
             , PG.CUST_ORD_QTY_CHECK_TERM = #{newCustOrdQtyCheckTerm, jdbcType=VARCHAR}
             , PG.ENTP_CODE               = #{newEntpCode, 			  jdbcType=VARCHAR}
             , PG.SHIP_MAN_SEQ            = #{newShipManSeq, 		  jdbcType=VARCHAR}
             , PG.RETURN_MAN_SEQ          = #{newReturnManSeq, 		  jdbcType=VARCHAR}
             , PG.SHIP_COST_CODE          = #{newShipCostCode, 		  jdbcType=VARCHAR}
             , PG.AVG_DELY_LEADTIME       = #{newAvgDelyLeadtime, 	  jdbcType=VARCHAR}
             , PG.SALE_START_DATE         = #{newSaleStartDate, 	  jdbcType=TIMESTAMP}
             , PG.SALE_END_DATE           = #{newSaleEndDate, 		  jdbcType=TIMESTAMP}
             , PG.ORDER_CREATE_YN         = #{newOrderCreateYn, 	  jdbcType=VARCHAR}
             , PG.KEYWORD                 = #{newKeyword, 			  jdbcType=VARCHAR}
             , PG.COLLECT_YN              = #{newCollectYn, 		  jdbcType=VARCHAR}
             , PG.DO_NOT_ISLAND_DELY_YN   = #{newDoNotIslandDelyYn, 		  jdbcType=VARCHAR}
             , PG.LAST_SYNC_DATE          = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PG.MODIFY_DATE             = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PG.MODIFY_ID               = '999999'
         WHERE PG.GOODS_CODE              = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePa11stGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePa11stGoodsSync by PaCommonController */
        	   TPA11STGOODS P1
           SET P1.TRANS_TARGET_YN  = '1'
             , P1.MODIFY_DATE      = SYSDATE
             , P1.ORGN_TYP_DTLS_CD = CASE
                                       WHEN #{newOriginCode, jdbcType=VARCHAR} = #{oldOriginCode, jdbcType=VARCHAR}
                                       THEN P1.ORGN_TYP_DTLS_CD
                                     ELSE
                                       ( SELECT M.ORGN_TYP_DTLS_CD
                                           FROM TPAGOODS PG
                                              , TPA11STORIGINMAPPING M
                                          WHERE PG.ORIGIN_CODE = M.ORIGIN_CODE(+)
                                            AND PG.GOODS_CODE  = #{goodsCode, jdbcType=VARCHAR} )
                                     END
             , P1.ORGN_TYP_CD = DECODE(#{newOriginCode, jdbcType=VARCHAR}, '0082', '01','02')
             , P1.BRAND_NO    = ( SELECT TPB.BRAND_NO
                                    FROM TPA11STBRAND TPB
                                   WHERE TPB.BRAND_CODE = #{newBrandCode, jdbcType=VARCHAR}
                                 )
         WHERE P1.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
           AND P1.GOODS_CODE NOT IN ( 
                                      '21049461', '21037946' /* 2019.11.19 런닝맨 상품 입점 */
                                     )
    </update>
    
	<update id="updatePaGmktGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGmktGoodsSync by PaCommonController */
        	   TPAGMKTGOODS GG
           SET GG.TRANS_TARGET_YN = '1'
             , GG.MODIFY_DATE     = SYSDATE
             , GG.ORIGIN_ENUM     = DECODE(#{newOriginCode, jdbcType=VARCHAR},'0082', '20', '30')
             , GG.BRAND_NO        = NVL(( SELECT GB.BRAND_NO
                                            FROM TPAGMKTBRAND GB
                                           WHERE GB.BRAND_CODE = #{newBrandCode, jdbcType=VARCHAR}
                                             AND ROWNUM 	   = 1
                                    ), BRAND_NO)
             , GG.MAKER_NO  = (SELECT GM.MAKER_NO FROM TPAGMKTMAKER GM WHERE GM.MAKER_CODE = #{newMakecoCode, jdbcType=VARCHAR})
             , GG.ORIGIN_DT = CASE
                                WHEN #{newOriginCode, jdbcType=VARCHAR} = '0082' 
                                THEN NULL
                                ELSE
	                                 (SELECT GOM.ORGN_TYP_DTLS_CD
	                                    FROM TPAGMKTORIGINMAPPING GOM
	                                   WHERE GOM.ORIGIN_CODE = #{newOriginCode, jdbcType=VARCHAR})
                              END
         WHERE GG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaNaverGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaNaverGoodsSync by PaCommonController */
        	   TPANAVERGOODS PN
           SET PN.TRANS_TARGET_YN   = '1'
             , PN.MODIFY_DATE 	    = SYSDATE
             , PN.NAVER_ORIGIN_CODE = CASE
                                        WHEN #{newOriginCode, jdbcType=VARCHAR} = #{oldOriginCode, jdbcType=VARCHAR} 
                                        THEN
                                             PN.NAVER_ORIGIN_CODE
                                        ELSE
                                            ( SELECT M.NAVER_ORIGIN_CODE
                                                FROM TPAGOODS PG
                                                   , TPANAVERORIGINMAPPING M
                                               WHERE PG.ORIGIN_CODE = M.ORIGIN_CODE(+)
                                                 AND PG.GOODS_CODE  = #{goodsCode, jdbcType=VARCHAR}
                                             )
                                      END
         WHERE PN.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaCopnGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaCopnGoodsSync by PaCommonController */
        	   TPACOPNGOODS P1
           SET P1.TRANS_TARGET_YN   = '1'
             , P1.MODIFY_DATE 		= SYSDATE
             , DISPLAY_PRODUCT_NAME = #{newGoodsName,   jdbcType=VARCHAR}
             , GENERAL_PRODUCT_NAME = #{newGoodsNameMc, jdbcType=VARCHAR}
         WHERE P1.GOODS_CODE 		= #{goodsCode, 		jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaWempGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaWempGoodsSync by PaCommonController */
        	   TPAWEMPGOODS P1
           SET P1.TRANS_TARGET_YN = '1'
             , P1.MODIFY_DATE 	  = SYSDATE
             , P1.BRAND_NO 	  	  = ( SELECT TPB.BRAND_NO FROM TPAWEMPBRAND TPB WHERE TPB.BRAND_CODE = #{newBrandCode,  jdbcType=VARCHAR})
         WHERE P1.GOODS_CODE  	  = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaIntpGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaIntpGoodsSync by PaCommonController */
        	   TPAINTPGOODS P1
           SET P1.TRANS_TARGET_YN = '1'
             , P1.MODIFY_DATE 	  = SYSDATE
             , P1.BRAND_NO    	  = ( SELECT BM.PA_BRAND_NO FROM TPABRANDMAPPING BM WHERE BM.BRAND_CODE = #{newBrandCode, jdbcType=VARCHAR} AND BM.PA_GROUP_CODE = P1.PA_GROUP_CODE)
         WHERE P1.GOODS_CODE  	  = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updatePaGoodsDtMappingTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoodsDtMappingTrans by PaCommonController */
        	   TPAGOODSDTMAPPING P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.PA_CODE         = #{paCode, jdbcType=VARCHAR}
           AND P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
           AND P.TRANS_TARGET_YN = '0'
    </update>
    
	<update id="updateNaverMappingTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateNaverMappingTrans by PaCommonController */
        	   TPAGOODSDTMAPPING P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.PA_CODE         = '41'
           AND P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
           AND P.TRANS_TARGET_YN = '0'
    </update>
    
    <insert id="insertPaEntpSlipChange" parameterType="hashMap">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaEntpSlipChange by PaCommonController */
			   TPAENTPSLIPCHANGE
        SELECT #{entpCode,   jdbcType=VARCHAR} AS ENTP_CODE
             , #{entpManSeq, jdbcType=VARCHAR} AS ENTP_MAN_SEQ
             , '41' 							  AS PA_CODE
             , '00001' 							  AS CHANGE_SEQ
             , '00' 							  AS CHANGE_FLAG
             , '00' 							  AS PROC_FLAG
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , '999999' AS INSERT_DATE
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , '999999' AS INSERT_DATE
          FROM DUAL PE
         WHERE NOT EXISTS ( SELECT '1'
                              FROM TPAENTPSLIP PS
                             WHERE PS.ENTP_CODE    = #{entpCode,   jdbcType=VARCHAR}
                               AND PS.ENTP_MAN_SEQ = #{entpManSeq, jdbcType=VARCHAR}
                               AND PS.PA_CODE      = '41'
                           )
           AND NOT EXISTS ( SELECT '1'
                             FROM TPAENTPSLIPCHANGE PEC
                            WHERE PEC.ENTP_CODE    = #{entpCode,   jdbcType=VARCHAR}
                              AND PEC.ENTP_MAN_SEQ = #{entpManSeq, jdbcType=VARCHAR}
                          )
	</insert>
	
	<insert id="insertPaCustCnShipCost" parameterType="hashMap">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaCustCnShipCost by PaCommonController */
			   TPACUSTCNSHIPCOST PCC ( PCC.CN_COST_SEQ
									 , PCC.ENTP_CODE
									 , PCC.ENTP_MAN_SEQ
									 , PCC.SHIP_COST_CODE
									 , PCC.SHIP_COST_BASE_AMT
									 , PCC.ORD_COST_AMT
									 , PCC.TRANS_TARGET_YN
									 , PCC.TRANS_END_DATE
									 , PCC.APPLY_CN_COST_SEQ
									 , PCC.INSERT_ID
									 , PCC.INSERT_DATE
									 , PCC.MODIFY_ID
									 , PCC.MODIFY_DATE
									 , PCC.PA_CODE ) 
							 SELECT TO_CHAR(SYSDATE, 'YYYYMMDD')|| LTRIM(TO_CHAR(SEQ_CN_COST_SEQ.NEXTVAL,'000')) 
								  , #{entpCode, jdbcType=VARCHAR}
								  , #{entpManSeq, jdbcType=VARCHAR}
								  , #{shipCostCode, jdbcType=VARCHAR}
								  , #{shipCostBaseAmt, jdbcType=NUMERIC}
								  , #{ordCostAmt, jdbcType=NUMERIC}
								  , '1'
								  , NULL
								  , NULL
								  , #{userId, jdbcType=VARCHAR}
								  , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
								  , #{userId, jdbcType=VARCHAR}
								  , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
								  , #{paCode, jdbcType=VARCHAR}
							   FROM DUAL
	</insert>
	
	<update id="updateCnTransYn" parameterType="hashMap">
		UPDATE /* pacommon.xml: pacommon.pacommon.updateCnTransYn by PaCommonController */
			   TPACUSTCNSHIPCOST PCS
		   SET PCS.TRANS_TARGET_YN  = '1'
		 WHERE PCS.ENTP_CODE        = #{entpCode, jdbcType=VARCHAR}
		   AND PCS.ENTP_MAN_SEQ     = #{entpManSeq, jdbcType=VARCHAR}
		   AND PCS.PA_CODE          = #{paCode, jdbcType=VARCHAR}
		   AND PCS.SHIP_COST_CODE   LIKE 'CN%'
	</update>
	
	<update id="updateCnCostYn" parameterType="hashMap">
		UPDATE /* pacommon.xml: pacommon.pacommon.updateCnCostYn by PaCommonController */
			   TPACUSTSHIPCOST PCS
		   SET PCS.TRANS_CN_COST_YN = '0'
		 WHERE PCS.ENTP_CODE        = #{entpCode, jdbcType=VARCHAR}
		   AND PCS.PA_CODE          = #{paCode, jdbcType=VARCHAR}
		   AND PCS.SHIP_COST_CODE   LIKE 'CN%'
	</update>
	
	<update id="updateCnCostTrans" parameterType="hashMap">
		UPDATE /* pacommon.xml: pacommon.pacommon.updateCnCostTrans by PaCommonController */
			   TPACUSTCNSHIPCOST PCS
		   SET PCS.TRANS_CN_COST_YN  = '1'
			 , PCS.TRANS_TARGET_YN   = '0'
			 , PCS.APPLY_CN_COST_SEQ = #{applyCnCostSeq, jdbcType=VARCHAR}
			 , PCS.MODIFY_ID         = 'PA11'
			 , PCS.MODIFY_DATE       = SYSDATE
		 WHERE PCS.ENTP_CODE         = #{entpCode, jdbcType=VARCHAR}
		   AND PCS.ENTP_MAN_SEQ      = #{entpManSeq, jdbcType=VARCHAR}
		   AND PCS.PA_CODE           = #{paCode, jdbcType=VARCHAR}
		   AND PCS.TRANS_TARGET_YN   = '1'
	</update>
	
	<update id="updateCnt2CnCost" parameterType="hashMap">
		UPDATE /* pacommon.xml: pacommon.pacommon.updateCnt2CnCost by PaCommonController */
			   TPACUSTCNSHIPCOST A
		   SET A.TRANS_CN_COST_YN = '1'
			 , A.MODIFY_ID        = 'PA11'
			 , A.MODIFY_DATE      = SYSDATE
		 WHERE A.CN_COST_SEQ      = #{cnCostSeq, jdbcType=VARCHAR}
		   AND A.TRANS_TARGET_YN  = '1'
	</update>
	
	<update id="updateCnt2Target" parameterType="hashMap">
		UPDATE /* pacommon.xml: pacommon.pacommon.updateCnt2Target by PaCommonController */
			   TPACUSTCNSHIPCOST A
		   SET A.TRANS_TARGET_YN   = '0'
			 , A.APPLY_CN_COST_SEQ = #{cnCostSeq, jdbcType=VARCHAR}
			 , A.MODIFY_ID         = 'PA11'
			 , A.MODIFY_DATE       = SYSDATE
		 WHERE A.ENTP_CODE         = #{entpCode, jdbcType=VARCHAR}
		   AND A.ENTP_MAN_SEQ      = #{entpManSeq, jdbcType=VARCHAR}
		   AND A.PA_CODE           = #{paCode, jdbcType=VARCHAR}
		   AND A.TRANS_TARGET_YN   = '1'
	</update>
	
	<insert id="insertPaEntpSlipChange2" parameterType="hashMap">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaEntpSlipChange2 by PaCommonController */
			   TPAENTPSLIPCHANGE
        SELECT #{entpCode,   jdbcType=VARCHAR}
             , #{entpManSeq, jdbcType=VARCHAR}
             , #{paCode, jdbcType=VARCHAR}
             , #{changeSeq, jdbcType=VARCHAR}
             , #{changeFlag, jdbcType=VARCHAR}
             , #{procFlag, jdbcType=VARCHAR}
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , #{userId, jdbcType=VARCHAR}
             , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , #{userId, jdbcType=VARCHAR}
          FROM DUAL PE
	</insert>
	
	<update id="updatePaGoodsSyncDate" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoodsSyncDate by PaCommonController */
        	   TPAGOODS PG
           SET PG.LAST_SYNC_DATE = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PG.MODIFY_DATE    = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PG.MODIFY_ID      = '999999'
         WHERE PG.GOODS_CODE     = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <select id="selectGoodsDtInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
    	SELECT /* pacommon.xml: pacommon.pacommon.selectGoodsDtInfoList by PaCommonController */
				*
    	  FROM 
    	  	   (
				SELECT 'U' AS PROC_GB
			         , GD.GOODS_CODE
			         , GD.GOODSDT_CODE
			         , GD.GOODSDT_INFO
			         , NVL(DECODE(GD.COLOR_CODE, '000', '', '색상/') || DECODE(GD.SIZE_CODE, '000', '', '사이즈/') ||
			           DECODE(GD.PATTERN_CODE, '000', '', '무늬/') || DECODE(GD.FORM_CODE, '000', '', '형태/') || DECODE(GD.OTHER_TEXT, '', '', '기타'), GD.GOODSDT_INFO) AS GOODSDT_INFO_KIND
			         , '00' SORT_TYPE
			         , GD.SALE_GB
			      FROM TGOODSDT   GD
			         , TPAGOODSDT PD
			     WHERE PD.GOODS_CODE   = GD.GOODS_CODE
			       AND PD.GOODSDT_CODE = GD.GOODSDT_CODE
			       AND PD.MODIFY_DATE  &lt; GD.MODIFY_DATE
			       AND (PD.GOODSDT_INFO != GD.GOODSDT_INFO OR PD.SALE_GB != GD.SALE_GB)
			       AND GD.MODIFY_DATE  &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
		
		   	 UNION ALL
		
			    SELECT 'I' AS PROC_GB
			         , GD.GOODS_CODE
			         , GD.GOODSDT_CODE
			         , GD.GOODSDT_INFO
			         , NVL(DECODE(GD.COLOR_CODE, '000', '', '색상/') || DECODE(GD.SIZE_CODE, '000', '', '사이즈/') ||
			           DECODE(GD.PATTERN_CODE, '000', '', '무늬/') || DECODE(GD.FORM_CODE, '000', '', '형태/') || DECODE(GD.OTHER_TEXT, '', '', '기타'), GD.GOODSDT_INFO) AS GOODSDT_INFO_KIND
			         , '00' AS SORT_TYPE
			         , GD.SALE_GB
			      FROM TGOODSDT GD
			     WHERE GD.MODIFY_DATE &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
			       AND GD.SALE_GB     != '19'
			       AND EXISTS ( SELECT 'X'
			                      FROM TPAGOODSDT PD
			                     WHERE PD.GOODS_CODE = GD.GOODS_CODE
			                   )
			       AND NOT EXISTS ( SELECT 'X'
			                          FROM TPAGOODSDT PD
			                         WHERE PD.GOODS_CODE = GD.GOODS_CODE
			                           AND PD.GOODSDT_CODE = GD.GOODSDT_CODE
			                      )
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
		       
		     UNION ALL
		
			    SELECT 'M' AS PROC_GB
			         , GD.GOODS_CODE
			         , GD.GOODSDT_CODE
			         , GD.GOODSDT_INFO
			         , NVL(DECODE(GD.COLOR_CODE, '000', '', '색상/') || DECODE(GD.SIZE_CODE, '000', '', '사이즈/') ||
			           DECODE(GD.PATTERN_CODE, '000', '', '무늬/') || DECODE(GD.FORM_CODE, '000', '', '형태/') || DECODE(GD.OTHER_TEXT, '', '', '기타'), GD.GOODSDT_INFO) AS GOODSDT_INFO_KIND
			         , '00' AS SORT_TYPE
			         , GD.SALE_GB
			      FROM TGOODSDT GD
			     WHERE GD.MODIFY_DATE &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
			       AND GD.SALE_GB     != '19'
			       AND EXISTS ( SELECT 'X'
			                      FROM TPAGOODSDT PD
			                     WHERE PD.GOODS_CODE = GD.GOODS_CODE
			                   )
			       AND ( ( EXISTS (SELECT 1 FROM TPANAVERGOODS PG WHERE PG.GOODS_CODE = GD.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
			                AND NOT EXISTS (SELECT 1 FROM TPAGOODSDTMAPPING MP WHERE MP.PA_CODE IN ('41', '42') AND MP.GOODS_CODE = GD.GOODS_CODE AND MP.GOODSDT_CODE = GD.GOODSDT_CODE)
			             )
	                  OR
		                 ( EXISTS (SELECT 1 FROM TPASSGGOODS PG WHERE PG.GOODS_CODE = GD.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		                    AND NOT EXISTS (SELECT 1 FROM TPASSGGOODSDTMAPPING MP WHERE MP.PA_CODE IN ('A1', 'A2') AND MP.GOODS_CODE = GD.GOODS_CODE AND MP.GOODSDT_CODE = GD.GOODSDT_CODE)
		                 )
			           )
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
	       		 ) AA
		 ORDER BY AA.GOODS_CODE
	</select>
	
	<update id="updatePaGoodsDtData" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoodsDtData by PaCommonController */
        	   TPAGOODSDT PD
           SET PD.GOODSDT_INFO      = #{goodsdtInfo,      jdbcType=VARCHAR}
             , PD.GOODSDT_INFO_KIND = #{goodsdtInfoKind,  jdbcType=VARCHAR}
             , PD.SALE_GB           = #{saleGb, 		  jdbcType=VARCHAR}
             , PD.MODIFY_ID         = '999999'
             , PD.MODIFY_DATE       = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PD.GOODS_CODE        = #{goodsCode, 		  jdbcType=VARCHAR}
           AND PD.GOODSDT_CODE      = #{goodsdtCode, 	  jdbcType=VARCHAR}
    </update>
    
     <insert id="insertGoodsDtMappingData" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertGoodsDtMappingData by PaCommonController */
			   TPAGOODSDTMAPPING MM ( GOODS_CODE
                                    , GOODSDT_CODE
                                    , PA_CODE
                                    , PA_OPTION_CODE
                                    , TRANS_ORDER_ABLE_QTY
                                    , TRANS_TARGET_YN
                                    , LAST_SYNC_DATE
                                    , INSERT_ID
                                    , INSERT_DATE
                                    , MODIFY_ID
                                    , MODIFY_DATE
                                    , COMBINATION_YN )
	          SELECT PD.GOODS_CODE
	               , PD.GOODSDT_CODE
	               , PGN.PA_CODE
	               , PD.GOODS_CODE||GOODSDT_CODE
	               , '0'
	               , '1'
	               , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
	               , '999999'
	               , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
	               , '999999'
	               , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
	               , ''
	            FROM TPAGOODSDT    PD
	               , TPANAVERGOODS PGN
	           WHERE PD.GOODS_CODE   = PGN.GOODS_CODE
	             AND PD.GOODS_CODE   = #{goodsCode,   jdbcType=VARCHAR}
	             AND PD.GOODSDT_CODE = #{goodsdtCode, jdbcType=VARCHAR}
	             AND NOT EXISTS (SELECT 1 FROM TPAGOODSDTMAPPING MP WHERE MP.PA_CODE = PGN.PA_CODE AND MP.GOODS_CODE = PD.GOODS_CODE AND MP.GOODSDT_CODE = PD.GOODSDT_CODE)
	             
	</insert>
	
    <insert id="insertPaGoodsDtData" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaGoodsDtData by PaCommonController */
			   TPAGOODSDT PD
                   (
                      GOODS_CODE
                    , GOODSDT_CODE
                    , GOODSDT_INFO
                    , GOODSDT_INFO_KIND
                    , SORT_TYPE
                    , INSERT_ID
                    , INSERT_DATE
                    , MODIFY_ID
                    , MODIFY_DATE
                    , SALE_GB
                   )
            VALUES
                   (  #{goodsCode,   	  jdbcType=VARCHAR}
                    , #{goodsdtCode, 	  jdbcType=VARCHAR}
                    , #{goodsdtInfo, 	  jdbcType=VARCHAR}
                    , #{goodsdtInfoKind,  jdbcType=VARCHAR}
                    , #{sortType, 		  jdbcType=VARCHAR}
                    , '999999'
                    , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
                    , '999999'
                    , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
                    , #{saleGb, 		  jdbcType=VARCHAR} 
                   )
	</insert>
	 	
	<update id="updatePaGoodsDtMappingData" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoodsDtMappingData by PaCommonController */
        	   TPAGOODSDTMAPPING P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999' 
             , p.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
           AND P.PA_CODE NOT IN ('11','12','21','22','51','52','61','62','71','72','81','82','91','92')
           AND P.TRANS_TARGET_YN = '0'
    </update>
    
	<update id="update11stTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.update11stTrans by PaCommonController */
        	   TPA11STGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             <if test='massTargetYn != null and  massTargetYn == "1"'>
             , P.MASS_TARGET_YN		= #{massTargetYn	, jdbcType=VARCHAR}
             , P.MASS_TARGET_CODE	= #{massTargetCode	, jdbcType=VARCHAR}
             </if>
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
           AND P.GOODS_CODE NOT IN (
                                     '21049461', '21037946' /* 19/11/19 런닝맨 상품 입점 */
                                   )
    </update>
    
	<update id="updateGmktTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateGmktTrans by PaCommonController */
        	   TPAGMKTGOODS P
           SET P.TRANS_TARGET_YN = '1'
			<if test='transDiscountYn != null and transDiscountYn != ""'>
				, P.TRANS_DISCOUNT_YN = #{transDiscountYn, jdbcType=VARCHAR}
			</if>           
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
            <if test='massTargetYn != null and  massTargetYn == "1"'>
             , P.MASS_TARGET_YN		= #{massTargetYn	, jdbcType=VARCHAR}
             , P.MASS_TARGET_CODE	= #{massTargetCode	, jdbcType=VARCHAR}
            </if>
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
         	<if test='paGroupCode != null and paGroupCode != "" and paGroupCode != "02,03"'>
           		AND P.PA_GROUP_CODE	 = #{paGroupCode, jdbcType=VARCHAR}
         	</if>
    </update>
    
	<update id="updateNaverTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateNaverTrans by PaCommonController */
        	   TPANAVERGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
			<if test='goodsNameMc != null and goodsNameMc != ""'>
				, P.PA_GOODS_NAME =  #{goodsNameMc, jdbcType=VARCHAR}
			</if>
            <if test='massTargetYn != null and  massTargetYn == "1"'>
             , P.MASS_TARGET_YN		= #{massTargetYn	, jdbcType=VARCHAR}
             , P.MASS_TARGET_CODE	= #{massTargetCode	, jdbcType=VARCHAR}
            </if>			
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateCopnTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateCopnTrans by PaCommonController */
        	   TPACOPNGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
            <if test='massTargetYn != null and  massTargetYn == "1"'>
             , P.MASS_TARGET_YN		= #{massTargetYn	, jdbcType=VARCHAR}
             , P.MASS_TARGET_CODE	= #{massTargetCode	, jdbcType=VARCHAR}
            </if>             
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateWempTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateWempTrans by PaCommonController */
        	   TPAWEMPGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
            <if test='massTargetYn != null and  massTargetYn == "1"'>
             , P.MASS_TARGET_YN		= #{massTargetYn	, jdbcType=VARCHAR}
             , P.MASS_TARGET_CODE	= #{massTargetCode	, jdbcType=VARCHAR}
            </if>             
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateIntpTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateIntpTrans by PaCommonController */
        	   TPAINTPGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
            <if test='massTargetYn != null and  massTargetYn == "1"'>
             , P.MASS_TARGET_YN		= #{massTargetYn	, jdbcType=VARCHAR}
             , P.MASS_TARGET_CODE	= #{massTargetCode	, jdbcType=VARCHAR}
            </if>             
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
    </update>
	
	<select id="selectPaGoodsDescInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.SpPaGoodsDescInfo">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaGoodsDescInfoList by PaCommonController */
			   X.GOODS_CODE
	         , MAX(X.MODIFY_DATE) AS MODIFY_DATE
	      FROM (
	              SELECT DR.GOODS_CODE
	                   , DR.MODIFY_DATE
	                FROM TDESCRIBE DR
	                   , TPAGOODS PG
	               WHERE DR.GOODS_CODE    = PG.GOODS_CODE
	                 AND DR.DESCRIBE_CODE = '998'
	                 AND DR.DESCRIBE_EXT IS NOT NULL
	                 AND DR.MODIFY_DATE   &gt; PG.LAST_DESCRIBE_SYNC_DATE
	                 AND EXISTS ( SELECT '1'
	                                FROM TGOODS GD
	                               WHERE GD.GOODS_CODE = PG.GOODS_CODE
	                                 AND GD.SALE_GB &lt;&gt; '19'
	                             )
	                 AND DR.MODIFY_DATE &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
					<if test='goodsCode != null and goodsCode != ""'>
						AND PG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
					</if>
	
	             UNION ALL
	
	              SELECT DR.GOODS_CODE
	                   , DR.MODIFY_DATE
	                FROM TDESCRIBE DR
	                   , TPAGOODS PG
	               WHERE DR.GOODS_CODE    = PG.GOODS_CODE
	                 AND DR.DESCRIBE_CODE = '999'
	                 AND DR.DESCRIBE_EXT IS NOT NULL
	                 AND DR.MODIFY_DATE   &gt; PG.LAST_DESCRIBE_SYNC_DATE
	                 AND EXISTS ( SELECT '1'
	                                FROM TGOODS GD
	                               WHERE GD.GOODS_CODE = PG.GOODS_CODE
	                                 AND GD.SALE_GB &lt;&gt; '19'
	                             )
	                 AND DR.MODIFY_DATE &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
					<if test='goodsCode != null and goodsCode != ""'>
						AND PG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
					</if>
					
				  UNION ALL
	
	              SELECT DR.GOODS_CODE
	                   , DR.MODIFY_DATE
	                FROM TDESCRIBE DR
	                   , TPAGOODS PG
	               WHERE DR.GOODS_CODE    = PG.GOODS_CODE
	                 AND DR.DESCRIBE_CODE = '200'
	                 AND DR.DESCRIBE_NOTE IS NOT NULL
	                 AND DR.MODIFY_DATE   &gt; PG.LAST_DESCRIBE_SYNC_DATE
	                 AND EXISTS ( SELECT '1'
	                                FROM TGOODS GD
	                               WHERE GD.GOODS_CODE = PG.GOODS_CODE
	                                 AND GD.SALE_GB &lt;&gt; '19'
	                             )
	                 AND DR.MODIFY_DATE &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
					<if test='goodsCode != null and goodsCode != ""'>
						AND PG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
					</if>
	           ) X
	     GROUP BY X.GOODS_CODE
	</select>
	
	<update id="updatePaGoodsDescribe" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDescInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaGoodsDescribe by PaCommonController */
        	   TPAGOODS PG
           SET PG.LAST_DESCRIBE_SYNC_DATE = #{lastDescribeSyncDate, jdbcType=VARCHAR}
             , PG.MODIFY_DATE             = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PG.MODIFY_ID               = '999999'
         WHERE PG.GOODS_CODE              = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <select id="selectSaleEndDateTargetList" resultType="hashMap">
	
	    SELECT /* pacommon.xml: pacommon.pacommon.selectSaleEndDateTargetList by PaCommonController */
	    	   DISTINCT PNG.GOODS_CODE
	         , PNG.PA_GROUP_CODE
	      FROM TPANAVERGOODS PNG
	         , TGOODS        G2
	     WHERE PNG.GOODS_CODE = G2.GOODS_CODE
	       AND PNG.PA_STATUS  = '30'
	       AND PNG.PA_SALE_GB = '20'
	       AND (G2.SALE_END_DATE &lt; SYSDATE OR G2.SALE_START_DATE &gt; SYSDATE OR G2.BROAD_SALE_YN = '1')

	     UNION ALL
	
	    SELECT DISTINCT SSG.GOODS_CODE
	         , SSG.PA_GROUP_CODE
	      FROM TPASSGGOODS  SSG
	         , TGOODS        G2
	     WHERE SSG.GOODS_CODE = G2.GOODS_CODE
	       AND SSG.PA_STATUS  = '30'
	       AND SSG.PA_SALE_GB = '20'
	       AND (G2.SALE_END_DATE &lt; SYSDATE OR G2.SALE_START_DATE &gt; SYSDATE OR G2.BROAD_SALE_YN = '1')  
    </select>
    
    <select id="selectGoodsAuthTransList" resultType="com.cware.netshopping.domain.model.SpAuthTransInfo">
		SELECT /* pacommon.xml: pacommon.pacommon.selectGoodsAuthTransList by PaCommonController */
			   PGT.GOODS_CODE
		     , PGT.PA_CODE
		     , PGT.PA_GROUP_CODE
		  FROM TPAGOODSTARGET PGT
		     , TGOODS   GD
		     , TPAGOODS P
		     , TCODE    TC
		 WHERE PGT.GOODS_CODE = GD.GOODS_CODE
		   AND GD.GOODS_CODE  = P.GOODS_CODE
		   AND TC.CODE_LGROUP = 'O505'
		   AND TC.CODE_MGROUP = PGT.PA_CODE
		   AND P.SALE_GB 	  = '00'
		   AND GD.SALE_GB 	  = '00'
		   AND PGT.AUTO_YN 	  = '1'
		   AND PGT.PA_GROUP_CODE NOT IN ('01','02','03','05','06','07','08','09','11') /*11번가, 이베이, 쿠팡, 위메프, 인터파크, 롯데온, 티몬, 카카오 제외*/
		   AND PGT.MODIFY_DATE &gt; SYSDATE - 365 /* 풀스켄막기위해처리 */
		   AND GD.SALE_START_DATE &lt;= SYSDATE
		   AND (GD.SALE_END_DATE &gt; SYSDATE OR GD.SALE_END_DATE IS NULL)
		   AND EXISTS ( SELECT 1
		                  FROM TGOODSDT GT
		                 WHERE GT.GOODS_CODE = GD.GOODS_CODE
		                   AND NVL(DECODE(GT.SALE_GB, 00, CEIL(FUN_GET_ORDER_ABLE_QTY(GT.GOODS_CODE, GT.GOODSDT_CODE, GD.WH_CODE) * TC.CODE_GROUP), 0), 0) &gt; 0 )
		   AND 1 = CASE WHEN PGT.PA_GROUP_CODE = '04' THEN (SELECT 1 FROM TPANAVERGOODS PA WHERE PA.PA_CODE = PGT.PA_CODE AND PA.GOODS_CODE = PGT.GOODS_CODE AND PA.PA_STATUS = '30' AND PA.PA_SALE_GB = '30')
		                WHEN PGT.PA_GROUP_CODE = '10' THEN (SELECT 1 FROM TPASSGGOODS PA WHERE PA.PA_CODE = PGT.PA_CODE AND PA.GOODS_CODE = PGT.GOODS_CODE AND PA.PA_STATUS = '30' AND PA.PA_SALE_GB = '30')     
		                    ELSE 0 END
		   AND NOT EXISTS ( SELECT '1'
                              FROM TPATARGETEXCEPT PT
                             WHERE PT.TARGET_GB   = '00'
                               AND PT.TARGET_CODE = PGT.GOODS_CODE
                               AND (PT.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PT.PA_GROUP_CODE,PGT.PA_GROUP_CODE) &gt; 0)
                               AND PT.USE_YN = '1' )   
       	   AND NOT EXISTS ( SELECT '1' 
                              FROM TPAEXCEPTENTP PEE
                              LEFT OUTER JOIN TPAEXCEPTBRAND PEB ON PEE.EXCEPT_SEQ = PEB.EXCEPT_SEQ AND PEE.ENTP_CODE = PEB.ENTP_CODE AND PEB.USE_YN = '1'
                             WHERE PEE.USE_YN    = '1'
                               AND PEE.ENTP_CODE = GD.ENTP_CODE
                               AND (PEE.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PEE.PA_GROUP_CODE, PGT.PA_GROUP_CODE) &gt; 0)
                               AND (PEE.ALL_BRAND_YN = '1' OR PEB.BRAND_CODE = GD.BRAND_CODE)
                               AND (PEE.SOURCING_MEDIA = '00' OR INSTR(PEE.SOURCING_MEDIA, GD.SOURCING_MEDIA) &gt; 0) 
                               AND 1 = CASE WHEN PGT.PA_GROUP_CODE IN ('01', '02', '03') AND PEE.ENTP_CODE = '109153'
                                            THEN 0
                                            ELSE 1 END)
		   AND ROWNUM &lt;= 0
	</select>
	
	<update id="update11stGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.update11stGoodsAuthTrans by PaCommonController */
        	   TPA11STGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE	= #{modifyDate, jdbcType=TIMESTAMP}
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateGmktGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateGmktGoodsAuthTrans by PaCommonController */
        	   TPAGMKTGOODS GG
           SET GG.TRANS_TARGET_YN = '1'
             , GG.PA_SALE_GB 	  = '20'
             , GG.PA_STATUS 	  = '30'
             , GG.MODIFY_DATE	  = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE GG.GOODS_CODE 	  = #{goodsCode,   jdbcType=VARCHAR}
           AND GG.PA_SALE_GB 	  = '30'
           AND GG.PA_STATUS 	  = '30'
           AND GG.PA_GROUP_CODE   = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateNaverGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateNaverGoodsAuthTrans by PaCommonController */
        	   TPANAVERGOODS GG
           SET GG.TRANS_SALE_YN = '1'
             , GG.PA_SALE_GB 	= '20'
             , GG.PA_STATUS 	= '30'
             , GG.MODIFY_DATE 	= #{modifyDate, jdbcType=TIMESTAMP}
         WHERE GG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND GG.PA_SALE_GB 	= '30'
           AND GG.PA_STATUS 	= '30'
           AND GG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateCopnGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateCopnGoodsAuthTrans by PaCommonController */
        	   TPACOPNGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= #{modifyDate, jdbcType=TIMESTAMP}
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateWempGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateWempGoodsAuthTrans by PaCommonController */
        	   TPAWEMPGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.DISPLAY_YN 	= '1'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= #{modifyDate, jdbcType=TIMESTAMP}
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateIntpGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateIntpGoodsAuthTrans by PaCommonController */
        	   TPAINTPGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= #{modifyDate, jdbcType=TIMESTAMP}
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <select id="selectGoodsEventTransInfoList" resultType="hashMap">
    	SELECT /* pacommon.xml: pacommon.pacommon.selectGoodsEventTransInfoList by PaCommonController */
    		   PGE.GOODS_CODE
	         , PGE.PA_GROUP_CODE
	      FROM TGOODS   G
	         , TPAGOODS PG
	         , TPAGOODSEVENT PGE
	         , TCODE    TC
	         , TBRAND   TB
	     WHERE G.GOODS_CODE   = PG.GOODS_CODE
	       AND PG.GOODS_CODE  = PGE.GOODS_CODE
	       AND G.ORIGIN_CODE  = TC.CODE_MGROUP
	       AND TC.CODE_LGROUP = 'B023'
	       AND TC.USE_YN      = '1'
	       AND G.BRAND_CODE   = TB.BRAND_CODE
	       AND PGE.USE_YN 	  = '1'
	       AND G.SALE_GB 	  = '00'
	       AND 1 = CASE WHEN PGE.PA_GROUP_CODE = '04' THEN (SELECT 1 FROM TPANAVERGOODS PA WHERE PA.GOODS_CODE = PGE.GOODS_CODE AND PA.PA_STATUS = '30' AND PA.PA_SALE_GB = '30')
	                    WHEN PGE.PA_GROUP_CODE = '10' THEN (SELECT 1 FROM TPASSGGOODS PA WHERE PA.GOODS_CODE = PGE.GOODS_CODE AND PA.PA_STATUS = '30' AND PA.PA_SALE_GB = '30')
	                    WHEN PGE.PA_GROUP_CODE = '11' THEN (SELECT 1 FROM TPAKAKAOGOODS PA WHERE PA.GOODS_CODE = PGE.GOODS_CODE AND PA.PA_STATUS = '30' AND PA.PA_SALE_GB = '30')
	                    ELSE 0 END
	       AND G.SALE_START_DATE &lt;= SYSDATE
	       AND (G.SALE_END_DATE &gt; SYSDATE OR G.SALE_END_DATE IS NULL)
	       AND PGE.START_DATE &lt;= SYSDATE
	       AND (PGE.END_DATE &gt; SYSDATE OR PGE.END_DATE IS NULL)
	       AND (PGE.START_DATE + 2/24) &gt; SYSDATE /* 행사시작일 기준 2시간 동안만 연동 시도 */
    </select>
    
	<update id="update11stGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.update11stGoodsEventTrans by PaCommonController */
        	   TPA11STGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= SYSDATE
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateGmktGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateGmktGoodsEventTrans by PaCommonController */
        	   TPAGMKTGOODS GG
           SET GG.TRANS_TARGET_YN = '1'
             , GG.PA_SALE_GB 	  = '20'
             , GG.PA_STATUS 	  = '30'
             , GG.MODIFY_DATE 	  = SYSDATE
         WHERE GG.GOODS_CODE 	  = #{goodsCode,   jdbcType=VARCHAR}
           AND GG.PA_SALE_GB 	  = '30'
           AND GG.PA_STATUS 	  = '30'
           AND GG.PA_GROUP_CODE   = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateNaverGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateNaverGoodsEventTrans by PaCommonController */
        	   TPANAVERGOODS GG
           SET GG.TRANS_SALE_YN = '1'
             , GG.PA_SALE_GB 	= '20'
             , GG.PA_STATUS 	= '30'
             , GG.MODIFY_DATE 	= SYSDATE
         WHERE GG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND GG.PA_SALE_GB 	= '30'
           AND GG.PA_STATUS 	= '30'
           AND GG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateCopnGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateCopnGoodsEventTrans by PaCommonController */
        	   TPACOPNGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= SYSDATE
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateWempGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateWempGoodsEventTrans by PaCommonController */
        	   TPAWEMPGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.DISPLAY_YN 	= '1'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= SYSDATE
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateIntpGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateIntpGoodsEventTrans by PaCommonController */
        	   TPAINTPGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= SYSDATE
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updateOfferTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateOfferTrans by PaCommonController */
        	   TPAGOODSOFFER P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
           AND P.USE_YN			 = '1'
           AND P.PA_GROUP_CODE	 = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    <!-- 
    <select id="selectPaPromoTargetAllList" resultType="com.cware.netshopping.domain.model.PaPromoTarget">
    	SELECT * FROM (  /* pacommon.xml: pacommon.pacommon.selectPaPromoTargetAllList by PaCommonController */
		    SELECT /*+LEADING(PM PMT PGP) USE_HASH(PM PMT) USE_NL(PGP)*/ 
		    	  'I' AS PROC_GB
		         , PM.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PMT.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
		             (CASE WHEN PM.LIMIT_AMT > 0
		                   THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                               THEN PM.LIMIT_AMT
		                               ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                           END )
		                   ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		              END )
		                ELSE PM.DO_AMT END AS DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                THEN TRUNC((CASE WHEN PM.LIMIT_AMT > 0
		                                 THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                             THEN PM.LIMIT_AMT
		                                             ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                         END )
		                                  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                             END ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                ELSE NVL(PMT.OWN_COST,0) END AS OWN_COST
		         , null AS OLD_OWN_COST
		         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                THEN (CASE WHEN PM.LIMIT_AMT > 0
		                           THEN (CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                      THEN PM.LIMIT_AMT
		                                      ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                  END )
		                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                       END ) - TRUNC((CASE WHEN PM.LIMIT_AMT > 0
		                                           THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                                       THEN PM.LIMIT_AMT
		                                                       ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                                   END )
		                                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                       END ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                ELSE NVL(PMT.ENTP_COST,0)
		            END AS ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 3 AS PROMO_SORT
		         , TC.CODE_MGROUP AS PA_GROUP_CODE
		      FROM TPROMOM PM
		         , TPPROMOTARGET PMT
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		     WHERE PM.PROMO_NO = PMT.PROMO_NO
		       AND PGP.GOODS_CODE = PMT.GOODS_CODE
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND TC.CODE_LGROUP    = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1  =CASE  WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
                     		 ELSE 0 END
		       AND PM.PROMO_BDATE &lt; SYSDATE
		       AND PM.PROMO_EDATE > SYSDATE
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND NOT EXISTS (  SELECT 'X'
                                   FROM (SELECT PPMT.PROMO_NO, PPMT.PA_CODE, PPMT.GOODS_CODE
                                              , CASE WHEN PPMT.PA_CODE IN('11','12') THEN  '01'
                                                     WHEN PPMT.PA_CODE IN('21','22') AND PPMT.PA_GROUP_CODE IS NULL THEN '02,03'
                                                     WHEN PPMT.PA_CODE IN('21','22') AND PPMT.PA_GROUP_CODE IS NOT NULL THEN PPMT.PA_GROUP_CODE
                                                     WHEN PPMT.PA_CODE IN('31','32') THEN  '03'
                                                     WHEN PPMT.PA_CODE IN('41','42') THEN  '04'
                                                     WHEN PPMT.PA_CODE IN('51','52') THEN  '05'
                                                     WHEN PPMT.PA_CODE IN('61','62') THEN  '06'
                                                     WHEN PPMT.PA_CODE IN('71','72') THEN  '07'
                                                     WHEN PPMT.PA_CODE IN('81','82') THEN  '08'
                                                     WHEN PPMT.PA_CODE IN('91','92') THEN  '09'
                                                END AS PA_GROUP_CODE  
                                           FROM TPAPROMOTARGET PPMT
                                          WHERE PPMT.PROMO_NO   = PMT.PROMO_NO
                                            AND PPMT.PA_CODE    = PGP.PA_CODE
                                            AND PPMT.GOODS_CODE = PGP.GOODS_CODE)
                                  WHERE PROMO_NO   	  = PMT.PROMO_NO
                                    AND PA_CODE       = PGP.PA_CODE
                                    AND GOODS_CODE    = PGP.GOODS_CODE
                                    AND PA_GROUP_CODE LIKE '%' ||TC.CODE_MGROUP || '%'
                          	  )
               AND NOT EXISTS ( SELECT 'X' 
                                  FROM TPAPROMOTARGETEXCEPT TPE
                                 WHERE TPE.TARGET_CODE = PGP.GOODS_CODE
                                   AND (INSTR(TPE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1)
                                   AND TPE.USE_YN = '1' )
               AND PM.ALCOUT_PROMO_YN = '1'
         
		 UNION ALL
		 
		SELECT *
		  FROM (
		    SELECT /*+leading(PM PMT PGP PPTG) use_hash(PM PMT) USE_NL(PGP PPTG)*/ 
		    	   'U' AS PROC_GB
		         , PM.PROMO_NO
		         , PPTG.PROMO_NO AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PMT.GOODS_CODE
		         , PPTG.GOODS_CODE AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , PPTG.PROMO_EDATE AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , PPTG.AMT_RATE_FLAG AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , PPTG.DO_RATE AS OLD_DO_RATE
		         , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
		             (CASE WHEN PM.LIMIT_AMT > 0
		                   THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                               THEN PM.LIMIT_AMT
		                               ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                           END )
		                   ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		              END )
		                ELSE PM.DO_AMT END AS DO_AMT
		         , PPTG.DO_AMT AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , PPTG.STANDARD_APP_AMT AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , PPTG.LIMIT_AMT AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , PPTG.USE_CODE AS OLD_USE_CODE
		         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                THEN TRUNC((CASE WHEN PM.LIMIT_AMT > 0
		                                 THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                             THEN PM.LIMIT_AMT
		                                             ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                         END )
		                                  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                             END ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                ELSE NVL(PMT.OWN_COST,0) END AS OWN_COST
		         , PPTG.OWN_COST AS OLD_OWN_COST
		         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
		                THEN (CASE WHEN PM.LIMIT_AMT > 0
		                           THEN (CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                      THEN PM.LIMIT_AMT
		                                      ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                  END )
		                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                       END ) - TRUNC((CASE WHEN PM.LIMIT_AMT > 0
		                                           THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
		                                                       THEN PM.LIMIT_AMT
		                                                       ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                                   END )
		                                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
		                                       end ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
		                ELSE NVL(PMT.ENTP_COST,0)
		            END AS ENTP_COST
		         , PPTG.ENTP_COST AS OLD_ENTP_COST
		         , PPTG.PROC_GB AS OLD_PROC_GB
		         , 2 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		      FROM TPROMOM PM
		         , TPPROMOTARGET PMT
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		         , TPAPROMOTARGET PPTG
		     WHERE PM.PROMO_NO = PMT.PROMO_NO
		       AND PGP.GOODS_CODE = PMT.GOODS_CODE
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.USE_CODE = '00'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND TC.CODE_LGROUP    = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                    ELSE 0 END
		       AND PM.PROMO_BDATE &lt; SYSDATE
		       AND PM.PROMO_EDATE > SYSDATE
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.PROMO_NO = PMT.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
		       AND PPTG.GOODS_CODE = PGP.GOODS_CODE
		       AND PPTG.ROWID = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.ROWID
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PROMO_NO = PPTG.PROMO_NO
		                          AND PPMT.PA_CODE = PPTG.PA_CODE
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND PPMT.DO_AMT    != 0
		                          AND NVL(PPMT.PA_GROUP_CODE, '1') = CASE WHEN PPTG.PA_CODE IN ('21', '22') THEN PPTG.PA_GROUP_CODE 
                                             								ELSE NVL(PPMT.PA_GROUP_CODE, '1')
                                               						 END
		                          AND ROWNUM = 1
		                      )
               AND NOT EXISTS ( SELECT 'X' 
                                  FROM TPAPROMOTARGETEXCEPT TPE
                                 WHERE TPE.TARGET_CODE = PGP.GOODS_CODE
                                   AND (INSTR(TPE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1)
                                   AND TPE.USE_YN = '1' )      
               AND PM.ALCOUT_PROMO_YN = '1'
		) XA
		WHERE XA.OLD_OWN_COST != XA.OWN_COST
		   OR XA.OLD_ENTP_COST != XA.ENTP_COST
		   OR XA.OLD_USE_CODE != XA.USE_CODE
		   OR XA.OLD_PROMO_EDATE != XA.PROMO_EDATE
		   OR XA.OLD_PROC_GB = 'D'
		
		 UNION ALL
		
		    SELECT /*+leading(PM PPTG PGP) use_hash(PM PPTG) USE_NL(PGP)*/
		    	  'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
		       AND PPTG.GOODS_CODE = PGP.GOODS_CODE
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
							ELSE 0 END
		       AND PM.PROMO_EDATE > SYSDATE - INTERVAL '10' MINUTE
		       AND PPTG.PROC_GB != 'D'
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.ROWID = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.ROWID
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PROMO_NO = PPTG.PROMO_NO
		                          AND PPMT.PA_CODE = PPTG.PA_CODE
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND PPMT.DO_AMT    != 0
		                          AND NVL(PPMT.PA_GROUP_CODE, '1') = CASE WHEN PPTG.PA_CODE IN ('21', '22') THEN PPTG.PA_GROUP_CODE 
                                             								ELSE NVL(PPMT.PA_GROUP_CODE, '1')
                                               						 END
		                          AND ROWNUM = 1
		                      )
		       AND NOT EXISTS (SELECT 1
		                         FROM TPPROMOTARGET PMT
		                        WHERE PPTG.PROMO_NO = PMT.PROMO_NO
		                          AND PPTG.GOODS_CODE = PMT.GOODS_CODE
		                      )
		
		UNION ALL
		
		    SELECT  /*+leading(PM PPTG PGP) use_hash(PM PPTG) USE_NL(PGP)*/
		    	  'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC 
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
		       AND PPTG.GOODS_CODE = PGP.GOODS_CODE
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                    ELSE 0 END
		       AND (PM.PROMO_EDATE &lt; SYSDATE OR (PM.USE_CODE != '00' AND  PM.MODIFY_DATE > TO_DATE('20210701090000' , 'YYYYMMDDHH24MISS') ) ) 
		       AND PPTG.PROC_GB != 'D'
		       AND PPTG.INSERT_DATE > TO_DATE('20211201', 'YYYYMMDD')  
		       AND PM.PROMO_EDATE > TO_DATE('20210701090000', 'YYYYMMDDHH24MISS') 
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.rowid = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.rowid
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PA_CODE = PPTG.PA_CODE
		                          AND PPMT.PROMO_NO = PPTG.PROMO_NO
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND PPMT.DO_AMT    != 0  
		                          AND NVL(PPMT.PA_GROUP_CODE, '1') = CASE WHEN PPTG.PA_CODE IN ('21', '22') THEN PPTG.PA_GROUP_CODE 
                                             								ELSE NVL(PPMT.PA_GROUP_CODE, '1')
                                               						 END
		                          AND ROWNUM = 1
		                      	)
		                      	
		       UNION ALL
		       
		    SELECT  /*+LEADING(PM PPTG PGP TPE) USE_HASH(PM PPTG) USE_NL(PGP)*/
		    	   'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		         , TPAPROMOTARGETEXCEPT TPE
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
               AND PPTG.GOODS_CODE = PGP.GOODS_CODE
	           AND PGP.GOODS_CODE = TPE.TARGET_CODE
	           AND TPE.TARGET_CODE = PPTG.GOODS_CODE
           
		       AND (TPE.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(TPE.PA_GROUP_CODE,  CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
                                                                               ELSE TC.CODE_MGROUP
                                                                           END) > 0 )
		       AND TPE.USE_YN = '1'
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND PM.PROMO_EDATE > SYSDATE
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                    ELSE 0 END
		       AND PPTG.PROC_GB != 'D'
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.rowid = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.rowid
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PA_CODE    = PPTG.PA_CODE
		                          AND PPMT.PROMO_NO   = PPTG.PROMO_NO
		                          AND PPMT.DO_AMT    != 0
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND NVL(PPMT.PA_GROUP_CODE, '1') = CASE WHEN PPTG.PA_CODE IN ('21', '22') THEN PPTG.PA_GROUP_CODE 
                                             								ELSE NVL(PPMT.PA_GROUP_CODE, '1')
                                               						 END
		                          AND ROWNUM = 1
		                      	)		                      	
		                      	
		) WHERE ROWNUM &lt; 10000
    </select>
     -->
    
    <select id="selectPaPromoTargetAllList" resultType="com.cware.netshopping.domain.model.PaPromoTarget">
    	SELECT * /* pacommon.xml: pacommon.pacommon.selectPaPromoTargetAllList by PaCommonController */
    	  FROM (  
		    SELECT 
		    	   XX.PROC_GB
		    	 , XX.PROMO_NO
		    	 , XX.OLD_PROMO_NO
		    	 , XX.PA_CODE
		    	 , XX.GOODS_CODE
		    	 , XX.OLD_GOODS_CODE
		    	 , XX.DO_TYPE
		    	 , XX.COUPON_YN
		    	 , XX.IMMEDIATELY_YN
		    	 , XX.PROMO_BDATE
		    	 , XX.PROMO_EDATE
		    	 , XX.OLD_PROMO_EDATE
		    	 , XX.AMT_RATE_FLAG
		    	 , XX.OLD_AMT_RATE_FLAG
		    	 , XX.DO_RATE
		    	 , XX.OLD_DO_RATE
		    	 , XX.DO_AMT
		    	 , XX.OLD_DO_AMT
		    	 , XX.STANDARD_APP_AMT
		    	 , XX.OLD_STANDARD_APP_AMT
		    	 , XX.LIMIT_AMT
		    	 , XX.OLD_LIMIT_AMT
		    	 , XX.USE_CODE
		    	 , XX.OLD_USE_CODE
		    	 , XX.OWN_COST
		    	 , XX.OLD_OWN_COST
		    	 , XX.ENTP_COST
		    	 , XX.OLD_ENTP_COST
		    	 , XX.OLD_PROC_GB
		    	 , XX.PROMO_SORT
		    	 , XX.PA_GROUP_CODE
		    	 , XX.PROMO_CHECK_AMT
		 	  FROM (
		 	  		SELECT /*+LEADING(PM PMT PGP) USE_HASH(PM PMT) USE_NL(PGP)*/ 
				    	  'I' AS PROC_GB
				         , PM.PROMO_NO
				         , '' AS OLD_PROMO_NO
				         , PGP.PA_CODE
				         , PMT.GOODS_CODE
				         , '' AS OLD_GOODS_CODE
				         , PM.DO_TYPE
				         , PM.COUPON_YN
				         , PM.IMMEDIATELY_YN
				         , PM.PROMO_BDATE
				         , PM.PROMO_EDATE
				         , null AS OLD_PROMO_EDATE
				         , PM.AMT_RATE_FLAG
				         , '' AS OLD_AMT_RATE_FLAG
				         , PM.DO_RATE
				         , null AS OLD_DO_RATE
				         , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
				             (CASE WHEN PM.LIMIT_AMT > 0
				                   THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
				                               THEN PM.LIMIT_AMT
				                               ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				                           END )
				                   ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				              END )
				                ELSE PM.DO_AMT END AS DO_AMT
				         , null AS OLD_DO_AMT
				         , PM.STANDARD_APP_AMT
				         , null AS OLD_STANDARD_APP_AMT
				         , PM.LIMIT_AMT
				         , null AS OLD_LIMIT_AMT
				         , PM.USE_CODE
				         , '' AS OLD_USE_CODE
				         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
				                THEN TRUNC((CASE WHEN PM.LIMIT_AMT > 0
				                                 THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
				                                             THEN PM.LIMIT_AMT
				                                             ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				                                         END )
				                                  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				                             END ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
				                ELSE NVL(PMT.OWN_COST,0) END AS OWN_COST
				         , null AS OLD_OWN_COST
				         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
				                THEN (CASE WHEN PM.LIMIT_AMT > 0
				                           THEN (CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
				                                      THEN PM.LIMIT_AMT
				                                      ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				                                  END )
				                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				                       END ) - TRUNC((CASE WHEN PM.LIMIT_AMT > 0
				                                           THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
				                                                       THEN PM.LIMIT_AMT
				                                                       ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				                                                   END )
				                                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
				                                       END ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
				                ELSE NVL(PMT.ENTP_COST,0)
				            END AS ENTP_COST
				         , null AS OLD_ENTP_COST
				         , null AS OLD_PROC_GB
				         , 3 AS PROMO_SORT
				         , TC.CODE_MGROUP AS PA_GROUP_CODE
				         , PGP.SALE_PRICE - PGP.DC_AMT - PGP.LUMP_SUM_DC_AMT AS PROMO_CHECK_AMT
				      FROM TPROMOM PM
				         , TPPROMOTARGET PMT
				         , TPAGOODSPRICE PGP
				         , TCODE TC
				     WHERE PM.PROMO_NO = PMT.PROMO_NO
				       AND PGP.GOODS_CODE = PMT.GOODS_CODE
				       AND PM.COUPON_YN = '1'
				       AND PM.DO_TYPE = '30'
				       AND PM.IMMEDIATELY_YN = '1'
				       AND TC.CODE_LGROUP    = 'O500'
				       AND TC.CODE_MGROUP    IN ('04')
				       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
				       AND 1  =CASE  WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                     		 ELSE 0 END
				       AND PM.PROMO_BDATE &lt; SYSDATE
				       AND PM.PROMO_EDATE > SYSDATE
				       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
				                               GP.ROWID
				                          FROM TPAGOODSPRICE GP
				                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
				                           AND GP.APPLY_DATE &lt; SYSDATE
				                           AND GP.PA_CODE = PGP.PA_CODE
				                           AND ROWNUM = 1)
				       AND NOT EXISTS (  SELECT 'X'
		                                   FROM (SELECT PPMT.PROMO_NO, PPMT.PA_CODE, PPMT.GOODS_CODE
		                                              , CASE WHEN PPMT.PA_CODE IN('11','12') THEN  '01'
		                                                     WHEN PPMT.PA_CODE IN('21','22') AND PPMT.PA_GROUP_CODE IS NULL THEN '02,03'
		                                                     WHEN PPMT.PA_CODE IN('21','22') AND PPMT.PA_GROUP_CODE IS NOT NULL THEN PPMT.PA_GROUP_CODE
		                                                     WHEN PPMT.PA_CODE IN('31','32') THEN  '03'
		                                                     WHEN PPMT.PA_CODE IN('41','42') THEN  '04'
		                                                     WHEN PPMT.PA_CODE IN('51','52') THEN  '05'
		                                                     WHEN PPMT.PA_CODE IN('61','62') THEN  '06'
		                                                     WHEN PPMT.PA_CODE IN('71','72') THEN  '07'
		                                                     WHEN PPMT.PA_CODE IN('81','82') THEN  '08'
		                                                     WHEN PPMT.PA_CODE IN('91','92') THEN  '09'
		                                                END AS PA_GROUP_CODE  
		                                           FROM TPAPROMOTARGET PPMT
		                                          WHERE PPMT.PROMO_NO   = PMT.PROMO_NO
		                                            AND PPMT.PA_CODE    = PGP.PA_CODE
		                                            AND PPMT.GOODS_CODE = PGP.GOODS_CODE)
		                                  WHERE PROMO_NO   	  = PMT.PROMO_NO
		                                    AND PA_CODE       = PGP.PA_CODE
		                                    AND GOODS_CODE    = PGP.GOODS_CODE
		                                    AND PA_GROUP_CODE LIKE '%' ||TC.CODE_MGROUP || '%'
		                          	  )

					   AND NOT EXISTS ( SELECT 'X' 
					                      FROM TPAPROMOEXCEPTENTP PEE
					                         , TPAPROMOEXCEPTBRAND PEB
					                         , TGOODS TG 
					                     WHERE PMT.GOODS_CODE = TG.GOODS_CODE
					                       AND TG.ENTP_CODE = PEE.ENTP_CODE
					                       AND PEE.ENTP_CODE = PEB.ENTP_CODE
					                       AND TG.BRAND_CODE = PEB.BRAND_CODE
					                       AND PEB.USE_YN = '1'
					                       AND (INSTR(PEE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
					                       AND (PEB.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEB.PA_EXCEPT_EDATE >= SYSDATE)
					                      )                               
					   AND NOT EXISTS ( SELECT 'X' 
					                      FROM TPAPROMOEXCEPTENTP PEE
					                         , TGOODS TG 
					                     WHERE PMT.GOODS_CODE = TG.GOODS_CODE
					                       AND TG.ENTP_CODE = PEE.ENTP_CODE
					                       AND PEE.USE_YN = '1'
					                       AND (INSTR(PEE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
					                       AND (PEE.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEE.PA_EXCEPT_EDATE >= SYSDATE)
					                       AND PEE.ALL_BRAND_YN = '1'
					                  )                   
		               AND PM.ALCOUT_PROMO_YN = '1'
		           ) XX
		           LEFT OUTER JOIN TPAPROMOTARGETEXCEPT TPE ON TPE.TARGET_CODE = XX.GOODS_CODE AND TPE.USE_YN = '1' AND (INSTR(TPE.PA_GROUP_CODE, XX.PA_GROUP_CODE ) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1) 
		                                                    AND SYSDATE BETWEEN TPE.PA_EXCEPT_BDATE AND TPE.PA_EXCEPT_EDATE AND TPE.TARGET_GB = '00'
		 	  WHERE (TPE.TARGET_CODE IS NULL OR ((PROMO_CHECK_AMT - XX.DO_AMT) >= TPE.PA_EXCEPT_MARGIN) )
		 	               
         
		 UNION ALL
		 
		SELECT XA.PROC_GB
		  	 , XA.PROMO_NO
		   	 , XA.OLD_PROMO_NO
		   	 , XA.PA_CODE
		   	 , XA.GOODS_CODE
		   	 , XA.OLD_GOODS_CODE
		   	 , XA.DO_TYPE
		   	 , XA.COUPON_YN
		   	 , XA.IMMEDIATELY_YN
		   	 , XA.PROMO_BDATE
		   	 , XA.PROMO_EDATE
		   	 , XA.OLD_PROMO_EDATE
		   	 , XA.AMT_RATE_FLAG
		   	 , XA.OLD_AMT_RATE_FLAG
		   	 , XA.DO_RATE
		   	 , XA.OLD_DO_RATE
		   	 , XA.DO_AMT
		   	 , XA.OLD_DO_AMT
		   	 , XA.STANDARD_APP_AMT
		   	 , XA.OLD_STANDARD_APP_AMT
		   	 , XA.LIMIT_AMT
		   	 , XA.OLD_LIMIT_AMT
		   	 , XA.USE_CODE
		   	 , XA.OLD_USE_CODE
		   	 , XA.OWN_COST
		   	 , XA.OLD_OWN_COST
		   	 , XA.ENTP_COST
		   	 , XA.OLD_ENTP_COST
		   	 , XA.OLD_PROC_GB
		   	 , XA.PROMO_SORT
		   	 , XA.PA_GROUP_CODE
		   	 , XA.PROMO_CHECK_AMT
		  FROM (
			    SELECT /*+leading(PM PMT PGP PPTG) use_hash(PM PMT) USE_NL(PGP PPTG)*/ 
			    	   'U' AS PROC_GB
			         , PM.PROMO_NO
			         , PPTG.PROMO_NO AS OLD_PROMO_NO
			         , PGP.PA_CODE
			         , PMT.GOODS_CODE
			         , PPTG.GOODS_CODE AS OLD_GOODS_CODE
			         , PM.DO_TYPE
			         , PM.COUPON_YN
			         , PM.IMMEDIATELY_YN
			         , PM.PROMO_BDATE
			         , PM.PROMO_EDATE
			         , PPTG.PROMO_EDATE AS OLD_PROMO_EDATE
			         , PM.AMT_RATE_FLAG
			         , PPTG.AMT_RATE_FLAG AS OLD_AMT_RATE_FLAG
			         , PM.DO_RATE
			         , PPTG.DO_RATE AS OLD_DO_RATE
			         , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
			             (CASE WHEN PM.LIMIT_AMT > 0
			                   THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
			                               THEN PM.LIMIT_AMT
			                               ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			                           END )
			                   ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			              END )
			                ELSE PM.DO_AMT END AS DO_AMT
			         , PPTG.DO_AMT AS OLD_DO_AMT
			         , PM.STANDARD_APP_AMT
			         , PPTG.STANDARD_APP_AMT AS OLD_STANDARD_APP_AMT
			         , PM.LIMIT_AMT
			         , PPTG.LIMIT_AMT AS OLD_LIMIT_AMT
			         , PM.USE_CODE
			         , PPTG.USE_CODE AS OLD_USE_CODE
			         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
			                THEN TRUNC((CASE WHEN PM.LIMIT_AMT > 0
			                                 THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
			                                             THEN PM.LIMIT_AMT
			                                             ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			                                         END )
			                                  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			                             END ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
			                ELSE NVL(PMT.OWN_COST,0) END AS OWN_COST
			         , PPTG.OWN_COST AS OLD_OWN_COST
			         , CASE WHEN PM.AMT_RATE_FLAG = '2' AND PM.DO_TYPE != '20'
			                THEN (CASE WHEN PM.LIMIT_AMT > 0
			                           THEN (CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
			                                      THEN PM.LIMIT_AMT
			                                      ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			                                  END )
			                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			                       END ) - TRUNC((CASE WHEN PM.LIMIT_AMT > 0
			                                           THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
			                                                       THEN PM.LIMIT_AMT
			                                                       ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			                                                   END )
			                                           ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
			                                       end ) * (100 - NVL(PMT.ENTP_COST, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
			                ELSE NVL(PMT.ENTP_COST,0)
			            END AS ENTP_COST
			         , PPTG.ENTP_COST AS OLD_ENTP_COST
			         , PPTG.PROC_GB AS OLD_PROC_GB
			         , 2 AS PROMO_SORT
			         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
			             ELSE TC.CODE_MGROUP
			           END AS PA_GROUP_CODE
			         , PGP.SALE_PRICE - PGP.DC_AMT - PGP.LUMP_SUM_DC_AMT AS PROMO_CHECK_AMT 
			      FROM TPROMOM PM
			         , TPPROMOTARGET PMT
			         , TPAGOODSPRICE PGP
			         , TCODE TC
			         , TPAPROMOTARGET PPTG
			     WHERE PM.PROMO_NO = PMT.PROMO_NO
			       AND PGP.GOODS_CODE = PMT.GOODS_CODE
			       AND PM.COUPON_YN = '1'
			       AND PM.DO_TYPE = '30'
			       AND PM.USE_CODE = '00'
			       AND PM.IMMEDIATELY_YN = '1'
			       AND TC.CODE_LGROUP    = 'O500'
			       AND TC.CODE_MGROUP    IN ('04')
			       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
			       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
			                    ELSE 0 END
			       AND PM.PROMO_BDATE &lt; SYSDATE
			       AND PM.PROMO_EDATE > SYSDATE
			       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
			                               GP.ROWID
			                          FROM TPAGOODSPRICE GP
			                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
			                           AND GP.APPLY_DATE &lt; SYSDATE
			                           AND GP.PA_CODE = PGP.PA_CODE
			                           AND ROWNUM = 1)
			       AND PPTG.PROMO_NO = PMT.PROMO_NO
			       AND PPTG.PA_CODE = PGP.PA_CODE
			       AND PPTG.GOODS_CODE = PGP.GOODS_CODE
			       AND PPTG.ROWID = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
			                              PPMT.ROWID
			                         FROM TPAPROMOTARGET PPMT
			                        WHERE PPMT.PROMO_NO = PPTG.PROMO_NO
			                          AND PPMT.PA_CODE = PPTG.PA_CODE
			                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
			                          AND PPMT.DO_AMT    != 0
			                          AND ROWNUM = 1
			                      )
				   AND NOT EXISTS ( SELECT 'X' 
				                      FROM TPAPROMOEXCEPTENTP PEE
				                         , TPAPROMOEXCEPTBRAND PEB
				                         , TGOODS TG 
				                     WHERE PMT.GOODS_CODE = TG.GOODS_CODE
				                       AND TG.ENTP_CODE = PEE.ENTP_CODE
				                       AND PEE.ENTP_CODE = PEB.ENTP_CODE
				                       AND TG.BRAND_CODE = PEB.BRAND_CODE
				                       AND PEB.USE_YN = '1'
				                       AND (INSTR(PEE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
				                       AND (PEB.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEB.PA_EXCEPT_EDATE >= SYSDATE)
				                      )                               
				   AND NOT EXISTS ( SELECT 'X' 
				                      FROM TPAPROMOEXCEPTENTP PEE
				                         , TGOODS TG 
				                     WHERE PMT.GOODS_CODE = TG.GOODS_CODE
				                       AND TG.ENTP_CODE = PEE.ENTP_CODE
				                       AND PEE.USE_YN = '1'
				                       AND (INSTR(PEE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
				                       AND (PEE.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEE.PA_EXCEPT_EDATE >= SYSDATE)
				                       AND PEE.ALL_BRAND_YN = '1'
				                  )
	              AND PM.ALCOUT_PROMO_YN = '1'
			) XA
			LEFT OUTER JOIN TPAPROMOTARGETEXCEPT TPE ON TPE.TARGET_CODE = XA.GOODS_CODE AND TPE.USE_YN = '1' AND (INSTR(TPE.PA_GROUP_CODE, XA.PA_GROUP_CODE ) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1) 
													AND SYSDATE BETWEEN TPE.PA_EXCEPT_BDATE AND TPE.PA_EXCEPT_EDATE AND TPE.TARGET_GB = '00'
		WHERE (XA.OLD_OWN_COST != XA.OWN_COST
		   OR XA.OLD_ENTP_COST != XA.ENTP_COST
		   OR XA.OLD_USE_CODE != XA.USE_CODE
		   OR XA.OLD_PROMO_EDATE != XA.PROMO_EDATE
		   OR XA.OLD_PROC_GB = 'D')
		  AND (TPE.TARGET_CODE IS NULL OR ((PROMO_CHECK_AMT - XA.DO_AMT) >= TPE.PA_EXCEPT_MARGIN) ) 
		   
		
		 UNION ALL
 
		    SELECT /*+leading(PM PPTG PGP) use_hash(PM PPTG) USE_NL(PGP)*/
		    	  'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		         , 0
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
		       AND PPTG.GOODS_CODE = PGP.GOODS_CODE
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
							ELSE 0 END
		       AND PM.PROMO_EDATE > SYSDATE - INTERVAL '10' MINUTE
		       AND PPTG.PROC_GB != 'D'
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.ROWID = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.ROWID
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PROMO_NO = PPTG.PROMO_NO
		                          AND PPMT.PA_CODE = PPTG.PA_CODE
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND PPMT.DO_AMT    != 0
		                          AND ROWNUM = 1
		                      )
		       AND NOT EXISTS (SELECT 1
		                         FROM TPPROMOTARGET PMT
		                        WHERE PPTG.PROMO_NO = PMT.PROMO_NO
		                          AND PPTG.GOODS_CODE = PMT.GOODS_CODE
		                      )
		
		UNION ALL
		
		    SELECT /*+leading(PM PPTG PGP) use_hash(PM PPTG) USE_NL(PGP)*/
		    	  'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		         , 0
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC 
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
		       AND PPTG.GOODS_CODE = PGP.GOODS_CODE
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                    ELSE 0 END
		       AND (PM.PROMO_EDATE &lt; SYSDATE OR (PM.USE_CODE != '00' AND  PM.MODIFY_DATE > TO_DATE('20210701090000' , 'YYYYMMDDHH24MISS') ) ) 
		       AND PPTG.PROC_GB != 'D'
		       AND PPTG.INSERT_DATE > TO_DATE('20211201', 'YYYYMMDD')  /*하드코딩된 날짜 지우지 말것*/
		       AND PM.PROMO_EDATE > TO_DATE('20210701090000', 'YYYYMMDDHH24MISS') 
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.rowid = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.rowid
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PA_CODE = PPTG.PA_CODE
		                          AND PPMT.PROMO_NO = PPTG.PROMO_NO
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND PPMT.DO_AMT    != 0 
		                          AND ROWNUM = 1
		                      	)
		                      	
		       UNION ALL
		       
		    SELECT /* 진행중인 프로모션이나, 상품 적용 예외에 들어가 있는 상품처리 */
		    	   /*+LEADING(PM PPTG PGP TPE) USE_HASH(PM PPTG) USE_NL(PGP)*/
		    	   'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		         , 0
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		         , TPAPROMOTARGETEXCEPT TPE
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
               AND PPTG.GOODS_CODE = PGP.GOODS_CODE
	           AND PGP.GOODS_CODE = TPE.TARGET_CODE
	           AND TPE.TARGET_CODE = PPTG.GOODS_CODE
		       AND (TPE.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(TPE.PA_GROUP_CODE,  CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
                                                                                     ELSE TC.CODE_MGROUP
                                                                           	     END) > 0 )
               AND ((TPE.PA_EXCEPT_BDATE &lt;= SYSDATE AND TPE.PA_EXCEPT_EDATE >= SYSDATE) OR TPE.PA_EXCEPT_BDATE IS NULL)                                                            
		       AND TPE.USE_YN = '1'
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND PM.PROMO_EDATE > SYSDATE
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                    ELSE 0 END
		       AND PPTG.PROC_GB != 'D'
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.rowid = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.rowid
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PA_CODE    = PPTG.PA_CODE
		                          AND PPMT.PROMO_NO   = PPTG.PROMO_NO
		                          AND PPMT.DO_AMT    != 0
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND ROWNUM = 1
		                      	)
		      AND TPE.PA_EXCEPT_MARGIN > (PGP.SALE_PRICE - PGP.DC_AMT - PGP.LUMP_SUM_DC_AMT - PPTG.DO_AMT)
		                      	
		  UNION ALL
		       
		     /* 진행중인 프로모션이나, 업체 + 브랜드 적용 예외에 들어가 있는 상품처리 */
		    SELECT /*+LEADING(PM PPTG PGP PEE PEB) USE_HASH(PM PPTG) USE_NL(PGP)*/
		    	   'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		         , 0
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		         , TGOODS TG
		         , TPAPROMOEXCEPTENTP PEE
		         , TPAPROMOEXCEPTBRAND PEB
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
               AND PPTG.GOODS_CODE = PGP.GOODS_CODE
	           AND PGP.GOODS_CODE = TG.GOODS_CODE
	           AND TG.ENTP_CODE = PEE.ENTP_CODE
	           AND PEE.ENTP_CODE = PEB.ENTP_CODE
	           AND TG.BRAND_CODE = PEB.BRAND_CODE
	           AND PPTG.PA_GROUP_CODE = TC.CODE_MGROUP    
		       AND (PEE.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PEE.PA_GROUP_CODE,  CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
                                                                               ELSE TC.CODE_MGROUP
                                                                           END) > 0 )
		       AND PEE.USE_YN = '1'
		       AND PEB.USE_YN = '1'
		       AND (PEB.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEB.PA_EXCEPT_EDATE >= SYSDATE)
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND PM.PROMO_EDATE > SYSDATE
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                    ELSE 0 END
		       AND PPTG.PROC_GB != 'D'
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.rowid = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.rowid
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PA_CODE    = PPTG.PA_CODE
		                          AND PPMT.PROMO_NO   = PPTG.PROMO_NO
		                          AND PPMT.DO_AMT    != 0
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND ROWNUM = 1
		                      	)	
		                      	
		        UNION ALL
		       
		     /* 진행중인 프로모션이나, 업체 + 모든브랜드 적용 예외에 들어가 있는 상품처리 */
		    SELECT /*+LEADING(PM PPTG PGP PEE) USE_HASH(PM PPTG) USE_NL(PGP)*/
		    	   'D' AS PROC_GB
		         , PPTG.PROMO_NO
		         , '' AS OLD_PROMO_NO
		         , PGP.PA_CODE
		         , PPTG.GOODS_CODE
		         , '' AS OLD_GOODS_CODE
		         , PM.DO_TYPE
		         , PM.COUPON_YN
		         , PM.IMMEDIATELY_YN
		         , PM.PROMO_BDATE
		         , PM.PROMO_EDATE
		         , null AS OLD_PROMO_EDATE
		         , PM.AMT_RATE_FLAG
		         , '' AS OLD_AMT_RATE_FLAG
		         , PM.DO_RATE
		         , null AS OLD_DO_RATE
		         , PPTG.DO_AMT
		         , null AS OLD_DO_AMT
		         , PM.STANDARD_APP_AMT
		         , null AS OLD_STANDARD_APP_AMT
		         , PM.LIMIT_AMT
		         , null AS OLD_LIMIT_AMT
		         , PM.USE_CODE
		         , '' AS OLD_USE_CODE
		         , PPTG.OWN_COST
		         , null AS OLD_OWN_COST
		         , PPTG.ENTP_COST
		         , null AS OLD_ENTP_COST
		         , null AS OLD_PROC_GB
		         , 1 AS PROMO_SORT
		         , CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
		             ELSE TC.CODE_MGROUP
		           END AS PA_GROUP_CODE
		         , 0
		      FROM TPROMOM PM
		         , TPAPROMOTARGET PPTG
		         , TPAGOODSPRICE PGP
		         , TCODE TC
		         , TGOODS TG
		         , TPAPROMOEXCEPTENTP PEE
		     WHERE PM.PROMO_NO = PPTG.PROMO_NO
		       AND PPTG.PA_CODE = PGP.PA_CODE
               AND PPTG.GOODS_CODE = PGP.GOODS_CODE
	           AND PGP.GOODS_CODE = TG.GOODS_CODE
	           AND TG.ENTP_CODE = PEE.ENTP_CODE
		       AND PPTG.PA_GROUP_CODE = TC.CODE_MGROUP    
		       AND (PEE.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PEE.PA_GROUP_CODE,  CASE WHEN TC.CODE_MGROUP IN ('02', '03') THEN PPTG.PA_GROUP_CODE
                                                                               ELSE TC.CODE_MGROUP
                                                                           END) > 0 )
		       AND PEE.USE_YN = '1'
		       AND PEE.ALL_BRAND_YN = '1'
		       AND (PEE.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEE.PA_EXCEPT_EDATE >= SYSDATE)
		       AND PM.COUPON_YN = '1'
		       AND PM.DO_TYPE = '30'
		       AND PM.IMMEDIATELY_YN = '1'
		       AND PM.PROMO_EDATE > SYSDATE
		       AND TC.CODE_LGROUP     = 'O500'
		       AND TC.CODE_MGROUP    IN ('04')
		       AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
		       AND 1 = CASE WHEN TC.CODE_MGROUP = '04' AND EXISTS (SELECT 1 FROM   TPANAVERGOODS PA WHERE  PA.PA_CODE = PGP.PA_CODE AND PA.GOODS_CODE = PGP.GOODS_CODE) THEN 1
		                    ELSE 0 END
		       AND PPTG.PROC_GB != 'D'
		       AND PGP.ROWID = (SELECT /*+ INDEX_DESC (GP PK_TPAGOODSPRICE)*/
		                               GP.ROWID
		                          FROM TPAGOODSPRICE GP
		                         WHERE GP.GOODS_CODE = PGP.GOODS_CODE
		                           AND GP.APPLY_DATE &lt; SYSDATE
		                           AND GP.PA_CODE = PGP.PA_CODE
		                           AND ROWNUM = 1)
		       AND PPTG.rowid = (SELECT /*+INDEX_DESC (PPMT IDX_TPAPROMOTARGET_02)*/
		                              PPMT.rowid
		                         FROM TPAPROMOTARGET PPMT
		                        WHERE PPMT.PA_CODE    = PPTG.PA_CODE
		                          AND PPMT.PROMO_NO   = PPTG.PROMO_NO
		                          AND PPMT.DO_AMT    != 0
		                          AND PPMT.GOODS_CODE = PPTG.GOODS_CODE
		                          AND ROWNUM = 1
		                      	)
		                      		                                     	
		) WHERE ROWNUM &lt; 10000
    </select>
    
    
    <insert id="insertPaPromoTargetAll" parameterType="com.cware.netshopping.domain.model.PaPromoTarget">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaPromoTargetAll by PaCommonController */
			   TPAPROMOTARGET PPMT
                 ( PPMT.PROMO_NO
                 , PPMT.PA_CODE
                 , PPMT.GOODS_CODE
                 , PPMT.SEQ
                 , PPMT.DO_TYPE
                 , PPMT.COUPON_YN
                 , PPMT.IMMEDIATELY_YN
                 , PPMT.PROMO_BDATE
                 , PPMT.PROMO_EDATE
                 , PPMT.AMT_RATE_FLAG
                 , PPMT.DO_RATE
                 , PPMT.DO_AMT
                 , PPMT.STANDARD_APP_AMT
                 , PPMT.LIMIT_AMT
                 , PPMT.USE_CODE
                 , PPMT.OWN_COST
                 , PPMT.ENTP_COST
                 , PPMT.INSERT_ID
                 , PPMT.MODIFY_ID
                 , PPMT.PROC_GB
                 , PPMT.PA_GROUP_CODE
                 )
          VALUES ( #{promoNo, 	jdbcType=VARCHAR}
                 , #{paCode,    jdbcType=VARCHAR}
                 , #{goodsCode, jdbcType=VARCHAR}
                 , (SELECT LTRIM(TO_CHAR(NVL(MAX(TO_NUMBER(PPMT2.SEQ)), 0) + 1, '0000'))
                      FROM TPAPROMOTARGET PPMT2
                     WHERE PPMT2.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                       AND PPMT2.PROMO_NO   = #{promoNo,   jdbcType=VARCHAR}
                       AND PPMT2.PA_CODE 	= #{paCode,    jdbcType=VARCHAR})
                 , #{doType, 		 jdbcType=VARCHAR}
                 , #{couponYn, 		 jdbcType=VARCHAR}
                 , #{immediatelyYn,  jdbcType=VARCHAR}
                 , #{promoBdate, 	 jdbcType=TIMESTAMP}
                 , #{promoEdate, 	 jdbcType=TIMESTAMP}
                 , #{amtRateFlag, 	 jdbcType=VARCHAR}
                 , #{doRate, 		 jdbcType=NUMERIC}
                 , #{doAmt, 		 jdbcType=NUMERIC}
                 , #{standardAppAmt, jdbcType=NUMERIC}
                 , #{limitAmt, 		 jdbcType=NUMERIC}
                 , #{useCode, 		 jdbcType=VARCHAR}
                 , #{ownCost, 		 jdbcType=NUMERIC}
                 , #{entpCost, 		 jdbcType=NUMERIC}
                 , 'SYSTEM'
                 , 'SYSTEM'
                 , #{procGb, 		 jdbcType=VARCHAR}
                 , #{paGroupCode,	 jdbcType=VARCHAR}
                 )
    </insert>
    
    <select id="selectCurEbayImageInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.PaGoodsImage">
        SELECT /* pacommon.xml : pacommon.common.selectCurEbayImageInfoList */ 
               TG.GOODS_CODE
			 , TP.PA_GROUP_CODE
			 , NVL(TI.INFO_IMAGE_FILE1, NVL(TG.IMAGE_C, TG.IMAGE_G)) AS IMAGE_P
			 , NVL(TG.IMAGE_AT, TG.IMAGE_AG) AS IMAGE_AP
			 , NVL(TG.IMAGE_BT, TG.IMAGE_BG) AS IMAGE_BP
			 , TG.IMAGE_URL
		  FROM TGOODSIMAGE   TG
			 , TPAGOODSIMAGE TP
			 , TGOODSINFOIMAGE TI
		 WHERE TG.GOODS_CODE    = TP.GOODS_CODE
		   AND TP.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
		   AND TG.GOODS_CODE    = TI.GOODS_CODE(+)
		   AND TI.INFO_IMAGE_TYPE(+) = '200'
		   AND ( TG.MODIFY_DATE &gt; TP.LAST_SYNC_DATE OR TI.MODIFY_DATE &gt; TP.LAST_SYNC_DATE )
		   AND ( TG.MODIFY_DATE  &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - #{conditionDay, jdbcType=NUMERIC} 
		      OR TI.MODIFY_DATE &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - #{conditionDay, jdbcType=NUMERIC} )
		<if test='goodsCode != null and goodsCode != ""'>
			AND TP.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		</if>

	 UNION ALL
		SELECT TG.GOODS_CODE
			 , TP.PA_GROUP_CODE
			 , NVL(TG.IMAGE_C, TG.IMAGE_G) AS IMAGE_P
			 , NVL(TG.IMAGE_AT, TG.IMAGE_AG) AS IMAGE_AP
			 , NVL(TG.IMAGE_BT, TG.IMAGE_BG) AS IMAGE_BP
			 , TG.IMAGE_URL
		  FROM TGOODSIMAGE   TG
			 , TPAGOODSIMAGE TP
		 WHERE TG.GOODS_CODE    = TP.GOODS_CODE
		   AND TP.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
		   AND TP.IMAGE_P LIKE '%info%'
		   AND TP.LAST_SYNC_DATE &gt; SYSDATE - 60
		   AND NOT EXISTS (SELECT 1
							 FROM TGOODSINFOIMAGE TI
							WHERE TI.INFO_IMAGE_TYPE = '200'
							  AND TI.GOODS_CODE = TP.GOODS_CODE)
		<if test='goodsCode != null and goodsCode != ""'>
			AND TP.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		</if>
    </select>
    
    <select id="selectCurImageInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.PaGoodsImage">
        SELECT /* pacommon.xml : pacommon.common.selectCurImageInfoList */ 
               TG.GOODS_CODE
			 , TP.PA_GROUP_CODE
			 , NVL(TG.IMAGE_C, TG.IMAGE_G)   AS IMAGE_P
			 , NVL(TG.IMAGE_AT, TG.IMAGE_AG) AS IMAGE_AP
			 , NVL(TG.IMAGE_BT, TG.IMAGE_BG) AS IMAGE_BP
			 , NVL(TG.IMAGE_CT, TG.IMAGE_CG) AS IMAGE_CP
			 , NVL(TG.IMAGE_DT, TG.IMAGE_DG) AS IMAGE_DP
			 , TG.IMAGE_URL
			 , TP.PA_GROUP_CODE
		  FROM TGOODSIMAGE   TG
			 , TPAGOODSIMAGE TP
		 WHERE TG.GOODS_CODE    = TP.GOODS_CODE
		   AND TP.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
		   AND TG.MODIFY_DATE   &gt; TP.LAST_SYNC_DATE
		   AND TG.MODIFY_DATE   &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - #{conditionDay, jdbcType=NUMERIC}
		   <if test='goodsCode != null and goodsCode != ""'>
           AND TG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
           </if>
    </select>
    
	<select id="selectCurPriceInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaGoodsPriceVO">
        SELECT /* pacommon.xml : pacommon.common.selectCurPriceInfoList */ 
			   GP.GOODS_CODE
			 , GT.PA_CODE
			 , GP.APPLY_DATE
			 , GP.SALE_PRICE
			 , NVL(FUN_GET_PA_GOODS_PRICE(GP.GOODS_CODE, GP.APPLY_DATE, DECODE(TC.CODE_GROUP, '01', '2', '05', '4', '0')), 0) AS BE_SALE_PRICE
			 , CASE WHEN GT.PA_CODE = #{comparePaCode, jdbcType=VARCHAR} THEN ROUND((GP.SALE_PRICE-GP.ARS_DC_AMT) * ((100-TC.REMARK)/ 100))
					ELSE ROUND((GP.SALE_PRICE-GP.ARS_DC_AMT) * ((100-TC.REMARK1)/ 100))
					END AS SUPPLY_PRICE
			 , DECODE(GT.PA_CODE, #{comparePaCode, jdbcType=VARCHAR}, TC.REMARK, TC.REMARK1) AS COMMISION
			 , GP.ARS_DC_AMT AS DC_AMT
			 , DECODE( GP.SALE_PRICE, 0, 0, TRUNC((GP.SALE_PRICE-GP.BUY_PRICE) / GP.SALE_PRICE*100))  AS MARGIN_RATE
			 , ( SELECT CASE WHEN COUNT(1) &gt; 0 THEN 'Y' ELSE 'N' END
				   FROM TPAGOODSEVENT SD
				  WHERE SD.GOODS_CODE = TG.GOODS_CODE
					AND SD.USE_YN     = '1'
					AND SD.PA_GROUP_CODE = GT.PA_GROUP_CODE
					AND SYSDATE       &gt;= SD.START_DATE
					AND SYSDATE       &lt;  SD.END_DATE
			   ) AS EVENT_YN
			 , GP.PRICE_SEQ
			 , GP.LUMP_SUM_DC_AMT
			 , GP.LUMP_SUM_OWN_DC_AMT
			 , GP.LUMP_SUM_ENTP_DC_AMT
			 , TG.GOODS_CODE AS PA_GOODS_CODE
			 , TG.SOURCING_MEDIA
			 , TG.MD_KIND
			 , GI.MOBILE_ETV_YN
			 , TG.TAX_YN
		  FROM TGOODS TG
		     , TGOODSADDINFO GI
			 , TGOODSPRICE GP
			 , TCODE TC
			 , TCODE TC2
			 , TPAGOODSTARGET GT
		 WHERE TG.GOODS_CODE = GP.GOODS_CODE
		   AND TG.GOODS_CODE = GI.GOODS_CODE
		   AND GP.ROWID = ( SELECT /*+INDEX_DESC (P2 PK_TGOODSPRICE)*/
								   ROWID
							  FROM TGOODSPRICE P2
							 WHERE P2.GOODS_CODE  = GP.GOODS_CODE
							   AND P2.APPLY_DATE &lt;= SYSDATE
							   AND ROWNUM = 1
						  )
		   AND TC2.CODE_LGROUP = 'O501'
		   AND TC2.CODE_GROUP = GT.PA_GROUP_CODE
		   AND TC2.CODE_MGROUP = GT.PA_CODE
		   AND TG.GOODS_CODE = GT.GOODS_CODE
		   AND GT.PA_GOODS_CODE IS NOT NULL
		   AND GT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
		   AND TG.SALE_GB = '00'
		   AND TC.CODE_LGROUP = #{feeCode, jdbcType=VARCHAR}
		   AND TC.CODE_GROUP  = GT.PA_GROUP_CODE
		   AND TC.ROWID = ( SELECT /*+ INDEX_DESC (TD IDX_TCODE_02)*/
								   TD.ROWID
							  FROM TCODE TD
							 WHERE TD.CODE_LGROUP = TC.CODE_LGROUP
							   AND TO_DATE(TD.CODE_MGROUP, 'YYYYMMDD') &lt; SYSDATE
							   AND ROWNUM =1
						  )
		   AND NOT EXISTS ( SELECT 'X'
							  FROM TPAGOODSPRICE P
							 WHERE P.GOODS_CODE = GP.GOODS_CODE
							   AND P.APPLY_DATE = GP.APPLY_DATE
							   AND P.PA_CODE    = GT.PA_CODE
							   AND P.SALE_PRICE = GP.SALE_PRICE
						  )
		<if test='goodsCode != null and goodsCode != ""'>
			AND TG.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		</if>
    </select>
    
    <select id="selectMinMarginPrice" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectMinMarginPrice */ 
			   CASE WHEN #{paGroupCode, jdbcType=VARCHAR} = '10' AND #{taxYn, jdbcType=VARCHAR} = '0' AND A.REMARK2 IS NOT NULL
	                 THEN A.REMARK2
	                ELSE DECODE(#{paCode, jdbcType=VARCHAR}, #{comparePaCode, jdbcType=VARCHAR}, A.REMARK, A.REMARK1)
	           END AS MIN_MARGIN
			 , DECODE(#{paCode, jdbcType=VARCHAR}, #{comparePaCode, jdbcType=VARCHAR}, B.REMARK, B.REMARK1) AS MIN_SALE_PRICE
			 , FUN_GETCONFIG('PA_EVENT_LIMIT_MARGIN') AS EVENT_MIN_MARGIN
		  FROM TCODE A
			 , TCODE B
		 WHERE A.CODE_LGROUP = 'O582'
		   AND A.CODE_MGROUP = #{minMarginCode, jdbcType=VARCHAR}
		   AND B.CODE_LGROUP = 'O582'
		   AND B.CODE_MGROUP = #{minPriceCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectApplyCnCostSeq" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectApplyCnCostSeq */ 
			   NVL((SELECT /*+ INDEX_DESC (A PK_TPACUSTCNSHIPCOST)*/
						   A.CN_COST_SEQ
					  FROM TPACUSTCNSHIPCOST A
					 WHERE A.ENTP_CODE       = #{entpCode, jdbcType=VARCHAR}
					   AND A.ENTP_MAN_SEQ    = #{entpManSeq, jdbcType=VARCHAR}
					   AND A.PA_CODE         = #{paCode, jdbcType=VARCHAR}
					   AND A.TRANS_TARGET_YN = '1'
					   AND rownum = 1 ), 'X') AS APPLY_CN_COST_SEQ
		  FROM DUAL
    </select>
    
    <select id="selectMaxOrdCost" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectMaxOrdCost */ 
			   NVL(( SELECT X.SHIP_COST_CODE
					   FROM (SELECT A.ENTP_CODE
								  , A.SHIP_COST_CODE
								  , A.ORD_COST_AMT
								  , A.SHIP_COST_BASE_AMT
								  , A.MODIFY_DATE
							   FROM TPACUSTCNSHIPCOST A
							  WHERE A.ENTP_CODE       = #{entpCode, jdbcType=VARCHAR}
								AND A.ENTP_MAN_SEQ    = #{entpManSeq, jdbcType=VARCHAR}
								AND A.PA_CODE         = #{paCode, jdbcType=VARCHAR}
								AND A.TRANS_TARGET_YN = '1'
								AND A.ORD_COST_AMT    = (SELECT MAX(B.ORD_COST_AMT)
														   FROM TPACUSTCNSHIPCOST AA
														      , TSHIPCOSTDT B
														  WHERE AA.ENTP_CODE      = A.ENTP_CODE
															AND AA.ENTP_MAN_SEQ   = A.ENTP_MAN_SEQ
															AND AA.PA_CODE 		  = A.PA_CODE 
															AND AA.ENTP_CODE      = B.ENTP_CODE
															AND AA.SHIP_COST_CODE = B.SHIP_COST_CODE
															AND B.CUST_AREA_GB    = '10'
															AND B.APPLY_DATE   &lt; SYSDATE
															AND B.ROWID = ( SELECT /*+ INDEX_DESC(BB PK_TSHIPCOSTDT) */
																				   ROWID
																			  FROM TSHIPCOSTDT BB
																			 WHERE BB.ENTP_CODE  	    = B.ENTP_CODE	
																			   AND BB.SHIP_COST_CODE    = B.SHIP_COST_CODE
																			   AND BB.APPLY_DATE     &lt; SYSDATE 
																			   AND BB.CUST_AREA_GB      = '10'
																			   AND ROWNUM = 1 )
															)
						   ORDER BY A.SHIP_COST_BASE_AMT DESC, A.MODIFY_DATE DESC
							) X
					  WHERE ROWNUM = 1), 'X') AS APPLY_SHIP_COST
				FROM DUAL
    </select>
    
    <select id="selectCnCostSeq" resultType="String">
        SELECT /* pacommon.xml : pacommon.common.selectCnCostSeq */
               /*+ INDEX_DESC (A PK_TPACUSTCNSHIPCOST)*/
			   A.CN_COST_SEQ AS APPLY_CN_COST_SEQ
		  FROM TPACUSTCNSHIPCOST A
		 WHERE A.ENTP_CODE       = #{entpCode, jdbcType=VARCHAR}
		   AND A.ENTP_MAN_SEQ    = #{entpManSeq, jdbcType=VARCHAR}
		   AND A.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND A.SHIP_COST_CODE  = #{applyShipCost, jdbcType=VARCHAR}
		   AND A.TRANS_TARGET_YN = '1'
		   AND rownum = 1
    </select>
	
	<update id="updateTpaGoodsImage" parameterType="com.cware.netshopping.domain.model.PaGoodsImage">
        UPDATE /* pacommon.xml : pacommon.common.updateTpaGoodsImage */
               TPAGOODSIMAGE PI
           SET PI.IMAGE_P         = #{imageP,   jdbcType=VARCHAR}
             , PI.IMAGE_AP        = #{imageAp,  jdbcType=VARCHAR}
             , PI.IMAGE_BP        = #{imageBp,  jdbcType=VARCHAR}
             , PI.IMAGE_CP        = #{imageCp,  jdbcType=VARCHAR}
             , PI.IMAGE_DP        = #{imageDp,  jdbcType=VARCHAR}
             , PI.IMAGE_URL       = #{imageUrl, jdbcType=VARCHAR}
             , PI.TRANS_TARGET_YN = '1'
             , PI.LAST_SYNC_DATE  = #{modifyDate,  jdbcType=TIMESTAMP}
             , PI.MODIFY_DATE     = #{modifyDate,  jdbcType=TIMESTAMP}
             , PI.MODIFY_ID       = #{modifyId,    jdbcType=VARCHAR}
         WHERE PI.GOODS_CODE      = #{goodsCode,   jdbcType=VARCHAR}
           AND PI.PA_GROUP_CODE   = #{paGroupCode, jdbcType=VARCHAR}
    </update>
	
	<insert id="insertTpaGoodsPrice" parameterType="com.cware.netshopping.domain.PaGoodsPriceVO" >
		INSERT INTO TPAGOODSPRICE ( /* pacommon.xml : pacommon.common.insertTpaGoodsPrice */
	        GOODS_CODE
		  , PA_CODE
		  , APPLY_DATE
		  , SALE_PRICE
		  , SUPPLY_PRICE
		  , COMMISION
		  , DC_AMT
		  , TRANS_ID
		  , TRANS_DATE
		  , INSERT_ID
		  , INSERT_DATE
		  , MODIFY_ID
		  , MODIFY_DATE
		  , PRICE_SEQ
		  , LUMP_SUM_DC_AMT
		  , LUMP_SUM_OWN_DC_AMT
		  , LUMP_SUM_ENTP_DC_AMT
			)
	VALUES (
	 	    #{goodsCode, jdbcType=VARCHAR}
		  , #{paCode, jdbcType=VARCHAR}
		  , #{applyDate, jdbcType=TIMESTAMP}
		  , #{salePrice, jdbcType=VARCHAR}
		  , #{supplyPrice, jdbcType=VARCHAR}
		  , #{commision, jdbcType=VARCHAR}
		  , #{dcAmt, jdbcType=VARCHAR}		  
		  , #{transId, jdbcType=VARCHAR}
		  , #{transDate, jdbcType=VARCHAR}		  
		  , #{modifyId, jdbcType=VARCHAR}
		  , #{modifyDate, jdbcType=VARCHAR}
		  , #{modifyId, jdbcType=VARCHAR}
		  , #{modifyDate, jdbcType=VARCHAR}
		  , #{priceSeq, jdbcType=VARCHAR}
		  , #{lumpSumDcAmt, jdbcType=VARCHAR}
		  , #{lumpSumOwnDcAmt, jdbcType=VARCHAR}
		  , #{lumpSumEntpDcAmt, jdbcType=VARCHAR}
		   )
    </insert>
	
	<update id="update11stStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.update11stStopSale */
               TPA11STGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
	<update id="updateEbayStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateEbayStopSale */
               TPAGMKTGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
	<update id="updateNaverStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateNaverStopSale */
               TPANAVERGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
	<update id="updateCopnStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateCopnStopSale */
               TPACOPNGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
	<update id="updateWempStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateWempStopSale */
               TPAWEMPGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
	<update id="updateIntpStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateIntpStopSale */
               TPAINTPGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
	<update id="updateLtonStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateLtonStopSale */
               TPALTONGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
			 <if test='paStatus != null and paStatus != ""'>
			 , CG.RETURN_NOTE     = #{note, jdbcType=VARCHAR}
			 , CG.PA_STATUS       = #{paStatus, jdbcType=VARCHAR}
			 </if>
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
    <update id="updateTpaLtonGoodsQty" parameterType="com.cware.netshopping.domain.PaLtonGoodsVO">
        UPDATE /* pacommon.xml : pacommon.common.updateTpaLtonGoodsQty */
               TPALTONGOODS LG
		   SET LG.TRANS_ORDER_ABLE_QTY = #{newTransQty, jdbcType=NUMERIC}
		   <if test='transSaleYn != null and transSaleYn != ""'>
		   	, LG.TRANS_SALE_YN = #{transSaleYn, jdbcType=VARCHAR}
		   </if>
			 , LG.MODIFY_ID   = #{modifyId, jdbcType=VARCHAR}
			 , LG.MODIFY_DATE = #{modifyDate, jdbcType=TIMESTAMP}
		 WHERE LG.GOODS_CODE  = #{goodsCode, jdbcType=VARCHAR}
		   AND LG.PA_CODE     = #{paCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateTpaLtonGoodsDtQty" parameterType="com.cware.netshopping.domain.PaLtonGoodsdtMappingVO">
        UPDATE /* pacommon.xml : pacommon.common.updateTpaLtonGoodsDtQty */
               TPALTONGOODSDTMAPPING LM
		   SET LM.TRANS_ORDER_ABLE_QTY = #{newTransQty, jdbcType=NUMERIC}
		   <if test='transSaleYn != null and transSaleYn != ""'>
		   	, LM.TRANS_SALE_YN = #{transSaleYn, jdbcType=VARCHAR}
		   </if>
			 , LM.TRANS_STOCK_YN = #{transStockYn, jdbcType=VARCHAR}
			 , LM.MODIFY_ID		 = #{modifyId,     jdbcType=VARCHAR}
			 , LM.MODIFY_DATE	 = #{modifyDate,   jdbcType=TIMESTAMP}
		 WHERE LM.GOODS_CODE	 = #{goodsCode,    jdbcType=VARCHAR}
		   AND LM.PA_CODE		 = #{paCode,       jdbcType=VARCHAR}
		   AND LM.GOODSDT_CODE	 = #{goodsdtCode,  jdbcType=VARCHAR}
		   AND LM.GOODSDT_SEQ	 = #{goodsdtSeq,   jdbcType=VARCHAR}
    </update>
    
	<insert id="insertSaleNoGoods" parameterType="hashMap" >
		INSERT INTO TPASALENOGOODS ( /* pacommon.xml : pacommon.common.insertSaleNoGoods */
			PA_GROUP_CODE
		  , PA_CODE
		  , GOODS_CODE
		  , SEQ_NO
		  , PA_GOODS_CODE
		  , PA_SALE_GB
		  , NOTE
		  , INSERT_ID
		  , INSERT_DATE )
           SELECT #{paGroupCode, jdbcType=VARCHAR}
                , #{paCode, jdbcType=VARCHAR}
                , #{goodsCode, jdbcType=VARCHAR}
                , (SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(SN.SEQ_NO)) + 1),5,'0'),'00001')
                     FROM TPASALENOGOODS SN
                    WHERE SN.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
                      AND SN.PA_CODE       = #{paCode, jdbcType=VARCHAR}
                      AND SN.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR})
                , #{paGoodsCode, jdbcType=VARCHAR}
                , '30'
                , #{note, jdbcType=VARCHAR}
                , #{userId, jdbcType=VARCHAR}
                , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             FROM DUAL
    </insert>
	
	<update id="updatePagoodstargetAutoYn" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updatePagoodstargetAutoYn */
               TPAGOODSTARGET GT
           SET GT.AUTO_YN 		= '0'
             , GT.MODIFY_ID 	= #{userId, jdbcType=VARCHAR}
             , GT.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE GT.GOODS_CODE    =  #{goodsCode,  jdbcType=VARCHAR}
           AND GT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
	
	<insert id="insertPagoodsAuthYnLog" parameterType="hashMap" >
		INSERT INTO TPAGOODSAUTHYNLOG ( /* pacommon.xml : pacommon.common.insertPagoodsAuthYnLog */
			PA_GROUP_CODE
		  , PA_CODE
		  , GOODS_CODE
		  , SEQ_NO
		  , AUTO_YN
		  , INSERT_ID
		  , INSERT_DATE
		  , NOTE )
           SELECT #{paGroupCode, jdbcType=VARCHAR}
                 ,#{paCode, jdbcType=VARCHAR}
                 ,#{goodsCode, jdbcType=VARCHAR}
                 ,(SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(AL.SEQ_NO)) + 1), 3, '0'), '001')
                     FROM TPAGOODSAUTHYNLOG AL
                    WHERE AL.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
                      AND AL.PA_CODE       = #{paCode, 	  	jdbcType=VARCHAR}
                      AND AL.GOODS_CODE    = #{goodsCode, 	jdbcType=VARCHAR})
                 ,'0'
                 , #{userId, jdbcType=VARCHAR}
                 , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
                 , #{note, jdbcType=VARCHAR}
             FROM DUAL
    </insert>
	
	<select id="selectCurShipCostInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaCustShipCostVO">
        SELECT /* pacommon.xml : pacommon.common.selectCurShipCostInfoList */ 
			   DISTINCT X.PROC_GB
			 , X.ENTP_CODE
			 , X.SHIP_COST_CODE
			 , X.PA_CODE
			 , X.SHIP_COST_BASE_AMT
			 , CASE WHEN SUBSTR(X.SHIP_COST_CODE,0,2) = 'FR' THEN 0
					ELSE X.ORD_COST END AS ORD_COST
			 , X.RETURN_COST
			 , X.CHANGE_COST 
			 , X.ISLAND_COST
			 , X.JEJU_COST
		  FROM ( SELECT /*+ LEADING(CC CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3) INDEX(CC PK_TPACUSTSHIPCOST)  */  
						'U' AS PROC_GB
					  , CC.ENTP_CODE
					  , CM.SHIP_COST_CODE
					  , CC.PA_CODE
					  , CM.SHIP_COST_BASE_AMT
					  , CD1.ORD_COST_AMT            AS ORD_COST
					  , CD1.RET_COST_AMT            AS RETURN_COST
					  , CD1.EXCH_COST_AMT           AS CHANGE_COST
					  , CD2.ORD_COST_AMT            AS ISLAND_COST
					  , CD3.ORD_COST_AMT            AS JEJU_COST
				   FROM TSHIPCOSTM      CM
					  , TSHIPCOSTDT     CD1
					  , TSHIPCOSTDT     CD2
					  , TSHIPCOSTDT     CD3
					  , TPACUSTSHIPCOST CC
					  , TCODE TC
				   WHERE CM.ENTP_CODE      = CC.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CC.SHIP_COST_CODE
					 AND TC.CODE_LGROUP	   = 'O501'
                     AND TC.CODE_GROUP	   = #{paGroupCode, jdbcType=VARCHAR}
                     AND CC.PA_CODE		   = TC.CODE_MGROUP
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND CDT.APPLY_DATE     &lt; SYSDATE
										  AND CDT.APPLY_DATE     &gt; CC.LAST_SYNC_DATE
										  AND ROWNUM = 1 )
			   UNION ALL
			   <if test='paGroupCode == "01"'>
				  SELECT /*+ LEADING(GD PG CG CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3)  */
				  		 distinct 'I' AS PROC_GB
					   , CM.ENTP_CODE
					   , GD.SHIP_COST_CODE
					   , ST.PA_CODE
					   , CM.SHIP_COST_BASE_AMT
					   , CD1.ORD_COST_AMT        AS ORD_COST
					   , CD1.RET_COST_AMT        AS RETURN_COST
					   , CD1.EXCH_COST_AMT       AS CHANGE_COST
					   , CD2.ORD_COST_AMT        AS ISLAND_COST
					   , CD3.ORD_COST_AMT        AS JEJU_COST
					FROM TGOODS       GD
					   , TPAPRODUCT   PG
					   , TPA11STGOODS ST
					   , TSHIPCOSTM   CM
					   , TSHIPCOSTDT  CD1
					   , TSHIPCOSTDT  CD2
					   , TSHIPCOSTDT  CD3
				   WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					 AND PG.GOODS_CODE     = ST.GOODS_CODE
					 AND CM.ENTP_CODE      = DECODE(GD.DELY_TYPE,'10','100001',GD.ENTP_CODE)
					 AND CM.SHIP_COST_CODE = GD.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND APPLY_DATE         &lt; SYSDATE
										  AND ROWNUM = 1 )
					 AND GD.MODIFY_DATE >= TRUNC(SYSDATE) - 2
					 AND NOT EXISTS ( SELECT '1'
										FROM TPACUSTSHIPCOST PCH
									   WHERE PCH.PA_CODE        = ST.PA_CODE
										 AND PCH.ENTP_CODE      = CM.ENTP_CODE
										 AND PCH.SHIP_COST_CODE = CM.SHIP_COST_CODE )
			   </if>
			   <if test='paGroupCode == "02"'>
				  SELECT /*+ LEADING(GD PG CG CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3)  */
				  		 distinct 'I' AS PROC_GB
					   , CM.ENTP_CODE
					   , GD.SHIP_COST_CODE
					   , GG.PA_CODE
					   , CM.SHIP_COST_BASE_AMT
					   , CD1.ORD_COST_AMT        AS ORD_COST
					   , CD1.RET_COST_AMT        AS RETURN_COST
					   , CD1.EXCH_COST_AMT       AS CHANGE_COST
					   , CD2.ORD_COST_AMT        AS ISLAND_COST
					   , CD3.ORD_COST_AMT        AS JEJU_COST
					FROM TGOODS       GD
					   , TPAGOODS     PG
					   , TPAGMKTGOODS GG
					   , TSHIPCOSTM   CM
					   , TSHIPCOSTDT  CD1
					   , TSHIPCOSTDT  CD2
					   , TSHIPCOSTDT  CD3
				   WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					 AND PG.GOODS_CODE     = GG.GOODS_CODE
					 AND CM.ENTP_CODE      = DECODE(GD.DELY_TYPE,'10','100001',GD.ENTP_CODE)
					 AND CM.SHIP_COST_CODE = GD.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND APPLY_DATE         &lt; SYSDATE
										  AND ROWNUM = 1 )
					 AND GD.MODIFY_DATE >= TRUNC(SYSDATE) - 2
					 AND NOT EXISTS ( SELECT '1'
										FROM TPACUSTSHIPCOST PCH
									   WHERE PCH.PA_CODE        = GG.PA_CODE
										 AND PCH.ENTP_CODE      = CM.ENTP_CODE
										 AND PCH.SHIP_COST_CODE = CM.SHIP_COST_CODE )
			   </if>
			   <if test='paGroupCode == "04"'>
				  SELECT /*+ LEADING(GD PG CG CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3)  */
				  		 distinct 'I' AS PROC_GB
					   , CM.ENTP_CODE
					   , GD.SHIP_COST_CODE
					   , NG.PA_CODE
					   , CM.SHIP_COST_BASE_AMT
					   , CD1.ORD_COST_AMT        AS ORD_COST
					   , CD1.RET_COST_AMT        AS RETURN_COST
					   , CD1.EXCH_COST_AMT       AS CHANGE_COST
					   , CD2.ORD_COST_AMT        AS ISLAND_COST
					   , CD3.ORD_COST_AMT        AS JEJU_COST
					FROM TGOODS       GD
					   , TPAGOODS     PG
					   , TPANAVERGOODS NG
					   , TSHIPCOSTM   CM
					   , TSHIPCOSTDT  CD1
					   , TSHIPCOSTDT  CD2
					   , TSHIPCOSTDT  CD3
				   WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					 AND PG.GOODS_CODE     = NG.GOODS_CODE
					 AND CM.ENTP_CODE      = DECODE(GD.DELY_TYPE,'10','100001',GD.ENTP_CODE)
					 AND CM.SHIP_COST_CODE = GD.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND APPLY_DATE         &lt; SYSDATE
										  AND ROWNUM = 1 )
					 AND GD.MODIFY_DATE >= TRUNC(SYSDATE) - 2
					 AND NOT EXISTS ( SELECT '1'
										FROM TPACUSTSHIPCOST PCH
									   WHERE PCH.PA_CODE        = NG.PA_CODE
										 AND PCH.ENTP_CODE      = CM.ENTP_CODE
										 AND PCH.SHIP_COST_CODE = CM.SHIP_COST_CODE )
			   </if>
			   <if test='paGroupCode == "06"'>
				  SELECT /*+ LEADING(GD PG CG CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3)  */
				  		 distinct 'I' AS PROC_GB
					   , CM.ENTP_CODE
					   , GD.SHIP_COST_CODE
					   , WG.PA_CODE
					   , CM.SHIP_COST_BASE_AMT
					   , CD1.ORD_COST_AMT        AS ORD_COST
					   , CD1.RET_COST_AMT        AS RETURN_COST
					   , CD1.EXCH_COST_AMT       AS CHANGE_COST
					   , CD2.ORD_COST_AMT        AS ISLAND_COST
					   , CD3.ORD_COST_AMT        AS JEJU_COST
					FROM TGOODS       GD
					   , TPAGOODS     PG
					   , TPAWEMPGOODS WG
					   , TSHIPCOSTM   CM
					   , TSHIPCOSTDT  CD1
					   , TSHIPCOSTDT  CD2
					   , TSHIPCOSTDT  CD3
				   WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					 AND PG.GOODS_CODE     = WG.GOODS_CODE
					 AND CM.ENTP_CODE      = DECODE(GD.DELY_TYPE,'10','100001',GD.ENTP_CODE)
					 AND CM.SHIP_COST_CODE = GD.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND APPLY_DATE         &lt; SYSDATE
										  AND ROWNUM = 1 )
					 AND GD.MODIFY_DATE >= TRUNC(SYSDATE) - 2
					 AND NOT EXISTS ( SELECT '1'
										FROM TPACUSTSHIPCOST PCH
									   WHERE PCH.PA_CODE        = WG.PA_CODE
										 AND PCH.ENTP_CODE      = CM.ENTP_CODE
										 AND PCH.SHIP_COST_CODE = CM.SHIP_COST_CODE )
			   </if>
			   <if test='paGroupCode == "07"'>
				  SELECT /*+ LEADING(GD PG CG CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3)  */
				  		 distinct 'I' AS PROC_GB
					   , CM.ENTP_CODE
					   , GD.SHIP_COST_CODE
					   , IG.PA_CODE
					   , CM.SHIP_COST_BASE_AMT
					   , CD1.ORD_COST_AMT        AS ORD_COST
					   , CD1.RET_COST_AMT        AS RETURN_COST
					   , CD1.EXCH_COST_AMT       AS CHANGE_COST
					   , CD2.ORD_COST_AMT        AS ISLAND_COST
					   , CD3.ORD_COST_AMT        AS JEJU_COST
					FROM TGOODS       GD
					   , TPAGOODS     PG
					   , TPAINTPGOODS IG
					   , TSHIPCOSTM   CM
					   , TSHIPCOSTDT  CD1
					   , TSHIPCOSTDT  CD2
					   , TSHIPCOSTDT  CD3
				   WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					 AND PG.GOODS_CODE     = IG.GOODS_CODE
					 AND CM.ENTP_CODE      = DECODE(GD.DELY_TYPE,'10','100001',GD.ENTP_CODE)
					 AND CM.SHIP_COST_CODE = GD.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND APPLY_DATE         &lt; SYSDATE
										  AND ROWNUM = 1 )
					 AND GD.MODIFY_DATE &gt;= TRUNC(SYSDATE) - 2
					 AND NOT EXISTS ( SELECT '1'
										FROM TPACUSTSHIPCOST PCH
									   WHERE PCH.PA_CODE        = IG.PA_CODE
										 AND PCH.ENTP_CODE      = CM.ENTP_CODE
										 AND PCH.SHIP_COST_CODE = CM.SHIP_COST_CODE )
			   </if>
			   <if test='paGroupCode == "08"'>
				  SELECT /*+ LEADING(GD PG CG CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3)  */
				  		 distinct 'I' AS PROC_GB
					   , CM.ENTP_CODE
					   , GD.SHIP_COST_CODE
					   , LG.PA_CODE
					   , CM.SHIP_COST_BASE_AMT
					   , CD1.ORD_COST_AMT        AS ORD_COST
					   , CD1.RET_COST_AMT        AS RETURN_COST
					   , CD1.EXCH_COST_AMT       AS CHANGE_COST
					   , CD2.ORD_COST_AMT        AS ISLAND_COST
					   , CD3.ORD_COST_AMT        AS JEJU_COST
					FROM TGOODS       GD
					   , TPAGOODS     PG
					   , TPALTONGOODS LG
					   , TSHIPCOSTM   CM
					   , TSHIPCOSTDT  CD1
					   , TSHIPCOSTDT  CD2
					   , TSHIPCOSTDT  CD3
				   WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					 AND PG.GOODS_CODE     = LG.GOODS_CODE
					 AND CM.ENTP_CODE      = DECODE(GD.DELY_TYPE, '10', '100001', GD.ENTP_CODE)
					 AND CM.SHIP_COST_CODE = GD.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND APPLY_DATE         &lt; SYSDATE
										  AND ROWNUM = 1 )
					 AND GD.MODIFY_DATE >= TRUNC(SYSDATE) - 2
					 AND NOT EXISTS ( SELECT '1'
										FROM TPACUSTSHIPCOST PCH
									   WHERE PCH.PA_CODE        = LG.PA_CODE
										 AND PCH.ENTP_CODE      = CM.ENTP_CODE
										 AND PCH.SHIP_COST_CODE = CM.SHIP_COST_CODE )
			   </if>
			   <if test='paGroupCode == "10"'>
				  SELECT /*+ LEADING(GD PG CG CM CD1 CD2 CD3) USE_NL(CM CD1 CD2 CD3)  */
				  		 distinct 'I' AS PROC_GB
					   , CM.ENTP_CODE
					   , GD.SHIP_COST_CODE
					   , SG.PA_CODE
					   , CM.SHIP_COST_BASE_AMT
					   , CD1.ORD_COST_AMT        AS ORD_COST
					   , CD1.RET_COST_AMT        AS RETURN_COST
					   , CD1.EXCH_COST_AMT       AS CHANGE_COST
					   , CD2.ORD_COST_AMT        AS ISLAND_COST
					   , CD3.ORD_COST_AMT        AS JEJU_COST
					FROM TGOODS       GD
					   , TPAGOODS     PG
					   , TPASSGGOODS  SG
					   , TSHIPCOSTM   CM
					   , TSHIPCOSTDT  CD1
					   , TSHIPCOSTDT  CD2
					   , TSHIPCOSTDT  CD3
				   WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					 AND PG.GOODS_CODE     = SG.GOODS_CODE
					 AND CM.ENTP_CODE      = DECODE(GD.DELY_TYPE, '10', '100001', GD.ENTP_CODE)
					 AND CM.SHIP_COST_CODE = GD.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD1.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD1.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD2.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD2.SHIP_COST_CODE
					 AND CM.ENTP_CODE      = CD3.ENTP_CODE
					 AND CM.SHIP_COST_CODE = CD3.SHIP_COST_CODE
					 AND CD1.CUST_AREA_GB = '10'
					 AND CD2.CUST_AREA_GB = '20'
					 AND CD3.CUST_AREA_GB = '30'
					 AND CD1.APPLY_DATE = CD2.APPLY_DATE
					 AND CD1.APPLY_DATE = CD3.APPLY_DATE
					 AND CD1.ROWID = ( SELECT /*+INDEX_DESC (CDT PK_TCUSTSHIPCOSTDT)*/
											  ROWID
										 FROM TSHIPCOSTDT CDT
										WHERE CDT.ENTP_CODE      = CM.ENTP_CODE
										  AND CDT.SHIP_COST_CODE = CM.SHIP_COST_CODE
										  AND CDT.CUST_AREA_GB   = '10'
										  AND APPLY_DATE         &lt; SYSDATE
										  AND ROWNUM = 1 )
					 AND GD.MODIFY_DATE >= TRUNC(SYSDATE) - 2
					 AND NOT EXISTS ( SELECT '1'
										FROM TPACUSTSHIPCOST PCH
									   WHERE PCH.PA_CODE        = SG.PA_CODE
										 AND PCH.ENTP_CODE      = CM.ENTP_CODE
										 AND PCH.SHIP_COST_CODE = CM.SHIP_COST_CODE )
			   </if>
										 ) X
    </select>
    
    <select id="selectCurTmonShipCostInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaCustShipCostVO">
        SELECT /* pacommon.xml : pacommon.common.selectCurTmonShipCostInfoList */ 
			   distinct PA.PA_CODE
			 , CM.ENTP_CODE
			 , DECODE(G.INSTALL_YN, '1', 'DP04', DECODE(AI.ORDER_CREATE_YN, '1', 'DP05', 'DP07')) AS PRODUCT_TYPE
			 , DECODE(G.DELY_TYPE, '10', '003', G.SHIP_MAN_SEQ) AS SHIP_MAN_SEQ
			 , DECODE(G.DELY_TYPE, '10', '002', G.RETURN_MAN_SEQ) AS RETURN_MAN_SEQ
			 , G.SHIP_COST_CODE
			 , CD1.APPLY_DATE
			 , NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = G.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0) AS NO_SHIP_ISLAND
			 , SUBSTR(CM.SHIP_COST_BASE_AMT, 0, 7) AS SHIP_COST_BASE_AMT
			 , CD1.ORD_COST_AMT  AS ORD_COST
			 , CD1.RET_COST_AMT AS RETURN_COST
			 , CD1.EXCH_COST_AMT AS CHANGE_COST
			 , CD2.ORD_COST_AMT AS ISLAND_COST
			 , CD3.ORD_COST_AMT AS JEJU_COST
		  FROM TPATMONGOODS PA
			 , TGOODS G
			 , TGOODSADDINFO AI
			 , TSHIPCOSTM  CM
			 , TSHIPCOSTDT CD1
			 , TSHIPCOSTDT CD2
			 , TSHIPCOSTDT CD3
		 WHERE PA.GOODS_CODE = G.GOODS_CODE
		   AND G.GOODS_CODE = AI.GOODS_CODE
		   AND DECODE(G.DELY_TYPE, '10', '100001', G.ENTP_CODE) = CM.ENTP_CODE
		   AND G.SHIP_COST_CODE = CM.SHIP_COST_CODE
		   AND CM.ENTP_CODE   = CD1.ENTP_CODE
		   AND CM.ENTP_CODE   = CD2.ENTP_CODE
		   AND CM.ENTP_CODE   = CD3.ENTP_CODE
		   AND CM.SHIP_COST_CODE  = CD1.SHIP_COST_CODE
		   AND CM.SHIP_COST_CODE  = CD2.SHIP_COST_CODE
		   AND CM.SHIP_COST_CODE  = CD3.SHIP_COST_CODE
		   AND CD1.CUST_AREA_GB = '10'
		   AND CD2.CUST_AREA_GB = '20'
		   AND CD3.CUST_AREA_GB = '30'
		   AND CD1.APPLY_DATE   = CD2.APPLY_DATE
		   AND CD1.APPLY_DATE   = CD3.APPLY_DATE
		   AND CD1.APPLY_DATE   = ( SELECT MAX(CD.APPLY_DATE)
									  FROM TSHIPCOSTDT CD
									 WHERE CD.ENTP_CODE      = CM.ENTP_CODE
									   AND CD.SHIP_COST_CODE = CM.SHIP_COST_CODE
									   AND SYSDATE        &gt; APPLY_DATE )
		   AND NOT EXISTS (SELECT 1 
							 FROM TPATMONSHIPCOST TS 
							WHERE TS.PA_CODE = PA.PA_CODE
							  AND TS.ENTP_CODE = CM.ENTP_CODE
							  AND TS.PRODUCT_TYPE = DECODE(G.INSTALL_YN, '1', 'DP04', DECODE(AI.ORDER_CREATE_YN, '1', 'DP05', 'DP07'))
							  AND TS.SHIP_MAN_SEQ = DECODE(G.DELY_TYPE, '10', '003', G.SHIP_MAN_SEQ)
							  AND TS.RETURN_MAN_SEQ = DECODE(G.DELY_TYPE, '10', '002', G.RETURN_MAN_SEQ)
							  AND TS.SHIP_COST_CODE = G.SHIP_COST_CODE
							  AND TS.APPLY_DATE = CD1.APPLY_DATE
							  AND TS.NO_SHIP_ISLAND = NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = G.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0)
						  )
    </select>
    
    <select id="selectCur11stShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCur11stShipStopSaleList */ 
			   PG.GOODS_CODE
			 , ST.PA_CODE
			 , NVL(ST.PRODUCT_NO, ST.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAPRODUCT   PG
			 , TPA11STGOODS ST
			 , TGOODS      GD
		 WHERE PG.GOODS_CODE     = ST.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND ST.PA_SALE_GB     = '20'
		   AND ST.PA_STATUS      = '30'
		   AND ST.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE,'10','100001',PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectCurGmktShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurGmktShipStopSaleList */ 
			   PG.GOODS_CODE
			 , GG.PA_CODE
			 , NVL(GG.ITEM_NO, GG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAGOODS     PG
			 , TPAGMKTGOODS GG
			 , TGOODS      GD
		 WHERE PG.GOODS_CODE     = GG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND GG.PA_SALE_GB     = '20'
		   AND GG.PA_STATUS      = '30'
		   AND GG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE,'10','100001',PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectCurNaverShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurNaverShipStopSaleList */ 
			   PG.GOODS_CODE
			 , NG.PA_CODE
			 , NVL(NG.PRODUCT_ID, NG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAGOODS     PG
			 , TPANAVERGOODS NG
			 , TGOODS      GD
		 WHERE PG.GOODS_CODE     = NG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND NG.PA_SALE_GB     = '20'
		   AND NG.PA_STATUS      = '30'
		   AND NG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE,'10','100001',PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectCurCopnShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurCopnShipStopSaleList */ 
			   PG.GOODS_CODE
			 , CG.PA_CODE
			 , NVL(CG.SELLER_PRODUCT_ID, CG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAGOODS     PG
			 , TPACOPNGOODS CG
			 , TGOODS      GD
		 WHERE PG.GOODS_CODE     = CG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND CG.PA_SALE_GB     = '20'
		   AND CG.PA_STATUS      = '30'
		   AND CG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE,'10','100001',PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectCurWempShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurWempShipStopSaleList */ 
			   PG.GOODS_CODE
			 , WG.PA_CODE
			 , NVL(WG.PRODUCT_NO, WG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAPRODUCT   PG
			 , TPAWEMPGOODS WG
			 , TGOODS      GD
		 WHERE PG.GOODS_CODE     = WG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND WG.PA_SALE_GB     = '20'
		   AND WG.PA_STATUS      = '30'
		   AND WG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE,'10','100001',PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectCurIntpShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurIntpShipStopSaleList */ 
			   PG.GOODS_CODE
			 , IG.PA_CODE
			 , NVL(IG.PRD_NO, IG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAPRODUCT   PG
			 , TPAINTPGOODS IG
			 , TGOODS      GD
		 WHERE PG.GOODS_CODE     = IG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND IG.PA_SALE_GB     = '20'
		   AND IG.PA_STATUS      = '30'
		   AND IG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE,'10','100001',PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectCurLtonShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurLtonShipStopSaleList */ 
			   PG.GOODS_CODE
			 , LG.PA_CODE
			 , NVL(LG.SPD_NO, LG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAPRODUCT   PG
			 , TPALTONGOODS LG
			 , TGOODS       GD
		 WHERE PG.GOODS_CODE     = LG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND LG.PA_SALE_GB     = '20'
		   AND LG.PA_STATUS      = '30'
		   AND LG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE, '10', '100001', PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectCurSsgShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurSsgShipStopSaleList */ 
			   PG.GOODS_CODE
			 , SG.PA_CODE
			 , NVL(SG.ITEM_ID, SG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAGOODS     PG
			 , TPASSGGOODS  SG
			 , TGOODS       GD
		 WHERE PG.GOODS_CODE     = SG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND SG.PA_SALE_GB     = '20'
		   AND SG.PA_STATUS      = '30'
		   AND SG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE, '10', '100001', PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
	
	<update id="updateTpaCustShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateTpaCustShipCost */
               TPACUSTSHIPCOST PC
           SET PC.SHIP_COST_BASE_AMT = #{shipCostBaseAmt, jdbcType=NUMERIC}
             , PC.ORD_COST           = #{ordCost, jdbcType=NUMERIC}
             , PC.RETURN_COST        = #{returnCost, jdbcType=NUMERIC}
             , PC.CHANGE_COST        = #{changeCost, jdbcType=NUMERIC}
             , PC.ISLAND_COST        = #{islandCost, jdbcType=NUMERIC}
             , PC.JEJU_COST          = #{jejuCost, jdbcType=NUMERIC}
             , PC.TRANS_TARGET_YN    = '1'
             , PC.LAST_SYNC_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
             , PC.MODIFY_DATE        = #{modifyDate, jdbcType=TIMESTAMP}
             , PC.MODIFY_ID          = #{modifyId, jdbcType=VARCHAR}
         WHERE PC.ENTP_CODE          = #{entpCode, jdbcType=VARCHAR}
           AND PC.SHIP_COST_CODE     = #{shipCostCode, jdbcType=VARCHAR}
           AND PC.PA_CODE            = #{paCode, jdbcType=VARCHAR}
    </update>
	
	<insert id="insertTpaCustShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO" >
		INSERT INTO TPACUSTSHIPCOST ( /* pacommon.xml : pacommon.common.insertTpaCustShipCost */
			PA_CODE
		  , ENTP_CODE
		  , SHIP_COST_CODE
		  , GROUP_CODE
		  , SHIP_COST_BASE_AMT
		  , ORD_COST
		  , RETURN_COST
		  , CHANGE_COST
		  , ISLAND_COST
		  , JEJU_COST
		  , TRANS_TARGET_YN
		  , LAST_SYNC_DATE
		  , INSERT_ID
		  , INSERT_DATE
		  , MODIFY_ID
		  , MODIFY_DATE
		  , TRANS_CN_COST_YN )
	VALUES ( #{paCode, jdbcType=VARCHAR}
		   , #{entpCode, jdbcType=VARCHAR}
		   , #{shipCostCode, jdbcType=VARCHAR}
		   , ''
		   , #{shipCostBaseAmt, jdbcType=NUMERIC}
		   , #{ordCost, jdbcType=NUMERIC}
		   , #{returnCost, jdbcType=NUMERIC}
		   , #{changeCost, jdbcType=NUMERIC}
		   , #{islandCost, jdbcType=NUMERIC}
		   , #{jejuCost, jdbcType=NUMERIC}
		   , '1'
		   , #{modifyDate, jdbcType=TIMESTAMP}
		   , #{modifyId, jdbcType=VARCHAR}
		   , #{modifyDate, jdbcType=TIMESTAMP}
		   , #{modifyId, jdbcType=VARCHAR}
		   , #{modifyDate, jdbcType=TIMESTAMP}
		   , '0' )
    </insert>
    
    <insert id="insertTpaTmonCustShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO" >
		INSERT INTO TPATMONSHIPCOST ( /* pacommon.xml : pacommon.common.insertTpaTmonCustShipCost */
			PA_CODE
		  , ENTP_CODE
		  , PRODUCT_TYPE
		  , SHIP_MAN_SEQ
		  , RETURN_MAN_SEQ
		  , SHIP_COST_CODE
		  , APPLY_DATE
		  , NO_SHIP_ISLAND
		  , SHIP_COST_BASE_AMT
		  , ORD_COST
		  , RETURN_COST
		  , CHANGE_COST
		  , ISLAND_COST
		  , JEJU_COST
		  , INSERT_ID
		  , INSERT_DATE
		  , MODIFY_ID
		  , MODIFY_DATE )
	VALUES ( #{paCode, jdbcType=VARCHAR}
		   , #{entpCode, jdbcType=VARCHAR}
		   , #{productType, jdbcType=VARCHAR}
		   , #{shipManSeq, jdbcType=VARCHAR}
		   , #{returnManSeq, jdbcType=VARCHAR}
		   , #{shipCostCode, jdbcType=VARCHAR}
		   , #{applyDate, jdbcType=TIMESTAMP}
		   , #{noShipIsland, jdbcType=VARCHAR}
		   , #{shipCostBaseAmt, jdbcType=NUMERIC}
		   , #{ordCost, jdbcType=NUMERIC}
		   , #{returnCost, jdbcType=NUMERIC}
		   , #{changeCost, jdbcType=NUMERIC}
		   , #{islandCost, jdbcType=NUMERIC}
		   , #{jejuCost, jdbcType=NUMERIC}
		   , #{modifyId, jdbcType=VARCHAR}
		   , #{modifyDate, jdbcType=TIMESTAMP}
		   , #{modifyId, jdbcType=VARCHAR}
		   , #{modifyDate, jdbcType=TIMESTAMP} )
    </insert>
    
    <update id="updateTransCnCostYn2" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateTransCnCostYn */
               TPACUSTSHIPCOST PC
           SET PC.TRANS_CN_COST_YN = '1'
         WHERE PC.ENTP_CODE        = #{entpCode, jdbcType=VARCHAR}
           AND PC.SHIP_COST_CODE   = #{shipCostCode, jdbcType=VARCHAR}
           AND PC.PA_CODE          = #{paCode, jdbcType=VARCHAR}
    </update>
    
    <update id="update11stTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.update11stTransShipCost */
               TPA11STGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       	= #{modifyId		, jdbcType=VARCHAR}
             , P.MODIFY_DATE     	= #{modifyDate		, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateGmktTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateGmktTransShipCost */
               TPAGMKTGOODS P
           SET P.TRANS_TARGET_YN 	= '1'
             , P.MODIFY_ID       	= #{modifyId		, jdbcType=VARCHAR}
             , P.MODIFY_DATE     	= #{modifyDate		, jdbcType=TIMESTAMP}          
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateNaverTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateNaverTransShipCost */
               TPANAVERGOODS P
           SET P.TRANS_TARGET_YN 	= '1'
             , P.MODIFY_ID       	= #{modifyId		, jdbcType=VARCHAR}
             , P.MODIFY_DATE     	= #{modifyDate		, jdbcType=TIMESTAMP}             
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateCopnTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateCopnTransShipCost */
               TPACOPNGOODS P
           SET P.TRANS_TARGET_YN 	= '1'
             , P.MODIFY_ID       	= #{modifyId	, jdbcType=VARCHAR}
             , P.MODIFY_DATE     	= #{modifyDate	, jdbcType=TIMESTAMP}                 
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateWempTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateWempTransShipCost */
               TPAWEMPGOODS P
           SET P.TRANS_TARGET_YN 	= '1'
             , P.MODIFY_ID       	= #{modifyId		, jdbcType=VARCHAR}
             , P.MODIFY_DATE     	= #{modifyDate		, jdbcType=TIMESTAMP}            
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateIntpTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateIntpTransShipCost */
               TPAINTPGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateLtonTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateLtonTransShipCost */
               TPALTONGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateSsgTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateSsgTransShipCost */
               TPASSGGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
	<update id="updateKakaoTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateKakaoTransShipCost */
               TPAKAKAOGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
	<select id="selectCurEntpSlipInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.PaEntpSlip">
        SELECT /* pacommon.xml : pacommon.common.selectCurEntpSlipInfoList */ 
               PE.ENTP_CODE
			 , PE.ENTP_MAN_SEQ
			 , PE.PA_CODE
		  FROM TPAENTPSLIP PE
			 , TENTPUSER   TE
			 , TCODE CD
		 WHERE PE.ENTP_CODE      = TE.ENTP_CODE
		   AND PE.ENTP_MAN_SEQ   = TE.ENTP_MAN_SEQ
		   AND PE.LAST_SYNC_DATE &lt; TE.MODIFY_DATE
		   AND CD.CODE_LGROUP	 = 'O501'
		   AND PE.PA_CODE		 = CD.CODE_MGROUP
		   AND CD.CODE_GROUP	 = #{paGroupCode, jdbcType=VARCHAR}
		   AND TE.MODIFY_DATE    &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - #{conditionDay, jdbcType=NUMERIC}
    </select>
    
    <select id="selectCurWempEntpSlipInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.PaEntpSlip">
        SELECT /* pacommon.xml : pacommon.common.selectCurWempEntpSlipInfoList */ 
               PE.PA_CODE
			 , PE.ENTP_CODE
			 , PE.ENTP_MAN_SEQ
			 , PE.SHIP_COST_CODE
			 , PE.NO_SHIP_ISLAND
			 , PE.INSTALL_YN
		  FROM TPAWEMPENTPSLIP PE
			 , TENTPUSER TE
		 WHERE PE.ENTP_CODE = TE.ENTP_CODE
		   AND PE.ENTP_MAN_SEQ = TE.ENTP_MAN_SEQ
		   AND PE.LAST_SYNC_DATE &lt; TE.MODIFY_DATE
		   AND TE.MODIFY_DATE    &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - #{conditionDay, jdbcType=NUMERIC}
    </select>
	
	<update id="updateTpaEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateTpaEntpSlip */
               TPAENTPSLIP PC
           SET PC.TRANS_TARGET_YN = '1'
             , PC.LAST_SYNC_DATE  = #{modifyDate, jdbcType=TIMESTAMP}
             , PC.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
             , PC.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
         WHERE PC.ENTP_CODE       = #{entpCode, jdbcType=VARCHAR}
           AND PC.ENTP_MAN_SEQ    = #{entpManSeq, jdbcType=VARCHAR}
           AND PC.PA_CODE         = #{paCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateTpaWempEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateTpaWempEntpSlip */
               TPAWEMPENTPSLIP PC
           SET PC.TRANS_TARGET_YN = '1'
             , PC.LAST_SYNC_DATE  = #{modifyDate, jdbcType=TIMESTAMP}
             , PC.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
             , PC.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
         WHERE PC.PA_CODE         = #{paCode, jdbcType=VARCHAR}
           AND PC.ENTP_CODE       = #{entpCode, jdbcType=VARCHAR}
           AND PC.ENTP_MAN_SEQ    = #{entpManSeq, jdbcType=VARCHAR}
           AND PC.SHIP_COST_CODE  = #{shipCostCode, jdbcType=VARCHAR}
           AND PC.NO_SHIP_ISLAND  = #{noShipIsland, jdbcType=VARCHAR}
           AND PC.INSTALL_YN	  = #{installYn, jdbcType=VARCHAR}
    </update>
    
    <update id="update11stTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.update11stTransEntpSlip */
               TPA11STGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE,'10','003',G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateGmktTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateGmktTransEntpSlip */
               TPAGMKTGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE,'10','003',G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateNaverTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateCopnTransEntpSlip */
               TPANAVERGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE,'10','003',G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateCopnTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateCopnTransEntpSlip */
               TPACOPNGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE,'10','003',G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateWempTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateWempTransEntpSlip */
               TPAWEMPGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE,'10','003',G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateIntpTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateIntpTransEntpSlip */
               TPAINTPGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE,'10','003',G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateLtonTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateLtonTransEntpSlip */
               TPALTONGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId,   jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE, '10', '100001', G.ENTP_CODE) = #{entpCode,   jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE, '10', '003', G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <select id="select11stCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.select11stCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.PRODUCT_NO, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPA11STGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;> '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE   > SYSDATE - 30 ) XA
    </select>
    
    <select id="selectGmktCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectGmktCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.ITEM_NO, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPAGMKTGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;> '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE   > SYSDATE - 30 ) XA
    </select>
    
    <select id="selectNaverCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectNaverCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.PRODUCT_ID, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPANAVERGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;> '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE   > SYSDATE - 30 ) XA
    </select>
    
    <select id="selectCopnCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCopnCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.SELLER_PRODUCT_ID, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPACOPNGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;> '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE   > SYSDATE - 30 ) XA
    </select>
    
    <select id="selectWempCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectWempCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.PRODUCT_NO, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPAWEMPGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;> '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE   > SYSDATE - 30 ) XA
    </select>
	
	<select id="selectIntpCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectIntpCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.PRD_NO, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPAINTPGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;&gt; '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE &gt; SYSDATE - 30 ) XA
    </select>
    
	<select id="selectLtonCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectLtonCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.SPD_NO, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPALTONGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;&gt; '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE &gt; SYSDATE - 30 ) XA
    </select>
    
    <select id="selectCurEventMarginList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurEventMarginList */ 
			   GP.GOODS_CODE
			 , PP.PA_CODE
			 , DECODE( GP.SALE_PRICE, 0, 0, TRUNC((GP.SALE_PRICE-GP.BUY_PRICE) / GP.SALE_PRICE*100) )  AS MARGIN_RATE
			 , PP.GOODS_CODE AS PA_GOODS_CODE
		  FROM TPAGOODSEVENT PE
			 , TPAGOODSPRICE PP
			 , TGOODSPRICE GP
			 , TCODE TC
			 , TCODE TC1
			 , TGOODS TG
		 WHERE PE.GOODS_CODE = PP.GOODS_CODE
		   AND PP.GOODS_CODE = GP.GOODS_CODE
		   AND GP.GOODS_CODE = TG.GOODS_CODE
		   AND PE.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
		   AND TC.CODE_LGROUP = 'O501'
		   AND PE.PA_GROUP_CODE = TC.CODE_GROUP
		   AND PP.PA_CODE = TC.CODE_MGROUP
		   AND (PE.END_DATE &lt; SYSDATE OR PE.USE_YN = '0')
		   AND GP.ROWID = ( SELECT /*+INDEX_DESC (P2 PK_TGOODSPRICE)*/
								   ROWID
							  FROM TGOODSPRICE P2
							 WHERE P2.GOODS_CODE  = GP.GOODS_CODE
							   AND P2.APPLY_DATE &lt;= SYSDATE
							   AND ROWNUM = 1
						  )
		   AND PP.ROWID = ( SELECT /*+ INDEX_DESC (P PK_TPAGOODSPRICE)*/
								   P.ROWID
							  FROM TPAGOODSPRICE P
							 WHERE P.GOODS_CODE = PP.GOODS_CODE
							   AND P.PA_CODE = PP.PA_CODE
							   AND P.APPLY_DATE &lt;= SYSDATE
							   AND ROWNUM = 1
						  )
		   AND PE.PAGOODSEVENT_SEQ = ( SELECT MAX(PE2.PAGOODSEVENT_SEQ)
										 FROM TPAGOODSEVENT PE2
										WHERE PE2.GOODS_CODE = PE.GOODS_CODE
										  AND PE2.PA_GROUP_CODE = PE.PA_GROUP_CODE
										  AND (PE2.END_DATE &lt; SYSDATE OR PE2.USE_YN = '0')
									 )
		   AND NOT EXISTS ( SELECT 1
							  FROM TPAGOODSEVENT PE3
							 WHERE PE3.GOODS_CODE = PE.GOODS_CODE
							   AND PE3.PA_GROUP_CODE = PE.PA_GROUP_CODE
							   AND PE3.USE_YN = '1'
							   AND SYSDATE BETWEEN PE3.START_DATE AND PE3.END_DATE                       
						  )
		   AND TC1.CODE_LGROUP = 'O582'
		   AND TC1.CODE_MGROUP = #{minMarginCode, jdbcType=VARCHAR}
		   AND DECODE( GP.SALE_PRICE, 0, 0, TRUNC((GP.SALE_PRICE-GP.BUY_PRICE) / GP.SALE_PRICE*100) ) &lt; CASE WHEN #{paGroupCode, jdbcType=VARCHAR} = '10' AND TG.TAX_YN = '0' AND TC1.REMARK2 IS NOT NULL
																											       THEN TC1.REMARK2
																											      ELSE DECODE(PP.PA_CODE, #{comparePaCode, jdbcType=VARCHAR}, TC1.REMARK, TC1.REMARK1)
																											 END
		   
		<if test="paGroupCode == '01'">
			AND EXISTS (SELECT 1 FROM TPA11STGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '02'">
			AND EXISTS (SELECT 1 FROM TPAGMKTGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '04'">
			AND EXISTS (SELECT 1 FROM TPANAVERGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '05'">
			AND EXISTS (SELECT 1 FROM TPACOPNGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '06'">
			AND EXISTS (SELECT 1 FROM TPAWEMPGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '07'">
			AND EXISTS (SELECT 1 FROM TPAINTPGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '08'">
			AND EXISTS (SELECT 1 FROM TPALTONGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '09'">
			AND EXISTS (SELECT 1 FROM TPATMONGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
		<if test="paGroupCode == '10'">
			AND EXISTS (SELECT 1 FROM TPASSGGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
	    <if test="paGroupCode == '11'">
			AND EXISTS (SELECT 1 FROM TPAKAKAOGOODS PG WHERE PG.GOODS_CODE = PE.GOODS_CODE AND PG.PA_SALE_GB = '20' AND PG.PA_STATUS = '30')
		</if>
    </select>
    
    <select id="selectCurCheckDtCntList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurCheckDtCntList */ 
			   LG.GOODS_CODE
			 , LG.PA_CODE
			 , LG.SPD_NO AS PA_GOODS_CODE
		  FROM TPALTONGOODS LG
			 , TPALTONGOODSDTMAPPING LD
		 WHERE LG.GOODS_CODE = LD.GOODS_CODE
		   AND LG.PA_SALE_GB = '20'
		   AND LG.PA_STATUS = '30'
	  GROUP BY LG.GOODS_CODE, LG.PA_CODE, LG.SPD_NO
		HAVING COUNT(1) &gt; 500
    </select>
    
    <select id="selectCurSsgCheckDtCntList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurSsgCheckDtCntList */ 
			   PG.GOODS_CODE
			 , PG.PA_CODE
			 , PG.ITEM_ID AS PA_GOODS_CODE
		  FROM TPASSGGOODS PG
			 , TPAGOODSDTMAPPING PD
		 WHERE PG.GOODS_CODE = PD.GOODS_CODE
		   AND PG.PA_CODE = PD.PA_CODE
		   AND PG.PA_SALE_GB = '20'
		   AND PG.PA_STATUS = '30'
	  GROUP BY PG.GOODS_CODE, PG.PA_CODE, PG.ITEM_ID
		HAVING COUNT(1) > 100
    </select>
    
      <select id="selectTmonCurCheckDtCntList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurCheckDtCntList */ 
			   TG.GOODS_CODE
			 , TG.PA_CODE
			 , TG.DEAL_NO AS PA_GOODS_CODE
		  FROM TPATMONGOODS TG
			 , TPAGOODSDTMAPPING TM
		 WHERE TG.GOODS_CODE = TM.GOODS_CODE
		   AND TG.PA_SALE_GB = '20'
		   AND TG.PA_STATUS = '30'
		 GROUP BY TG.GOODS_CODE, TG.PA_CODE, TG.DEAL_NO
		HAVING COUNT(1) &gt; 200
      </select>
    
    <select id="selectTmonCurGoodsNameLengthCheckList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectTmonCurGoodsNameLengthCheckList */ 
			   TG.GOODS_CODE
			 , TG.PA_CODE
			 , TG.DEAL_NO AS PA_GOODS_CODE
		  FROM TPATMONGOODS TG
			 , TGOODS TM
		 WHERE TG.GOODS_CODE = TM.GOODS_CODE
		   AND TG.PA_SALE_GB = '20'
		   AND TG.PA_STATUS = '30'
		   AND LENGTH(TM.GOODS_NAME) > 60
    </select>
    
    <select id="selectCurGoodsTransQtyList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaLtonGoodsVO">
        SELECT /* pacommon.xml : pacommon.common.selectCurGoodsTransQtyList */ 
			   LG.PA_CODE
			 , LG.GOODS_CODE
			 , LG.TRANS_ORDER_ABLE_QTY
			 , CEIL(FUN_GET_ORDER_ABLE_QTY(LG.GOODS_CODE,'%', TG.WH_CODE) * TC.CODE_GROUP) AS NEW_TRANS_QTY
		  FROM TPALTONGOODS LG
			 , TGOODS TG
			 , TCODE TC
		 WHERE LG.GOODS_CODE = TG.GOODS_CODE
		   AND LG.PA_STATUS = '30'
		   AND TC.CODE_LGROUP = 'O505'
		   AND TC.CODE_MGROUP = LG.PA_CODE
		   AND LG.TRANS_ORDER_ABLE_QTY &lt;&gt; CEIL(FUN_GET_ORDER_ABLE_QTY(LG.GOODS_CODE,'%', TG.WH_CODE) * TC.CODE_GROUP)
    </select>
    
    <select id="selectCurGoodsDtTransQtyList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaLtonGoodsdtMappingVO">
	    SELECT XA.PA_CODE
             , XA.GOODS_CODE
             , XA.GOODSDT_CODE
             , XA.GOODSDT_SEQ
             , XA.TRANS_ORDER_ABLE_QTY
             , CASE WHEN XA.NEW_TRANS_QTY &lt;= 3
                     THEN 0
                     ELSE XA.NEW_TRANS_QTY
                    END AS NEW_TRANS_QTY
		  FROM (
		        SELECT /* pacommon.xml : pacommon.common.selectCurGoodsDtTransQtyList */ 
					   DM.PA_CODE
		             , PD.GOODS_CODE
		             , PD.GOODSDT_CODE
		             , DM.GOODSDT_SEQ
		             , DM.TRANS_ORDER_ABLE_QTY
		             , DECODE(GT.SALE_GB, 00, CEIL(FUN_GET_ORDER_ABLE_QTY(PD.GOODS_CODE, PD.GOODSDT_CODE, GD.WH_CODE) * TC.CODE_GROUP), 0) AS NEW_TRANS_QTY
		          FROM TPAPRODUCTOPTION PD
		             , TPALTONGOODSDTMAPPING DM
		             , TPALTONGOODS PG
		             , TGOODS GD
		             , TCODE TC
		             , TGOODSDT GT
		             , TPAGOODS P
		         WHERE PD.GOODS_CODE    = DM.GOODS_CODE
		           AND PD.GOODSDT_CODE  = DM.GOODSDT_CODE
		           AND DM.GOODS_CODE    = PG.GOODS_CODE
		           AND DM.PA_CODE       = PG.PA_CODE
		           AND GD.GOODS_CODE    = PG.GOODS_CODE
		           AND TC.CODE_LGROUP   = 'O505'
		           AND TC.CODE_MGROUP   = PG.PA_CODE
		           AND PG.PA_SALE_GB    = '20'
		           AND PG.PA_STATUS     = '30'
		           AND GT.GOODS_CODE    = PD.GOODS_CODE
		           AND GT.GOODSDT_CODE  = PD.GOODSDT_CODE
		           AND DM.TRANS_ORDER_ABLE_QTY &lt;&gt; DECODE(GT.SALE_GB, 00, CEIL(FUN_GET_ORDER_ABLE_QTY(PD.GOODS_CODE, PD.GOODSDT_CODE, GD.WH_CODE) * TC.CODE_GROUP), 0)
		           AND DM.ROWID = (SELECT /*+ INDEX_DESC (DM2 PK_TPALTONGOODSDTMAPPING)*/
										  DM2.ROWID
									 FROM TPALTONGOODSDTMAPPING DM2
									WHERE DM.PA_CODE = DM2.PA_CODE
									  AND DM.GOODS_CODE = DM2.GOODS_CODE
									  AND DM.GOODSDT_CODE = DM2.GOODSDT_CODE
									  AND rownum = 1 )
		           <if test='goodsCode != null and goodsCode != ""'>
		           AND DM.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
		           </if>
		           <if test='paCode != null and paCode != ""'>
		           AND DM.PA_CODE       = #{paCode, jdbcType=VARCHAR}
		           </if>
		           AND P.GOODS_CODE = PG.GOODS_CODE
		           AND P.SALE_GB = '00'
		           ) XA
		 WHERE XA.TRANS_ORDER_ABLE_QTY &lt;&gt; CASE WHEN XA.NEW_TRANS_QTY &lt;= 3
								                      THEN 0
								                      ELSE XA.NEW_TRANS_QTY
								                      END
    </select>
    
    <select id="selectGmktCurStockCheckList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectGmktCurStockCheckList */ 
			   XX.GOODS_CODE
			 , XX.PA_CODE
		  FROM (SELECT X.GOODS_CODE
					 , X.PA_CODE
					 , NVL(DECODE(X.SALE_GB,'00',CEIL(FUN_GET_ORDER_ABLE_QTY(X.GOODS_CODE,X.GOODSDT_CODE,X.WH_CODE) *X.CODE_GROUP),0),0) AS NEW_TRANS_ORDER_ABLE_QTY
					 , X.TRANS_ORDER_ABLE_QTY AS OLD_TRANS_ORDER_ABLE_QTY
				  FROM (SELECT DISTINCT DM2.GOODS_CODE
							 , DM2.PA_CODE
							 , TG.SALE_GB
							 , PD.GOODSDT_CODE
							 , TG.WH_CODE
							 , TC.CODE_GROUP
							 , DM2.TRANS_ORDER_ABLE_QTY
						  FROM TGOODS TG
							 , TPAGOODSDT PD
							 , TCODE TC
							 , (SELECT PD2.GOODS_CODE
								  FROM TPAGOODSDT PD2
								 WHERE PD2.SALE_GB = '00'
							  GROUP BY PD2.GOODS_CODE
								HAVING COUNT(PD2.GOODSDT_CODE) &lt; 21) PD3
							 , TPAGOODSDTMAPPING DM2
							 , TPAGMKTGOODS GG
						 WHERE TG.GOODS_CODE = PD.GOODS_CODE
						   AND TC.CODE_LGROUP = 'O505'
						   AND TC.CODE_MGROUP = GG.PA_CODE
						   AND TG.GOODS_CODE = PD3.GOODS_CODE
						   AND PD3.GOODS_CODE = GG.GOODS_CODE
						   AND GG.PA_STATUS = '30'
						   AND GG.PA_SALE_GB = '20'
						   AND DM2.PA_CODE = GG.PA_CODE
						   AND DM2.GOODS_CODE = PD.GOODS_CODE
						   AND DM2.TRANS_TARGET_YN = '0'
						   AND DM2.GOODSDT_CODE = PD.GOODSDT_CODE) X) XX
				WHERE XX.NEW_TRANS_ORDER_ABLE_QTY != XX.OLD_TRANS_ORDER_ABLE_QTY
				  AND (NEW_TRANS_ORDER_ABLE_QTY &lt; 99999 OR OLD_TRANS_ORDER_ABLE_QTY &lt;&gt; 99999) 
				GROUP BY XX.GOODS_CODE, XX.PA_CODE
				ORDER BY GOODS_CODE
    </select>
    
    <select id="selectNaverCurStockCheckList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectNaverCurStockCheckList */ 
			   XX.GOODS_CODE
			 , XX.PA_CODE
		  FROM ( SELECT X.GOODS_CODE
					  , X.PA_CODE
					  , X.GOODSDT_CODE
					  , NVL(DECODE(X.SALE_GB, '00', CEIL(FUN_GET_ORDER_ABLE_QTY(X.GOODS_CODE, X.GOODSDT_CODE, X.WH_CODE) * X.CODE_GROUP), 0), 0) AS NEW_TRANS_ORDER_ABLE_QTY
					  , X.TRANS_ORDER_ABLE_QTY AS OLD_TRANS_ORDER_ABLE_QTY
				   FROM ( SELECT DISTINCT DM2.GOODS_CODE
							   , DM2.PA_CODE
							   , TG.SALE_GB
							   , PD.GOODSDT_CODE
							   , TG.WH_CODE
							   , TC.CODE_GROUP
							   , DM2.TRANS_ORDER_ABLE_QTY
							FROM TGOODS TG
							   , TPAGOODSDT PD
							   , TCODE TC
							   , (SELECT PD2.GOODS_CODE
									FROM TPAGOODSDT PD2
								   WHERE PD2.SALE_GB = '00'
								GROUP BY PD2.GOODS_CODE
								  HAVING COUNT(PD2.GOODSDT_CODE) &lt; 500) PD3
							   , TPAGOODSDTMAPPING DM2
							   , TPANAVERGOODS PNG
						   WHERE TG.GOODS_CODE = PD.GOODS_CODE
							 AND TC.CODE_LGROUP = 'O505'
							 AND TC.CODE_MGROUP = PNG.PA_CODE
							 AND TG.GOODS_CODE = PD3.GOODS_CODE
							 AND PD3.GOODS_CODE = PNG.GOODS_CODE
							 AND PNG.PA_STATUS = '30'
							 AND PNG.PA_SALE_GB = '20'
							 AND DM2.PA_CODE = PNG.PA_CODE
							 AND DM2.GOODS_CODE = PD.GOODS_CODE
							 AND DM2.GOODSDT_CODE = PD.GOODSDT_CODE
							 AND DM2.TRANS_TARGET_YN = '0'
							 AND DM2.TRANS_ORDER_ABLE_QTY &lt; 999999 ) X) XX
     WHERE XX.NEW_TRANS_ORDER_ABLE_QTY != XX.OLD_TRANS_ORDER_ABLE_QTY
 GROUP BY XX.GOODS_CODE, XX.PA_CODE
    </select>
    
    <select id="selectCurEpNameInfoList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurEpNameInfoList */ 
			   PNG.GOODS_CODE
			 , G.GOODS_NAME_MC
			 , PNG.PA_CODE
		  FROM TPANAVERGOODS PNG
			 , TGOODS  G
		 WHERE PNG.GOODS_CODE = G.GOODS_CODE
		   AND PNG.PA_GOODS_NAME &lt;&gt; G.GOODS_NAME_MC
		   AND ROWNUM &lt;= 100
    </select>
    
    <select id="selectCurCnShipCostInfoList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurCnShipCostInfoList */ 
			   DISTINCT PCS.ENTP_CODE
			 , PCS.PA_CODE
		  FROM TPACUSTSHIPCOST PCS
		 WHERE PCS.TRANS_CN_COST_YN = '1'
		   AND PCS.SHIP_COST_CODE   LIKE 'CN%'
	  ORDER BY PCS.ENTP_CODE
	</select>
	
	<select id="selectCurCnShipCostTransSingle" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurCnShipCostTransSingle */ 
			   X.ENTP_MAN_SEQ
			 , X.ENTP_CODE
			 , X.PA_CODE
		  FROM ( SELECT PCC.ENTP_MAN_SEQ
					  , PCC.ENTP_CODE
					  , PCC.PA_CODE
					  , COUNT(1) AS CNT
				   FROM TPACUSTSHIPCOST PCS, TPACUSTCNSHIPCOST PCC, TPAENTPSLIP PES
				  WHERE PCS.ENTP_CODE       = PCC.ENTP_CODE
					AND PCC.ENTP_CODE       = PES.ENTP_CODE(+)
					AND PCS.PA_CODE         = PCC.PA_CODE
					AND PCC.PA_CODE         = PES.PA_CODE(+)
					AND PCS.SHIP_COST_CODE  = PCC.SHIP_COST_CODE
					AND PCS.SHIP_COST_CODE  LIKE 'CN%'
					AND PCC.ENTP_MAN_SEQ    = PES.ENTP_MAN_SEQ(+)
					AND PCC.TRANS_TARGET_YN = '1'
			   GROUP BY PCC.ENTP_CODE, PCC.ENTP_MAN_SEQ, PCC.PA_CODE ) X
		 WHERE X.CNT = 1
	</select>
	
	<select id="selectCurCnShipCostTransMulti" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurCnShipCostTransMulti */ 
			   X.ENTP_MAN_SEQ
			 , X.ENTP_CODE
			 , X.PA_CODE
		  FROM ( SELECT PCC.ENTP_MAN_SEQ
					  , PCC.ENTP_CODE
					  , PCC.PA_CODE
					  , COUNT(1) AS CNT
				   FROM TPACUSTSHIPCOST PCS, TPACUSTCNSHIPCOST PCC, TPAENTPSLIP PES
				  WHERE PCS.ENTP_CODE        = PCC.ENTP_CODE
					AND PCC.ENTP_CODE       = PES.ENTP_CODE(+)
					AND PCS.PA_CODE         = PCC.PA_CODE
					AND PCC.PA_CODE         = PES.PA_CODE(+)
					AND PCS.SHIP_COST_CODE  = PCC.SHIP_COST_CODE
					AND PCS.SHIP_COST_CODE  LIKE 'CN%'
					AND PCC.ENTP_MAN_SEQ    = PES.ENTP_MAN_SEQ(+)
					AND PCC.TRANS_TARGET_YN = '1'
			   GROUP BY PCC.ENTP_CODE, PCC.ENTP_MAN_SEQ, PCC.PA_CODE) X
		 WHERE X.CNT != 1
	</select>
    
    <select id="selectCurCnShipCostDtInfoList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurCnShipCostDtInfoList */ 
			   DISTINCT PG.ENTP_CODE
		  	 , PG.SHIP_COST_CODE
		  	 , PG.SHIP_MAN_SEQ
		  	 , TS.ORD_COST_AMT
		  	 , PCC.SHIP_COST_BASE_AMT
		  	 , TS.ORD_COST_AMT1
		  	 , TS.ORD_COST_AMT2
		  	 , MAX(TS.ORD_COST_AMT)  OVER (PARTITION BY PG.ENTP_CODE, PG.SHIP_MAN_SEQ) AS MAX_ORD_COST_AMT
		  	 , MAX(TS.ORD_COST_AMT1) OVER (PARTITION BY PG.ENTP_CODE, PG.SHIP_MAN_SEQ) AS MAX_ORD_COST_AMT1
		  	 , MAX(TS.ORD_COST_AMT2) OVER (PARTITION BY PG.ENTP_CODE, PG.SHIP_MAN_SEQ) AS MAX_ORD_COST_AMT2
		  	 , PCC.PA_CODE
		  FROM TPAPRODUCT PG
			 , TPA11STGOODS P11G
			 , (SELECT CD.ENTP_CODE
					 , CD.SHIP_COST_CODE
					 , SUM(DECODE(CUST_AREA_GB, '10', ORD_COST_AMT,  0)) AS ORD_COST_AMT
					 , SUM(DECODE(CUST_AREA_GB, '10', RET_COST_AMT,  0)) AS RET_COST_AMT
					 , SUM(DECODE(CUST_AREA_GB, '10', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT
					 , SUM(DECODE(CUST_AREA_GB, '20', ORD_COST_AMT,  0)) AS ORD_COST_AMT1
					 , SUM(DECODE(CUST_AREA_GB, '20', RET_COST_AMT,  0)) AS RET_COST_AMT1
					 , SUM(DECODE(CUST_AREA_GB, '20', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT1
					 , SUM(DECODE(CUST_AREA_GB, '30', ORD_COST_AMT,  0)) AS ORD_COST_AMT2
					 , SUM(DECODE(CUST_AREA_GB, '30', RET_COST_AMT,  0)) AS RET_COST_AMT2
					 , SUM(DECODE(CUST_AREA_GB, '30', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT2
				  FROM TSHIPCOSTDT CD
				 WHERE CD.APPLY_DATE = (SELECT MAX(APPLY_DATE)
										  FROM TSHIPCOSTDT CD1
										 WHERE CD1.ENTP_CODE      = CD.ENTP_CODE
										   AND CD1.CUST_AREA_GB   IN ('10', '20', '30')
										   AND CD1.SHIP_COST_CODE = CD.SHIP_COST_CODE
										   AND CD1.APPLY_DATE     &lt;= SYSDATE)
									  GROUP BY CD.ENTP_CODE, CD.SHIP_COST_CODE ) TS
			 , TPACUSTSHIPCOST PCC
		 WHERE PG.SHIP_COST_CODE  = TS.SHIP_COST_CODE
		   AND PG.ENTP_CODE       = TS.ENTP_CODE
		   AND PG.SHIP_COST_CODE  = PCC.SHIP_COST_CODE
		   AND PG.ENTP_CODE       = PCC.ENTP_CODE
		   AND P11G.GOODS_CODE    = PG.GOODS_CODE
		   AND P11G.PA_CODE       = PCC.PA_CODE
		   AND (PG.ENTP_CODE,PG.SHIP_COST_CODE,P11G.PA_CODE) IN ( SELECT DISTINCT CSC.ENTP_CODE
																	   , CSC.SHIP_COST_CODE
																	   , CSC.PA_CODE
																	FROM TPACUSTSHIPCOST CSC
																   WHERE CSC.ENTP_CODE = #{entpCode, jdbcType=VARCHAR}
																     AND CSC.PA_CODE = #{paCode, jdbcType=VARCHAR}
																	 AND CSC.SHIP_COST_CODE   LIKE 'CN%' )
		   AND NOT EXISTS ( SELECT 1
							  FROM TPACUSTCNSHIPCOST CCS
							 WHERE CCS.PA_CODE			  = PCC.PA_CODE
							   AND CCS.ENTP_CODE		  = PCC.ENTP_CODE
							   AND CCS.ENTP_MAN_SEQ		  = PG.SHIP_MAN_SEQ
							   AND CCS.SHIP_COST_CODE	  = PCC.SHIP_COST_CODE
							   AND CCS.SHIP_COST_BASE_AMT = PCC.SHIP_COST_BASE_AMT
							   AND CCS.ORD_COST_AMT		  = PCC.ORD_COST )
	  ORDER BY PG.SHIP_MAN_SEQ,PG.SHIP_MAN_SEQ,TS.ORD_COST_AMT
	</select>

    <select id="selectCurEntpSlipChangeInfoList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurEntpSlipChangeInfoList */ 
			   EU.ENTP_CODE
			 , EU.ENTP_MAN_SEQ
			 , '00001' CHANGE_SEQ
			 , NVL(( SELECT '10'
					   FROM TPAENTPSLIP PS
					  WHERE EU.ENTP_CODE    = PS.ENTP_CODE
						AND EU.ENTP_MAN_SEQ = PS.ENTP_MAN_SEQ
						AND PS.PA_CODE      = '41' ),'00') AS CHANGE_FLAG
		  FROM TENTPUSER EU
		 WHERE EXISTS ( SELECT '1'
						  FROM TPAGOODS PG
							 , TPANAVERGOODS PN
						 WHERE EU.ENTP_CODE = PG.ENTP_CODE
						   AND EU.ENTP_MAN_SEQ = PG.SHIP_MAN_SEQ
						   AND PG.GOODS_CODE = PN.GOODS_CODE
					 UNION ALL
						SELECT '1'
						  FROM TPAGOODS PG
							 , TPANAVERGOODS PN
						 WHERE EU.ENTP_CODE = PG.ENTP_CODE
						   AND EU.ENTP_MAN_SEQ = PG.RETURN_MAN_SEQ
						   AND PG.GOODS_CODE = PN.GOODS_CODE )
		   AND NOT EXISTS ( SELECT '1'
							  FROM TPAENTPSLIPCHANGE PEC
							 WHERE PEC.ENTP_CODE    = EU.ENTP_CODE
							   AND PEC.ENTP_MAN_SEQ = EU.ENTP_MAN_SEQ )
		   AND EU.MODIFY_DATE &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - #{conditionDay, jdbcType=NUMERIC}

	 UNION ALL
    
		SELECT EU.ENTP_CODE
			 , EU.ENTP_MAN_SEQ
			 , LPAD(PEC.CHANGE_SEQ+1,5,'00000') AS CHANGE_SEQ
			 , NVL(( SELECT '10'
					   FROM TPAENTPSLIP PS
					  WHERE EU.ENTP_CODE    = PS.ENTP_CODE
						AND EU.ENTP_MAN_SEQ = PS.ENTP_MAN_SEQ
						AND PS.PA_CODE      = '41' ),'00') AS CHANGE_FLAG
		  FROM TENTPUSER EU      
			 , TPAENTPSLIPCHANGE PEC
		 WHERE EU.ENTP_CODE = PEC.ENTP_CODE
		   AND EU.ENTP_MAN_SEQ = PEC.ENTP_MAN_SEQ
		   AND PEC.CHANGE_SEQ = ( SELECT /*+ INDEX_DESC ( PSCE PK_TPAENTPSLIPCHANGE ) */
										 PSCE.CHANGE_SEQ
									FROM TPAENTPSLIPCHANGE PSCE
								   WHERE PEC.ENTP_CODE    = PSCE.ENTP_CODE
									 AND PEC.ENTP_MAN_SEQ = PSCE.ENTP_MAN_SEQ
									 AND PEC.PA_CODE      = PSCE.PA_CODE
									 AND ROWNUM = 1 )
		   AND EU.MODIFY_DATE > PEC.LAST_SYNC_DATE
     
	 UNION ALL
     
		SELECT DISTINCT PG.ENTP_CODE
			 , PG.SHIP_MAN_SEQ
			 , '00001' AS CHANGE_SEQ
			 , '00' AS CHANGE_FLAG
		  FROM TPAGOODS PG
			 , TPANAVERGOODS PNG
		 WHERE PG.GOODS_CODE = PNG.GOODS_CODE
		   AND NOT EXISTS ( SELECT '1'
							  FROM TPAENTPSLIP PE
							 WHERE PE.ENTP_CODE = PG.ENTP_CODE
							   AND PE.ENTP_MAN_SEQ = PG.SHIP_MAN_SEQ
							   AND PE.PA_CODE ='41' )
		   AND NOT EXISTS ( SELECT '1'
							  FROM TPANAVERENTPADDRESS NEA
							 WHERE PG.ENTP_CODE||PG.SHIP_MAN_SEQ = NEA.NAME )
		   AND NOT EXISTS ( SELECT '1'
							  FROM TPAENTPSLIPCHANGE PNC
							 WHERE PG.ENTP_CODE = PNC.ENTP_CODE
							   AND PG.SHIP_MAN_SEQ = PNC.ENTP_MAN_SEQ
							   AND PNC.PA_CODE ='41' )
                     
	 UNION ALL
    
		SELECT DISTINCT PG.ENTP_CODE
			 , PG.RETURN_MAN_SEQ
			 , '00001' AS CHANGE_SEQ
			 , '00' AS CHANGE_FLAG
		  FROM TPAGOODS PG
			 , TPANAVERGOODS PNG
		 WHERE PG.GOODS_CODE = PNG.GOODS_CODE
		   AND NOT EXISTS ( SELECT '1'
							  FROM TPAENTPSLIP PE
							 WHERE PE.ENTP_CODE = PG.ENTP_CODE
							   AND PE.ENTP_MAN_SEQ = PG.RETURN_MAN_SEQ
							   AND PE.PA_CODE ='41' )
		   AND NOT EXISTS ( SELECT '1'
							  FROM TPANAVERENTPADDRESS NEA
							  WHERE PG.ENTP_CODE||PG.RETURN_MAN_SEQ = NEA.NAME )
		   AND NOT EXISTS ( SELECT '1'
							  FROM TPAENTPSLIPCHANGE PNC
							 WHERE PG.ENTP_CODE = PNC.ENTP_CODE
							   AND PG.RETURN_MAN_SEQ = PNC.ENTP_MAN_SEQ
							   AND PNC.PA_CODE ='41' )
    </select>
    
    <select id="selectGoodsPaExceptList" resultType="hashMap" parameterType="hashMap" >
        WITH PAGOODS AS (
			SELECT A.PA_GROUP_CODE, A.PA_CODE, GOODS_CODE FROM TPANAVERGOODS A WHERE A.PA_SALE_GB = '20' AND A.PA_STATUS = '30'
		 UNION ALL
			SELECT A.PA_GROUP_CODE, A.PA_CODE, GOODS_CODE FROM TPASSGGOODS A WHERE A.PA_SALE_GB = '20' AND A.PA_STATUS = '30'
		)
			SELECT /*+INDEX (GD PK_TGOODS)*/
				   PA.PA_CODE
				 , PA.PA_GROUP_CODE
				 , PA.GOODS_CODE
			  FROM PAGOODS PA
				 , TGOODS GD
			 WHERE PA.GOODS_CODE = GD.GOODS_CODE
			   AND (EXISTS (SELECT '1'
							  FROM TPAEXCEPTENTP PEE
							  LEFT OUTER JOIN TPAEXCEPTBRAND PEB ON PEE.EXCEPT_SEQ = PEB.EXCEPT_SEQ AND PEE.ENTP_CODE = PEB.ENTP_CODE AND PEB.USE_YN = '1'
							 WHERE PEE.USE_YN = '1'
							   AND PEE.ENTP_CODE = GD.ENTP_CODE
							   AND (PEE.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PEE.PA_GROUP_CODE, PA.PA_GROUP_CODE) > 0)
							   AND (PEE.ALL_BRAND_YN = '1' OR PEB.BRAND_CODE = GD.BRAND_CODE)
							   AND (PEE.SOURCING_MEDIA = '00' OR INSTR(PEE.SOURCING_MEDIA, GD.SOURCING_MEDIA) > 0) 
							   AND 1 = CASE WHEN PA.PA_GROUP_CODE IN ('01', '02', '03') AND PEE.ENTP_CODE = '109153'
											THEN 0
											ELSE 1 END)
				 OR EXISTS ( SELECT '1'
							   FROM TPATARGETEXCEPT PT
							  WHERE PT.TARGET_GB  = '00'
								AND PT.TARGET_CODE = GD.GOODS_CODE
								AND (PT.PA_GROUP_CODE_ALL_YN = '1' OR INSTR(PT.PA_GROUP_CODE,PA.PA_GROUP_CODE) > 0)
								AND PT.USE_YN = '1' ))
			   AND ROWNUM &lt; 1000
    </select>
    
    <update id="update11stGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.update11stGoodsExceptTrans */
        	   TPA11STGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '30'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE 	=  #{goodsCode, jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '20'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateGmktGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateGmktGoodsExceptTrans */
        	   TPAGMKTGOODS GG
           SET GG.TRANS_TARGET_YN = '1'
             , GG.PA_SALE_GB 	  = '30'
             , GG.PA_STATUS 	  = '30'
             , GG.MODIFY_DATE 	  = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE GG.GOODS_CODE 	  = #{goodsCode, jdbcType=VARCHAR}
           AND GG.PA_SALE_GB 	  = '20'
           AND GG.PA_STATUS 	  = '30'
           AND GG.PA_GROUP_CODE   = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateNaverGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateNaverGoodsExceptTrans */
        	   TPANAVERGOODS GG
           SET GG.TRANS_SALE_YN = '1'
             , GG.PA_SALE_GB 	= '30'
             , GG.PA_STATUS 	= '30'
             , GG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE GG.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
           AND GG.PA_SALE_GB 	= '20'
           AND GG.PA_STATUS 	= '30'
           AND GG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateCopnGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateCopnGoodsExceptTrans */
        	   TPACOPNGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '30'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '20'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateWempGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateWempGoodsExceptTrans */
        	   TPAWEMPGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '30'
             , PG.DISPLAY_YN 	= '0'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '20'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateIntpGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateIntpGoodsExceptTrans */
        	   TPAINTPGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '30'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '20'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
	<insert id="insertPaLtonGoodsDtMapping" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaLtonGoodsDtMapping by PaCommonController */
		       TPALTONGOODSDTMAPPING ( GOODS_CODE
		                             , GOODSDT_CODE
		                             , GOODSDT_SEQ
		                             , PA_CODE
		                             , GOODSDT_INFO
		                             , USE_YN
		                             , INSERT_ID
		                             , INSERT_DATE
		                             , MODIFY_ID
		                             , MODIFY_DATE
		                             )
		                        SELECT PD.GOODS_CODE
		                             , PD.GOODSDT_CODE
		                             , (SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(LD.GOODSDT_SEQ)) + 1), 3, '0'), '001') 
		                                  FROM TPALTONGOODSDTMAPPING LD
		                                 WHERE LD.GOODS_CODE   = GD.GOODS_CODE
		                                   AND LD.GOODSDT_CODE = GD.GOODSDT_CODE
		                                   AND LD.PA_CODE      = #{paCode,    jdbcType=VARCHAR})
		                             , #{paCode, jdbcType=VARCHAR}
		                             , GD.GOODSDT_INFO
		                             , '1'
		                             , '999999'
		                             , SYSDATE
		                             , '999999'
		                             , SYSDATE
		                          FROM TPAGOODSDT PD
		                             , TGOODSDT GD
		                         WHERE PD.GOODS_CODE   = #{goodsCode, jdbcType=VARCHAR}
		                           AND PD.GOODS_CODE   = GD.GOODS_CODE
		                           AND PD.GOODSDT_CODE = GD.GOODSDT_CODE
		                           AND GD.SALE_GB &lt;&gt; '19'
		                           AND NOT EXISTS ( SELECT '1'
		                                              FROM TPALTONGOODSDTMAPPING GDS
		                                             WHERE GDS.GOODS_CODE   = GD.GOODS_CODE
		                                               AND GDS.GOODSDT_CODE = GD.GOODSDT_CODE
		                                               AND GDS.PA_CODE      = #{paCode, jdbcType=VARCHAR}
		                                          )
	</insert>
	
	<update id="updateLtonGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
       UPDATE /* pacommon.xml: pacommon.pacommon.updateLtonGoodsAuthTrans by PaCommonController */
       	   	  TPALTONGOODS PG
          SET PG.TRANS_SALE_YN = '1'
            , PG.PA_SALE_GB    = '20'
            , PG.PA_STATUS 	   = '30'
            , PG.MODIFY_DATE   = #{modifyDate,  jdbcType=TIMESTAMP}
        WHERE PG.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR}
          AND PG.PA_SALE_GB    = '30'
          AND PG.PA_STATUS 	   = '30'
          AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateLtonGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateLtonGoodsExceptTrans */
        	   TPALTONGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '30'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '20'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateLtonGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateLtonGoodsEventTrans by PaCommonController */
        	   TPALTONGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= SYSDATE
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updatePaLtonGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaLtonGoodsSaleGb by PaCommonController */
        	   TPALTONGOODS PALT
           SET PALT.PA_SALE_GB    = '30'
             , PALT.TRANS_SALE_YN = '1'
             , PALT.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PALT.MODIFY_ID     = '999999'
         WHERE PALT.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateLtonTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateLtonTrans by PaCommonController */
        	   TPALTONGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             <if test='massTargetYn != null and  massTargetYn == "1"'>
             , P.MASS_TARGET_YN		= #{massTargetYn	, jdbcType=VARCHAR}
             , P.MASS_TARGET_CODE	= #{massTargetCode	, jdbcType=VARCHAR}
             </if>
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updatePaLtonGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaLtonGoodsSync by PaCommonController */
        	   TPALTONGOODS P1
           SET P1.TRANS_TARGET_YN = '1'
             , P1.MODIFY_DATE 	  = SYSDATE
             , P1.BRD_NO    	  = ( SELECT NVL(BM.PA_BRAND_NO, '')    FROM TPABRANDMAPPING BM  WHERE BM.BRAND_CODE = #{newBrandCode, jdbcType=VARCHAR}    AND BM.PA_GROUP_CODE = P1.PA_GROUP_CODE)
             , P1.OPLC_CD		  = ( SELECT NVL(OM.PA_ORIGIN_CODE, '') FROM TPAORIGINMAPPING OM WHERE OM.ORIGIN_CODE = #{newOriginCode,  jdbcType=VARCHAR} AND OM.PA_GROUP_CODE = P1.PA_GROUP_CODE)
         WHERE P1.GOODS_CODE  	  = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <insert id="insertPaLtonAddShipCost">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaLtonAddShipCost by PaCommonController */
			   TPALTONADDSHIPCOST
			   SELECT PA_CODE
			   		, JEJU_COST
			   		, ISLAND_COST
			   		, ''
			   		, 'BATCH'
			   		, SYSDATE
			     FROM ( SELECT DISTINCT PC.PA_CODE
			     			 , JEJU_COST
			     			 , ISLAND_COST
						  FROM TPACUSTSHIPCOST PC
						 WHERE PC.PA_CODE IN ('81', '82')
					       AND ( PC.JEJU_COST &gt; 1 OR PC.ISLAND_COST &gt; 0 )
					       AND NOT EXISTS ( SELECT 1
					       					  FROM TPALTONADDSHIPCOST PLA
					       					 WHERE PC.PA_CODE     = PLA.PA_CODE
					       					   AND PC.JEJU_COST   = PLA.JEJU_COST
					       					   AND PC.ISLAND_COST = PLA.ISLAND_COST )
			          )
	</insert>
	
    <insert id="insertPaSsgShipCost">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaSsgShipCost by PaCommonController */
			   TPASSGSHIPCOST
		WITH SSGSHIPCOST AS (
		SELECT A.PA_CODE
			 , SUBSTR(A.SHIP_COST_CODE,0,2) AS SHIP_COST_FLAG
			 , A.SHIP_COST_BASE_AMT
			 , A.ORD_COST
			 , A.RETURN_COST
			 , DECODE(SIGN(A.ISLAND_COST - A.ORD_COST),1,A.ISLAND_COST - A.ORD_COST,0) AS ISLAND_COST
			 , DECODE(SIGN(A.JEJU_COST - A.ORD_COST),1,A.JEJU_COST - A.ORD_COST,0) AS JEJU_COST
			 , DECODE(SUBSTR(A.SHIP_COST_CODE,0,2),'FR','10','CN','10','PL','10','40') AS SHPPCST_APL_UNIT_CD
		  FROM TPACUSTSHIPCOST A
		 WHERE A.PA_CODE IN ('A1','A2')
							)

		SELECT distinct XA.PA_CODE
			 , null
			 , XA.SHPPCST_APL_UNIT_CD
			 , XA.SHPPCST_PLCY_DIV_CD
			 , '0'
			 , XA.SHIP_COST_BASE_AMT
			 , XA.SHIP_COST
			 , 'BATCH'
			 , SYSDATE
		  FROM ( SELECT A.PA_CODE
					  , A.SHPPCST_APL_UNIT_CD
					  , '10' AS SHPPCST_PLCY_DIV_CD
					  , A.SHIP_COST_BASE_AMT
					  , A.ORD_COST AS SHIP_COST
				   FROM SSGSHIPCOST A
				  WHERE NOT EXISTS ( SELECT 1
				   FROM TPASSGSHIPCOST B
				  WHERE B.PA_CODE = A.PA_CODE
					AND B.SHPPCST_PLCY_DIV_CD = '10'
					AND B.SHPPCST_APL_UNIT_CD = A.SHPPCST_APL_UNIT_CD
					AND B.SHIP_COST_BASE_AMT = A.SHIP_COST_BASE_AMT
					AND B.SHIP_COST = A.ORD_COST
				)

        UNION ALL

		SELECT A.PA_CODE
			 , '10' AS SHPPCST_APL_UNIT_CD
			 , '20' AS SHPPCST_PLCY_DIV_CD
			 , 0
			 , A.RETURN_COST AS SHIP_COST
		  FROM SSGSHIPCOST A
		 WHERE NOT EXISTS ( SELECT 1
							  FROM TPASSGSHIPCOST B
							 WHERE B.PA_CODE = A.PA_CODE
							   AND B.SHPPCST_PLCY_DIV_CD = '20'
							   AND B.SHPPCST_APL_UNIT_CD = '10'
							   AND B.SHIP_COST = A.RETURN_COST
						  )
                  
        UNION ALL

        SELECT A.PA_CODE
        	 , A.SHPPCST_APL_UNIT_CD
        	 , '60' AS SHPPCST_PLCY_DIV_CD
        	 , 0
        	 , A.ISLAND_COST AS SHIP_COST
		  FROM SSGSHIPCOST A
		 WHERE NOT EXISTS ( SELECT 1
							  FROM TPASSGSHIPCOST B
							 WHERE B.PA_CODE = A.PA_CODE
							   AND B.SHPPCST_PLCY_DIV_CD = '60'
							   AND B.SHPPCST_APL_UNIT_CD = A.SHPPCST_APL_UNIT_CD
							   AND B.SHIP_COST = A.ISLAND_COST
						  )

        UNION ALL
        
        SELECT A.PA_CODE
			 , A.SHPPCST_APL_UNIT_CD
			 , '70' AS SHPPCST_PLCY_DIV_CD
			 , 0
			 , A.JEJU_COST AS SHIP_COST
		  FROM SSGSHIPCOST A
		 WHERE NOT EXISTS ( SELECT 1
							  FROM TPASSGSHIPCOST B
							 WHERE B.PA_CODE = A.PA_CODE
							   AND B.SHPPCST_PLCY_DIV_CD = '70'
							   AND B.SHPPCST_APL_UNIT_CD = A.SHPPCST_APL_UNIT_CD
							   AND B.SHIP_COST = A.JEJU_COST
						  )
			   ) XA
	</insert>
	
	<insert id="insertPaLtonGoodsDtMappingData" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaLtonGoodsDtMappingData by PaCommonController */
	           TPALTONGOODSDTMAPPING ( GOODS_CODE
	                                 , GOODSDT_CODE
	                                 , GOODSDT_SEQ
	                                 , PA_CODE
	                                 , PA_OPTION_CODE
	                                 , GOODSDT_INFO
	                                 , USE_YN
	                                 , TRANS_ORDER_ABLE_QTY
	                                 , INSERT_ID
	                                 , INSERT_DATE
	                                 , MODIFY_ID
	                                 , MODIFY_DATE )
		            SELECT PD.GOODS_CODE
		                 , PD.GOODSDT_CODE
		                 , '001'
		                 , PG.PA_CODE
		                 , ''
		                 , #{goodsdtInfo, jdbcType=VARCHAR}
		                 , '1'
		                 , 0
		                 , '999999'
		                 , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		                 , '999999'
		                 , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		              FROM TPAPRODUCTOPTION PD
		                 , TPALTONGOODS PG
		             WHERE PD.GOODS_CODE   = PG.GOODS_CODE
		               AND PD.GOODS_CODE   = #{goodsCode,   jdbcType=VARCHAR}
		               AND PD.GOODSDT_CODE = #{goodsdtCode, jdbcType=VARCHAR}
		               AND NOT EXISTS ( SELECT 1 
		                                  FROM TPALTONGOODSDTMAPPING LMP 
		                                 WHERE LMP.PA_CODE      = PG.PA_CODE 
		                                   AND LMP.GOODS_CODE   = PD.GOODS_CODE 
		                                   AND LMP.GOODSDT_CODE = PD.GOODSDT_CODE )
	</insert>
	
	<select id="selectPaLtonGoodsdtCnt" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaLtonGoodsdtCnt by PaCommonController */
		       CASE WHEN COUNT(1) &lt;= 500 THEN 1
                 	ELSE 0
               		END
          FROM TGOODSDT GD
         WHERE GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
         GROUP BY GOODS_CODE
	</select>
	
	<select id="selectPaSsgGoodsdtCnt" parameterType="String" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaSsgGoodsdtCnt by PaCommonController */
		       CASE WHEN COUNT(1) &lt;= 100 THEN 1
                 	ELSE 0
               		END
          FROM TGOODSDT GD
         WHERE GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
         GROUP BY GOODS_CODE
	</select>
	
	<select id="selectPaLtonSsgGoodsDtInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
    	SELECT /* pacommon.xml: pacommon.pacommon.selectPaLtonSsgGoodsDtInfoList by PaCommonController */
    		   DM.PA_CODE
		     , DM.GOODS_CODE
		     , DM.GOODSDT_CODE
		     , GD.GOODSDT_INFO
		  FROM TPAPRODUCTOPTION GD
		     , TPALTONGOODSDTMAPPING DM
		 WHERE GD.GOODS_CODE   = DM.GOODS_CODE
		   AND GD.GOODSDT_CODE = DM.GOODSDT_CODE
		   AND DM.PA_CODE IN ('81', '82')
		   AND DM.ROWID = (SELECT /*+ INDEX_DESC (DM2 PK_TPALTONGOODSDTMAPPING) */
		                          DM2.ROWID
		                     FROM TPALTONGOODSDTMAPPING DM2
		                    WHERE DM.PA_CODE 	  = DM2.PA_CODE
		                      AND DM.GOODS_CODE   = DM2.GOODS_CODE
		                      AND DM.GOODSDT_CODE = DM2.GOODSDT_CODE
		                      AND ROWNUM = 1 )
		   AND GD.GOODSDT_INFO &lt;&gt; DM.GOODSDT_INFO
		   <if test='goodsCode != null and goodsCode != ""'>
			  AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		   </if>

	 UNION ALL

		SELECT DM.PA_CODE
		     , DM.GOODS_CODE
		     , DM.GOODSDT_CODE
		     , GD.GOODSDT_INFO
		  FROM TPAGOODSDT GD
		     , TPASSGGOODSDTMAPPING DM
		 WHERE GD.GOODS_CODE   = DM.GOODS_CODE
		   AND GD.GOODSDT_CODE = DM.GOODSDT_CODE
		   AND DM.PA_CODE IN ('A1', 'A2')
		   AND DM.ROWID = (SELECT /*+ INDEX_DESC (DM2 PK_TPASSGGOODSDTMAPPING) */
		                          DM2.ROWID
		                     FROM TPASSGGOODSDTMAPPING DM2
		                    WHERE DM.PA_CODE 	  = DM2.PA_CODE
		                      AND DM.GOODS_CODE   = DM2.GOODS_CODE
		                      AND DM.GOODSDT_CODE = DM2.GOODSDT_CODE
		                      AND ROWNUM = 1 )
		   AND GD.GOODSDT_INFO &lt;&gt; DM.GOODSDT_INFO
		   <if test='goodsCode != null and goodsCode != ""'>
			  AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		   </if>
		   
	</select>
	
	<update id="updateLtonGoodsDtInfo" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateLtonGoodsDtInfo by PaCommonController */
        	   TPALTONGOODSDTMAPPING PLM
           SET PLM.USE_YN = '0'
             , PLM.MODIFY_DATE = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PLM.PA_CODE      = #{paCode, 	 jdbcType=VARCHAR}
           AND PLM.GOODS_CODE   = #{goodsCode,   jdbcType=VARCHAR}
           AND PLM.GOODSDT_CODE = #{goodsdtCode, jdbcType=VARCHAR}
    </update>
    
    <insert id="insertPaLtonGoodsDtMappingUdata" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaLtonGoodsDtMappingUdata by PaCommonController */
	           TPALTONGOODSDTMAPPING ( GOODS_CODE
	                                 , GOODSDT_CODE
	                                 , GOODSDT_SEQ
	                                 , PA_CODE
	                                 , PA_OPTION_CODE
	                                 , GOODSDT_INFO
	                                 , USE_YN
	                                 , TRANS_ORDER_ABLE_QTY
	                                 , INSERT_ID
	                                 , INSERT_DATE
	                                 , MODIFY_ID
	                                 , MODIFY_DATE 
	                                 )
                           	  SELECT   #{goodsCode,   jdbcType=VARCHAR}
	                         	     , #{goodsdtCode, jdbcType=VARCHAR}
	                         	     , ( SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(LD.GOODSDT_SEQ)) + 1), 3, '0'), '001') 
			                               FROM TPALTONGOODSDTMAPPING LD
			                              WHERE LD.GOODS_CODE   = #{goodsCode,   jdbcType=VARCHAR}
			                                AND LD.GOODSDT_CODE = #{goodsdtCode, jdbcType=VARCHAR}
			                                AND LD.PA_CODE      = #{paCode,      jdbcType=VARCHAR} )
			                         , #{paCode,      jdbcType=VARCHAR}
			                         , ''
			                         , #{goodsdtInfo, jdbcType=VARCHAR}
			                         , '1'
			                         , 0
			                         , '999999'
			                         , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
					                 , '999999'
					                 , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') 
                           	    FROM DUAL
	</insert>
	
	<update id="updateTargetAytoYn" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateTargetAytoYn by PaCommonController */
        	   TPAGOODSTARGET PGT
           SET PGT.AUTO_YN 		 = '0'
             , PGT.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY-MM-DD HH24:MI:SS')
         WHERE PGT.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND PGT.PA_CODE 		 = #{paCode, 	  jdbcType=VARCHAR}
           AND PGT.GOODS_CODE 	 = #{goodsCode,   jdbcType=VARCHAR}
    </update>
    
    <select id="selectLtonDisplayCategoryList" resultType="hashMap" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
    	SELECT /* pacommon.xml: pacommon.pacommon.selectLtonDisplayCategoryList by PaCommonController */
    		   LISTAGG(DISP_CAT_ID, ',') 
    	  FROM TPALTONSTANDARDDISPLIST
    	 WHERE STD_CAT_ID = #{paLmsdKey, jdbcType=VARCHAR}
    </select>
    
    <select id="selectGetPromoMargin" parameterType="hashMap" resultType="double">
		SELECT FUN_GET_PAPROMO_MARGIN_TEST( #{goodsCode,jdbcType=VARCHAR} , #{mode,jdbcType=VARCHAR} ,#{outOwnPrice,jdbcType=NUMERIC} ,#{paCode,jdbcType=NUMERIC} ,#{paGroupCode,jdbcType=NUMERIC} )		
		  FROM DUAL    
	</select>
    
    <insert id="insertPaTmonGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaTmonGoods by PaCommonController */
			   TPATMONGOODS( PA_CODE
                           , GOODS_CODE
                           , PA_GROUP_CODE
                           , MANAGED_TITLE
                           , TITLE
                           , PA_SALE_GB
                           , PA_STATUS
                           , CATEGORY_NO
                           , TRANS_TARGET_YN
                           , TRANS_SALE_YN
                           , BRAND_NAME
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE
                           )
                    VALUES ( #{paCode,       jdbcType=VARCHAR}
                           , #{goodsCode,    jdbcType=VARCHAR}
                           , #{paGroupCode,  jdbcType=VARCHAR}
                           , #{goodsName,	 jdbcType=VARCHAR}
                           , #{goodsName,	 jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,    jdbcType=VARCHAR}
                           , '1'
                           , '1'
                           , (SELECT BRAND_NAME FROM TBRAND WHERE BRAND_CODE = #{brandCode, jdbcType=VARCHAR})
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}
                           )
	</insert>
	
    <insert id="insertPaSsgGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaSsgGoods by PaCommonController */
			   TPASSGGOODS( PA_CODE
                          , GOODS_CODE
                          , PA_GROUP_CODE
                          , GOODS_NAME
                          , PA_SALE_GB
                          , PA_STATUS
                          , STD_CTG_ID
                          , TRANS_TARGET_YN
                          , TRANS_SALE_YN
                          , BRAND_ID
                          , MANUFCO_NM
                          , ORPLC_ID
                          , INSERT_ID
                          , INSERT_DATE
                          , MODIFY_ID
                          , MODIFY_DATE
                          , MASS_TARGET_YN
                          , MASS_TARGET_CODE
                          <if test='offerType != null and offerType == "20"'>
                          , LAST_FOOD_SYNC_DATE
                          </if>
                           )
                    VALUES ( #{paCode,       jdbcType=VARCHAR}
                           , #{goodsCode,    jdbcType=VARCHAR}
                           , #{paGroupCode,  jdbcType=VARCHAR}
                           , #{goodsNameMc,	 jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,    jdbcType=VARCHAR}
                           , '1'
                           , '1'
                           , #{brandNo,  jdbcType=VARCHAR}
                           , #{makecoName,	 jdbcType=VARCHAR}
                           , #{paOriginCode, jdbcType=VARCHAR}
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn, jdbcType=VARCHAR},'0')
                           , #{massTargetCode, 	 jdbcType=VARCHAR}
                           <if test='offerType != null and offerType == "20"'>
                           , SYSDATE
                           </if>
                           )
	</insert>
	
	<select id="selectGetMaxPromoTarget" parameterType="hashMap" resultType="String">
		SELECT FUN_GET_MAX_PAPROMOTARGET_TEST( #{goodsCode,jdbcType=VARCHAR} ,#{paCode,jdbcType=NUMERIC} ,#{paGroupCode,jdbcType=NUMERIC} )
		  FROM DUAL    
	</select>
	
	<select id="selectLastPromoTransDate" parameterType="hashMap" resultType="hashMap">
        SELECT  /* pacommon.xml: pacommon.pacommon.selectLastPromoTransDate by PaCommonController */
        		DISTINCT TRANS_DATE 
          FROM (
                SELECT TO_CHAR(MAX(TP.TRANS_DATE), 'YYYYMMDDHH24MISS') AS TRANS_DATE 
                     , ALCOUT_PROMO_YN
                     , TP.GOODS_CODE
                     , TP.PA_CODE
                     , TP.PA_GROUP_CODE
                  FROM TPAPROMOTARGET TP
                     , TPROMOM PM
                 WHERE PM.PROMO_NO   = TP.PROMO_NO 
                   AND TP.GOODS_CODE = #{goodsCode	,   jdbcType=VARCHAR}
                   AND TP.PA_CODE    = #{paCode		,   jdbcType=VARCHAR}
                   AND TP.PA_GROUP_CODE like '%' ||  #{paGroupCode	,   jdbcType=VARCHAR}  || '%'
                 GROUP BY PM.ALCOUT_PROMO_YN , TP.GOODS_CODE ,TP.PA_CODE ,TP.PA_GROUP_CODE )
	</select>
	
	<select id="selectPaPromoTargetOverMarginList" parameterType="hashMap" resultType="hashMap">
	   SELECT /* pacommon.xml: pacommon.pacommon.selectPaPromoTargetOverMarginList by PaCommonController */
	   		  PROMO_NO_OUT
            , SEQ_OUT
            , PROMO_NO_SD
            , SEQ_SD
         FROM (
               SELECT  PPMT.PROC_GB     AS PROC_GB_OUT
                     , PPMT.PROMO_NO    AS PROMO_NO_OUT
                     , PPMT.PA_CODE     AS PA_CODE_OUT
                     , PPMT.GOODS_CODE  AS GOODS_CODE_OUT
                     , PPMT.SEQ         AS SEQ_OUT
                     , PPMT.DO_AMT      AS DO_COST_OUT
                     , PPMT.OWN_COST    AS OWN_COST_OUT
                     , PPMT.INSERT_DATE AS INSERT_DATE_OUT
                     , PPMT.TRANS_DATE  AS TRANS_DATE_OUT
                  FROM TPAPROMOTARGET PPMT
                     , TPROMOM PM
                     , TPPROMOTARGET   PT
                 WHERE PPMT.USE_CODE           = '00'
                   AND PT.PROMO_NO             = PPMT.PROMO_NO
                   AND PT.GOODS_CODE           = PPMT.GOODS_CODE
                   AND PT.GIFT_AMT             = DECODE(PPMT.AMT_RATE_FLAG ,1, PPMT.DO_AMT , PPMT.DO_RATE)
                   AND SYSDATE BETWEEN PPMT.PROMO_BDATE AND PPMT.PROMO_EDATE
                   AND SYSDATE BETWEEN PM.PROMO_BDATE   AND PM.PROMO_EDATE
                   AND PPMT.GOODS_CODE         = #{goodsCode	,   jdbcType=VARCHAR}
                   AND PPMT.PA_CODE            = #{paCode		,   jdbcType=VARCHAR}
                   AND PPMT.PA_GROUP_CODE LIKE '%' ||  #{paGroupCode	,   jdbcType=VARCHAR}  || '%'
                   AND PPMT.PROMO_NO           = PM.PROMO_NO
                   AND PM.COUPON_YN            = '1'
                   AND PM.IMMEDIATELY_YN       = '1'
                   AND NVL(PM.ALCOUT_PROMO_YN, '0')  =  '1'
                   AND PROC_GB              != 'D'
                   AND PPMT.ROWID            = (SELECT /*+INDEX_DESC (PTT IDX_TPAPROMOTARGET_02)*/
                                                      ROWID
                                                  FROM TPAPROMOTARGET PTT
                                                 WHERE PTT.PROMO_NO    = PPMT.PROMO_NO
                                                   AND PTT.PA_CODE     = PPMT.PA_CODE
                                                   AND PTT.GOODS_CODE  = PPMT.GOODS_CODE
                                                   <if test='paGroupCode != null and paGroupCode != ""'>
                                                   AND PTT.PA_GROUP_CODE LIKE '%'|| PPMT.PA_GROUP_CODE || '%'
                                                   </if>                                                  
                                                   AND PTT.PROC_GB    != 'D'
                                                   AND PTT.USE_CODE    = '00'
                                                   AND PTT.DO_AMT      > 0
                                                   AND ROWNUM = 1 )
                    AND NOT EXISTS (
                                    SELECT 'X'
                                      FROM TPAPROMOTARGET PPMT3
                                     WHERE PPMT3.PROMO_NO      = PPMT.PROMO_NO
                                       AND PPMT3.PA_CODE       = PPMT.PA_CODE
                                       AND PPMT3.GOODS_CODE    = PPMT.GOODS_CODE
                                       AND PPMT3.INSERT_DATE   > PPMT.INSERT_DATE
                                       AND PPMT3.PROC_GB       = 'D')
          ) A,(
                SELECT PPMT.PROC_GB     AS PROC_GB_SD
                     , PPMT.PROMO_NO    AS PROMO_NO_SD
                     , PPMT.PA_CODE     AS PA_CODE_SD
                     , PPMT.GOODS_CODE  AS GOODS_CODE_SD
                     , PPMT.SEQ         AS SEQ_SD
                     , PPMT.DO_AMT      AS DO_COST_SD
                     , PPMT.OWN_COST    AS OWN_COST_SD
                     , PPMT.INSERT_DATE AS INSERT_DATE_SD
                     , PPMT.TRANS_DATE  AS TRANS_DATE_SD 
                  FROM TPAPROMOTARGET PPMT
                     , TPROMOM PM
                     , TPPROMOTARGET   PT
                 WHERE PPMT.USE_CODE = '00'
                   AND PT.PROMO_NO   = PPMT.PROMO_NO
                    AND PT.GOODS_CODE = PPMT.GOODS_CODE
                    AND PT.GIFT_AMT = DECODE(PPMT.AMT_RATE_FLAG ,1, PPMT.DO_AMT , PPMT.DO_RATE)
                    AND SYSDATE BETWEEN PPMT.PROMO_BDATE AND PPMT.PROMO_EDATE
                    AND SYSDATE BETWEEN PM.PROMO_BDATE   AND PM.PROMO_EDATE
                   AND PPMT.GOODS_CODE         = #{goodsCode	,   jdbcType=VARCHAR}
                   AND PPMT.PA_CODE            = #{paCode		,   jdbcType=VARCHAR}
                   AND PPMT.PA_GROUP_CODE LIKE '%' ||  #{paGroupCode	,   jdbcType=VARCHAR}  || '%'
                    AND PPMT.PROMO_NO           = PM.PROMO_NO
                    AND PM.COUPON_YN            = '1'
                    AND PM.IMMEDIATELY_YN       = '1'
                    AND NVL(PM.ALCOUT_PROMO_YN, '0')  =  '0'
                    AND PROC_GB              != 'D'
                    AND PPMT.ROWID            = (SELECT /*+INDEX_DESC (PTT IDX_TPAPROMOTARGET_02)*/
                                                        ROWID
                                                   FROM TPAPROMOTARGET PTT
                                                  WHERE PTT.PROMO_NO    = PPMT.PROMO_NO
                                                    AND PTT.PA_CODE     = PPMT.PA_CODE
                                                    AND PTT.GOODS_CODE  = PPMT.GOODS_CODE
                                                    <if test='paGroupCode != null and paGroupCode != ""'>
                                                    AND PTT.PA_GROUP_CODE LIKE '%'|| PPMT.PA_GROUP_CODE || '%'
                                                    </if>
                                                    AND PTT.PROC_GB    != 'D'
                                                    AND PTT.USE_CODE    = '00'
                                                    AND PTT.DO_AMT      > 0
                                                    AND ROWNUM = 1 )
                    AND NOT EXISTS (
                                    SELECT 'X'
                                      FROM TPAPROMOTARGET PPMT3
                                     WHERE PPMT3.PROMO_NO      = PPMT.PROMO_NO
                                       AND PPMT3.PA_CODE       = PPMT.PA_CODE
                                       AND PPMT3.GOODS_CODE    = PPMT.GOODS_CODE
                                       AND PPMT3.INSERT_DATE   > PPMT.INSERT_DATE
                                       AND PPMT3.PROC_GB       = 'D')) B
               WHERE 1 = 1
               <choose>
               <when test='transDate != null and transDate != ""' >                   
                 AND A.OWN_COST_OUT + B.OWN_COST_SD >  #{limitMarginAmt	,   jdbcType=NUMERIC}
                 AND (INSERT_DATE_OUT > TO_DATE( #{transDate	,   jdbcType=VARCHAR} , 'YYYYMMDDHH24MISS')
                 		OR INSERT_DATE_SD  > TO_DATE( #{transDate	,   jdbcType=VARCHAR} , 'YYYYMMDDHH24MISS'))
               </when>
               <otherwise>
                 AND A.OWN_COST_OUT + B.OWN_COST_SD >=  #{limitMarginAmt	,   jdbcType=NUMERIC}
               </otherwise>
               </choose>
	</select>
	
    <update id="updateExceptReason"  parameterType="hashMap">
		UPDATE /* pacommon.xml: pacommon.pacommon.updateExceptReason by PaCommonController */
			   TPAPROMOTARGET T
		   SET T.EXCEPT_REASON = #{exceptReason	, jdbcType=VARCHAR} || TO_CHAR(SYSDATE , 'YYYY/MM/DD HH24:MI:SS')
		 WHERE T.PROMO_NO      = #{promoNo		, jdbcType=VARCHAR} 
		   AND T.SEQ		   = #{seq			, jdbcType=VARCHAR}
		   AND T.PA_CODE       = #{paCode		, jdbcType=VARCHAR} 
		   AND T.GOODS_CODE	   = #{goodsCode	, jdbcType=VARCHAR}
		   AND T.USE_CODE 	   = '00'
		   AND T.PROC_GB	  != 'D'
		   AND T.EXCEPT_REASON IS NULL 
		   <if test='transDate != null and transDate != ""'>
		   AND T.INSERT_DATE   > TO_DATE( #{transDate	,   jdbcType=VARCHAR} , 'YYYYMMDDHH24MISS')
		   </if>
    </update>
	 
	 <update id="updateExceptReasonByGoodsCode"  parameterType="hashMap">
		UPDATE /* pacommon.xml: pacommon.pacommon.updateExceptReasonByGoodsCode by PaCommonController */
			   TPAPROMOTARGET T
		   SET T.EXCEPT_REASON = #{exceptReason		, 	jdbcType=VARCHAR} || TO_CHAR(SYSDATE , 'YYYY/MM/DD HH24:MI:SS')
		 WHERE T.PA_CODE       = #{paCode			, 	jdbcType=VARCHAR} 
		   AND T.GOODS_CODE	   = #{goodsCode		, 	jdbcType=VARCHAR}
		   AND T.USE_CODE 	   = '00'
		   AND T.PROC_GB	  != 'D'
		   <if test='transDate != null and transDate != ""'>
		   AND T.INSERT_DATE   > TO_DATE( #{transDate	,   jdbcType=VARCHAR} , 'YYYYMMDDHH24MISS')
		   </if>
		   AND T.OWN_COST	   > #{limitMarginAmt	,   jdbcType=NUMERIC}
    </update>
    
	<update id="updateTmonGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
       UPDATE /* pacommon.xml: pacommon.pacommon.updateTmonGoodsAuthTrans by PaCommonController */
       	   	  TPATMONGOODS PG
          SET PG.TRANS_SALE_YN = '1'
            , PG.PA_SALE_GB    = '20'
            , PG.PA_STATUS 	   = '30'
            , PG.MODIFY_DATE   = #{modifyDate,  jdbcType=TIMESTAMP}
        WHERE PG.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR}
          AND PG.PA_SALE_GB    = '30'
          AND PG.PA_STATUS 	   = '30'
          AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateTmonGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateTmonGoodsExceptTrans */
        	   TPATMONGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '30'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '20'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateTmonGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateTmonGoodsEventTrans by PaCommonController */
        	   TPATMONGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= SYSDATE
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updatePaTmonGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaTmonGoodsSaleGb by PaCommonController */
        	   TPATMONGOODS PATM
           SET PATM.PA_SALE_GB    = '30'
             , PATM.TRANS_SALE_YN = '1'
             , PATM.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PATM.MODIFY_ID     = '999999'
         WHERE PATM.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
	<update id="updatePaTmonGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaTmonGoodsSync by PaCommonController */
        	   TPATMONGOODS P1
           SET P1.TRANS_TARGET_YN = '1'
           	 , P1.MANAGED_TITLE	  = #{newGoodsName, jdbcType=VARCHAR}
    	     , P1.TITLE			  = #{newGoodsName, jdbcType=VARCHAR}
    	     , P1.BRAND_NAME	  = #{newBrandName, jdbcType=VARCHAR}
             , P1.MODIFY_DATE 	  = SYSDATE
         WHERE P1.GOODS_CODE  	  = #{goodsCode, jdbcType=VARCHAR}
	</update>
    
	<update id="updateTmonTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateTmonTrans by PaCommonController */
        	   TPATMONGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
	</update>
	
	<update id="updateTmonStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateTmonStopSale */
               TPATMONGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
    <select id="selectCurTmonShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurTmonShipStopSaleList */ 
			   PG.GOODS_CODE
			 , IG.PA_CODE
			 , NVL(IG.DEAL_NO, IG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAPRODUCT   PG
			 , TPATMONGOODS IG
			 , TGOODS      GD
			 , TGOODSADDINFO AI
		 WHERE PG.GOODS_CODE     = IG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND GD.GOODS_CODE 	 = AI.GOODS_CODE
		   AND IG.PA_SALE_GB     = '20'
		   AND IG.PA_STATUS      = '30'
		   AND IG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE,'10','100001',PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND DECODE(GD.INSTALL_YN, '1', 'DP04', DECODE(AI.ORDER_CREATE_YN, '1', 'DP05', 'DP07')) = #{productType, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE, '10', '003', GD.SHIP_MAN_SEQ) = #{shipManSeq, jdbcType=VARCHAR}
           AND DECODE(GD.DELY_TYPE, '10', '002', GD.RETURN_MAN_SEQ) = #{returnManSeq, jdbcType=VARCHAR}
           AND NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = GD.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0) = #{noShipIsland, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
     <update id="updateTmonTransShipCost" parameterType="com.cware.netshopping.domain.PaCustShipCostVO">
        UPDATE /* pacommon.xml : pacommon.common.updateTmonTransShipCost */
               TPATMONGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId, jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                             , TGOODSADDINFO AI
                          WHERE G.GOODS_CODE = GD.GOODS_CODE
                            AND P.GOODS_CODE = G.GOODS_CODE
                            AND GD.GOODS_CODE = AI.GOODS_CODE                            
                            AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
                            AND DECODE(GD.INSTALL_YN, '1', 'DP04', DECODE(AI.ORDER_CREATE_YN, '1', 'DP05', 'DP07')) = #{productType, jdbcType=VARCHAR} 
                            AND DECODE(GD.DELY_TYPE, '10', '003', GD.SHIP_MAN_SEQ) = #{shipManSeq, jdbcType=VARCHAR}
                            AND DECODE(GD.DELY_TYPE, '10', '002', GD.RETURN_MAN_SEQ) = #{returnManSeq, jdbcType=VARCHAR} 
                            AND NVL((SELECT '1' FROM TDELYNOAREA DA WHERE DA.GOODS_CODE = GD.GOODS_CODE AND DA.AREA_GB IN ('20','30') AND ROWNUM = 1), 0) = #{noShipIsland, jdbcType=VARCHAR}
                            AND G.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
                      )
    </update>
    
    <update id="updateTmonTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateTmonTransEntpSlip */
               TPATMONGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId,   jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAPRODUCT G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE, '10', '100001', G.ENTP_CODE) = #{entpCode,   jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE, '10', '003', G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <select id="selectTmonCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectTmonCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.DEAL_NO, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPATMONGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;&gt; '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE &gt; SYSDATE - 30 ) XA
    </select>
    	
	<select id="selectOfferInfoListInsert" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.SpPaOfferInfo">
	    SELECT /* pacommon.xml: pacommon.pacommon.selectOfferInfoListInsert by PaCommonController */
	           'I' AS PROC_GB
	         , GOODS_CODE
	    	 , PA_GROUP_CODE
	    	 , OFFER_TYPE
	    	 , ''  AS OFFER_CODE
	    	 , ''  AS PA_OFFER_TYPE
	    	 , ''  AS PA_OFFER_CODE
	    	 , TO_CLOB('') AS OFFER_EXT
	      FROM (  
			    SELECT GD.GOODS_CODE
			         , OM.PA_GROUP_CODE
			         , GD.OFFER_TYPE
			         , CASE WHEN OM.PA_GROUP_CODE = '04' THEN (SELECT 1 FROM TPANAVERGOODS PA WHERE PA.GOODS_CODE = PG.GOODS_CODE AND PA.PA_STATUS = '30')
			                ELSE 0 END AS PA_STATUS
			      FROM TGOODS   GD
			         , TPAGOODS PG
			         , ( SELECT PA_GROUP_CODE
			                  , OFFER_TYPE
			               FROM TPAOFFERCODEMAPPING
			           GROUP BY PA_GROUP_CODE, OFFER_TYPE ) OM
			     WHERE GD.GOODS_CODE  = PG.GOODS_CODE
			       AND GD.MODIFY_DATE > PG.LAST_SYNC_DATE
			       AND GD.OFFER_TYPE = OM.OFFER_TYPE
			       AND NOT EXISTS ( SELECT '1'
			                          FROM TPAGOODSOFFER       PAOF
			                             , TPAOFFERCODEMAPPING PAOFM
			                         WHERE PAOF.PA_GROUP_CODE = PAOFM.PA_GROUP_CODE
			                           AND PAOF.PA_OFFER_TYPE = PAOFM.PA_OFFER_TYPE
			                           AND PAOF.USE_YN        = '1'
			                           AND PAOF.GOODS_CODE    = GD.GOODS_CODE
			                           AND PAOFM.OFFER_TYPE   = GD.OFFER_TYPE
			                           AND PAOFM.PA_GROUP_CODE = OM.PA_GROUP_CODE
			                      )
			       AND GD.MODIFY_DATE >= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
				<if test='goodsCode != null and goodsCode != ""'>
				   AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
		       )
		   WHERE PA_STATUS = 1
		   <!--  ORDER BY PA_GROUP_CODE, GOODS_CODE-->
	</select>
	
	<select id="selectOfferInfoListUpdate" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.SpPaOfferInfo">
		SELECT /* pacommon.xml: pacommon.pacommon.selectOfferInfoListUpdate by PaCommonController */
		       'U' AS PROC_GB
	         , T.GOODS_CODE
	         , P.PA_GROUP_CODE
	         , T.OFFER_TYPE
	         , T.OFFER_CODE
	         , M.PA_OFFER_TYPE
	         , M.PA_OFFER_CODE
	         , TO_CLOB(T.OFFER_CONTENTS) AS OFFER_EXT
	      FROM TGOODS              GD
	         , TOFFER              T
	         , TPAGOODSOFFER       P
	         , TPAOFFERCODEMAPPING M
	     WHERE GD.GOODS_CODE   = T.GOODS_CODE
	       AND GD.OFFER_TYPE   = T.OFFER_TYPE
	       AND T.GOODS_CODE    = P.GOODS_CODE
	       AND T.OFFER_TYPE    = M.OFFER_TYPE
	       AND T.OFFER_CODE    = M.OFFER_CODE
	       AND P.PA_OFFER_TYPE = M.PA_OFFER_TYPE
	       AND P.PA_OFFER_CODE = M.PA_OFFER_CODE
	       AND P.PA_GROUP_CODE = M.PA_GROUP_CODE
	       AND T.MODIFY_DATE   &gt; P.LAST_SYNC_DATE
	       AND P.USE_YN        = '1'
	       AND GD.MODIFY_DATE  &gt;= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') - 2
		<if test='goodsCode != null and goodsCode != ""'>
		   AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
		</if>
		   AND ROWNUM &lt; 30000 <!-- 대상이 너무 많아서 일단 매 배치마다 30000개만 가져오게 수정 -->
	</select>
	
	<select id="selectChkShipCost" parameterType="String" resultType="int">
        SELECT /* pacommon.xml: pacommon.pacommon.selectChkShipCost by PaCommonController */
               CASE WHEN SUBSTR(SHIP_COST_CODE,0,2) != 'QN'
               THEN
                  '1'
               ELSE
                  '0'
               END      
          FROM (    
                SELECT CD.ENTP_CODE
                      ,CD.SHIP_COST_CODE
                      ,SUM(DECODE(CUST_AREA_GB, '10', ORD_COST_AMT, 0))  AS ORD_COST_AMT_10
                      ,SUM(DECODE(CUST_AREA_GB, '10', RET_COST_AMT, 0))  AS RET_COST_AMT_10
                      ,SUM(DECODE(CUST_AREA_GB, '10', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT_10
                      ,SUM(DECODE(CUST_AREA_GB, '20', ORD_COST_AMT, 0))  AS ORD_COST_AMT_20
                      ,SUM(DECODE(CUST_AREA_GB, '20', RET_COST_AMT, 0))  AS RET_COST_AMT_20
                      ,SUM(DECODE(CUST_AREA_GB, '20', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT_20
                      ,SUM(DECODE(CUST_AREA_GB, '30', ORD_COST_AMT, 0))  AS ORD_COST_AMT_30
                      ,SUM(DECODE(CUST_AREA_GB, '30', RET_COST_AMT, 0))  AS RET_COST_AMT_30
                      ,SUM(DECODE(CUST_AREA_GB, '30', EXCH_COST_AMT, 0)) AS EXCH_COST_AMT_30  
                  FROM TSHIPCOSTDT CD, TGOODS TG  
                 WHERE CD.APPLY_DATE   = (SELECT MAX(APPLY_DATE)
                                            FROM TSHIPCOSTDT CD1
                                           WHERE CD1.ENTP_CODE      = CD.ENTP_CODE
                                             AND CD1.CUST_AREA_GB   IN ('10', '20', '30')
                                             AND CD1.SHIP_COST_CODE = CD.SHIP_COST_CODE
                                             AND CD1.APPLY_DATE     &lt; SYSDATE)
                 AND CD.ENTP_CODE      = DECODE(TG.DELY_TYPE, '10', '100001', TG.ENTP_CODE)
                 AND CD.SHIP_COST_CODE = TG.SHIP_COST_CODE
                 AND TG.GOODS_CODE 	   = #{goodsCode , jdbcType=VARCHAR}
            GROUP BY CD.ENTP_CODE, CD.SHIP_COST_CODE
            ) X
    </select>

    <select id="selectPaGoodsNameLength" parameterType="hashMap" resultType="int">
        SELECT /* pacommon.xml: pacommon.pacommon.selectPaGoodsNameLength by PaCommonController */
        	   COUNT(*)
		  FROM TPAGOODSTARGET TG
			 , TGOODS G
		 WHERE TG.GOODS_CODE = G.GOODS_CODE
		   AND TG.PA_GROUP_CODE = #{paGroupCode,jdbcType=VARCHAR}
		   AND TG.GOODS_CODE = #{goodsCode,jdbcType=VARCHAR}
		   AND TG.PA_GOODS_CODE IS NULL
		   AND TG.PA_SALE_GB IS NULL
		   AND 1 = CASE WHEN (TG.PA_GROUP_CODE = '11' AND (LENGTH(G.GOODS_NAME) > '50')) THEN 1
           		   ELSE 0 END
	</select>
	
	<select id="selectCheckMassSourcingCode" parameterType="String" resultType="int" >
        SELECT /* pacommon.xml : pacommon.common.selectCheckMassSourcingCode */ 
          	   COUNT(1) 
          FROM TCODE TC
         WHERE TC.CODE_LGROUP = 'B714'
           AND TC.CODE_MGROUP NOT IN ('SCM')
           AND TC.CODE_MGROUP = #{sourcingCode, jdbcType=VARCHAR}
    </select>
    
	<select id="selectGoodsCodeByEntpCode" parameterType="com.cware.netshopping.domain.model.PaEntpSlip" resultType="hashMap" >
 		SELECT /* pacommon.xml : pacommon.common.selectGoodsCodeByEntpCode */ 
 			   DISTINCT G.GOODS_CODE 
          FROM TPAGOODS G
             , TGOODS GD
         WHERE G.GOODS_CODE = GD.GOODS_CODE
           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) 	= #{entpCode	, jdbcType=VARCHAR}
           AND DECODE(GD.DELY_TYPE,'10','003',G.SHIP_MAN_SEQ)   = #{entpManSeq	, jdbcType=VARCHAR}
	</select>
	
	<select id="selectGoodsCodeByShipCostCode" parameterType="com.cware.netshopping.domain.PaCustShipCostVO" resultType="hashMap" >
 		SELECT /* pacommon.xml : pacommon.common.selectGoodsCodeByEntpCode */ 
 			   DISTINCT G.GOODS_CODE 
          FROM TPAGOODS G
             , TGOODS GD
         WHERE G.GOODS_CODE = GD.GOODS_CODE
           AND DECODE(GD.DELY_TYPE,'10','100001',G.ENTP_CODE) 	= #{entpCode	, jdbcType=VARCHAR}
           AND G.SHIP_COST_CODE 								= #{shipCostCode, jdbcType=VARCHAR}
	</select>
	
	<select id="selectGoodsCodeByShipCostCode4Tmon" parameterType="com.cware.netshopping.domain.PaCustShipCostVO" resultType="hashMap" >
		 SELECT /* pacommon.xml : pacommon.common.selectGoodsCodeByShipCostCode4Tmon */
		 		DISTINCT G.GOODS_CODE   
           FROM TPAGOODS G
              , TGOODS GD
              , TGOODSADDINFO AI
          WHERE G.GOODS_CODE = GD.GOODS_CODE
            AND GD.GOODS_CODE = AI.GOODS_CODE                            
            AND DECODE(GD.DELY_TYPE	 ,'10'	,'100001'	, G.ENTP_CODE) 										= #{entpCode	 , jdbcType=VARCHAR}
            AND DECODE(GD.INSTALL_YN , '1'	, 'DP04'	, DECODE(AI.ORDER_CREATE_YN, '1', 'DP05', 'DP07')) 	= #{productType	 , jdbcType=VARCHAR} 
            AND DECODE(GD.DELY_TYPE	 , '10'	, '003'		, GD.SHIP_MAN_SEQ)									= #{shipManSeq	 , jdbcType=VARCHAR}
            AND DECODE(GD.DELY_TYPE	 , '10'	, '002'		, GD.RETURN_MAN_SEQ) 								= #{returnManSeq , jdbcType=VARCHAR} 
            AND G.SHIP_COST_CODE 																			= #{shipCostCode , jdbcType=VARCHAR}									
            AND NVL(( SELECT '1' 
            			FROM TDELYNOAREA DA 
            		   WHERE DA.GOODS_CODE = GD.GOODS_CODE 
            			 AND DA.AREA_GB IN ('20','30') 
            			 AND ROWNUM = 1), 0) = #{noShipIsland, jdbcType=VARCHAR}
 	</select>
 	
 	<!-- 대량 입점  -->
    <select id="selectPaCheckGoods" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml: pacommon.pacommon.selectPaCheckGoods by PaCommonController */
               G.GOODS_CODE,
               NVL((SELECT CASE WHEN DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >=
                                            (SELECT DECODE(G.SOURCING_MEDIA, '01', REMARK, REMARK1)
                                               FROM TCODE
                                              WHERE CODE_LGROUP = 'O582'
                                                AND CODE_MGROUP = #{marginCode ,jdbcType=VARCHAR}) THEN 'Y'
                                WHEN (SELECT COUNT(1)
                                        FROM TPAGOODSEVENT SD
                                       WHERE SYSDATE BETWEEN SD.START_DATE AND SD.END_DATE 
                                         AND SD.PA_GROUP_CODE = #{paGroupCode,jdbcType=VARCHAR}
                                         AND SD.USE_YN = '1'
                                         AND DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >= TO_NUMBER(FUN_GETCONFIG('PA_EVENT_LIMIT_MARGIN'))
                                         AND SD.GOODS_CODE = G.GOODS_CODE) > 0 THEN 'Y'
                                ELSE 'N' END
                      FROM TGOODSPRICE GP
                     WHERE GP.GOODS_CODE = G.GOODS_CODE
                       AND GP.APPLY_DATE = (SELECT MAX(GPS.APPLY_DATE)
                                              FROM TGOODSPRICE GPS
                                             WHERE GPS.GOODS_CODE = G.GOODS_CODE
                                               AND GPS.APPLY_DATE &lt;= SYSDATE)),'N') AS MARGIN_RATE,
               NVL((SELECT CASE WHEN GP.SALE_PRICE >= (SELECT DECODE(SOURCING_MEDIA, '01', REMARK, REMARK1)
                                                         FROM TCODE
                                                        WHERE CODE_LGROUP = 'O582'
                                                          AND CODE_MGROUP = #{minpriceCode,jdbcType=VARCHAR}) THEN 'Y'
                                ELSE 'N' END
                      FROM TGOODSPRICE GP
                     WHERE GP.GOODS_CODE = G.GOODS_CODE
                       AND GP.APPLY_DATE = (SELECT MAX(GPS.APPLY_DATE)
                                              FROM TGOODSPRICE GPS
                                             WHERE GPS.GOODS_CODE = G.GOODS_CODE
                                               AND GPS.APPLY_DATE &lt; SYSDATE)),'N') AS SALE_PRICE_YN,
               CASE WHEN CEIL(fun_get_order_able_qty(G.GOODS_CODE, '', G.WH_CODE) * (SELECT TC.CODE_GROUP FROM TCODE TC WHERE TC.CODE_LGROUP = 'O505' AND TC.CODE_MGROUP = #{paCode,jdbcType=VARCHAR})) >= 3 THEN 'Y'
                    ELSE 'N' END AS STOCK_QTY,
               CASE WHEN G.OMBUDSMAN_YN = '0' THEN 'Y'
                    ELSE 'N' END AS OMBUDSMAN_YN,
               CASE WHEN G.BROAD_SALE_YN = '0' THEN 'Y'
                    ELSE 'N' END AS BROAD_SALE_YN,
               CASE WHEN G.INVI_GOODS_TYPE = '00' THEN 'Y'
                    ELSE 'N' END AS INVI_GOODS_TYPE_YN,
               CASE WHEN G.ORDER_MEDIA_ALL_YN = '1' OR INSTR(G.ORDER_MEDIA, '62') > 0 THEN 'Y'
                    ELSE 'N' END AS ORDER_MEDIA_YN,
               CASE WHEN NVL(G.SALE_END_DATE, SYSDATE + 1) > SYSDATE THEN 'Y'
                    ELSE 'N' END AS SALE_END_YN
          FROM TGOODS G
         WHERE G.GOODS_CODE = #{goodsCode,jdbcType=VARCHAR}
    </select>

    <select id="selectPa11stCheckGoods" parameterType="String" resultType="hashMap">
       SELECT /* pacommon.xml: pacommon.pacommon.selectPa11stCheckGoods by PaCommonController */
               G.GOODS_CODE,
               NVL((SELECT CASE
                             WHEN DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >=
                                            (SELECT DECODE(G.SOURCING_MEDIA, '01', REMARK, REMARK1)
                                              FROM TCODE
                                             WHERE CODE_LGROUP = 'O582'
                                               AND CODE_MGROUP = '10') THEN
                                'Y'
                             WHEN (SELECT COUNT(1)
                                     FROM TPAGOODSEVENT SD
                                    WHERE SYSDATE BETWEEN SD.START_DATE AND SD.END_DATE 
                                      AND SD.PA_GROUP_CODE = '01'
                                      AND SD.USE_YN = '1'
                                      AND DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >= TO_NUMBER(FUN_GETCONFIG('PA_EVENT_LIMIT_MARGIN'))
                                      AND SD.GOODS_CODE = G.GOODS_CODE) > 0 THEN
                                'Y'
                             ELSE
                                'N'
                            END
                      FROM TGOODSPRICE GP
                     WHERE GP.GOODS_CODE = G.GOODS_CODE
                       AND GP.APPLY_DATE =
                           (SELECT MAX(GPS.APPLY_DATE)
                              FROM TGOODSPRICE GPS
                             WHERE GPS.GOODS_CODE = G.GOODS_CODE
                               AND GPS.APPLY_DATE &lt;= SYSDATE)),'N') AS MARGIN_RATE,
               NVL((SELECT CASE
                             WHEN GP.SALE_PRICE >= (SELECT DECODE(SOURCING_MEDIA, '01', REMARK, REMARK1)
                                                      FROM TCODE
                                                     WHERE CODE_LGROUP = 'O582'
                                                       AND CODE_MGROUP = '20') THEN
                              'Y'
                             ELSE
                              'N'
                           END
                      FROM TGOODSPRICE GP
                     WHERE GP.GOODS_CODE = G.GOODS_CODE
                       AND GP.APPLY_DATE =
                           (SELECT MAX(GPS.APPLY_DATE)
                              FROM TGOODSPRICE GPS
                             WHERE GPS.GOODS_CODE = G.GOODS_CODE
                               AND GPS.APPLY_DATE &lt; SYSDATE)),'N') AS SALE_PRICE_YN,
               NVL((SELECT CASE
		                       WHEN DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >=
		                                   (SELECT DECODE(G.SOURCING_MEDIA, '01', REMARK, REMARK1)
		                                      FROM TCODE
		                                     WHERE CODE_LGROUP = 'O582'
		                                       AND CODE_MGROUP = '30') THEN
		                          'Y'
		                       WHEN (SELECT COUNT(1)
		                             FROM TPAGOODSEVENT SD
		                            WHERE SYSDATE BETWEEN SD.START_DATE AND SD.END_DATE 
		                              AND SD.PA_GROUP_CODE IN ('02', '03')
		                              AND SD.USE_YN = '1'
		                              AND DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >= TO_NUMBER(FUN_GETCONFIG('PA_EVENT_LIMIT_MARGIN'))
		                              AND SD.GOODS_CODE = G.GOODS_CODE) > 0 THEN
		                        'Y'
		                       ELSE
		                          'N'
		                      END
		                FROM TGOODSPRICE GP
		               WHERE GP.GOODS_CODE = G.GOODS_CODE
		                 AND GP.APPLY_DATE =
		                     (SELECT MAX(GPS.APPLY_DATE)
		                        FROM TGOODSPRICE GPS
		                       WHERE GPS.GOODS_CODE = G.GOODS_CODE
		                         AND GPS.APPLY_DATE &lt;= SYSDATE)),'N') AS MARGIN_RATE_GMKT,
		         NVL((SELECT CASE
		                       WHEN GP.SALE_PRICE >= (SELECT DECODE(SOURCING_MEDIA, '01', REMARK, REMARK1)
		                                    FROM TCODE
		                                   WHERE CODE_LGROUP = 'O582'
		                                     AND CODE_MGROUP = '40') THEN
		                        'Y'
		                       ELSE
		                        'N'
		                     END
		                FROM TGOODSPRICE GP
		               WHERE GP.GOODS_CODE = G.GOODS_CODE
		                 AND GP.APPLY_DATE =
		                     (SELECT MAX(GPS.APPLY_DATE)
		                        FROM TGOODSPRICE GPS
		                       WHERE GPS.GOODS_CODE = G.GOODS_CODE
		                         AND GPS.APPLY_DATE &lt; SYSDATE)),'N') AS SALE_PRICE_YN_GMKT,
               CASE
                 WHEN G.SOURCING_MEDIA = '01' THEN
                  CASE
                    WHEN CEIL(fun_get_order_able_qty(G.GOODS_CODE, '', G.WH_CODE) * C1.CODE_GROUP) >= 3 OR G.BUY_MED ='13' THEN
                        'Y'
                    ELSE
                        'N'
                     END
                 ELSE
                  CASE
                    WHEN CEIL(fun_get_order_able_qty(G.GOODS_CODE, '', G.WH_CODE) * C2.CODE_GROUP) >= 3 THEN
                     'Y'
                    ELSE
                     'N'
                  END
               END AS STOCK_QTY,
               CASE
                 WHEN G.OMBUDSMAN_YN = '0' THEN
                  'Y'
                 ELSE
                  'N'
               END AS OMBUDSMAN_YN,
               CASE
                 WHEN G.BROAD_SALE_YN = '0' THEN
                  'Y'
                 ELSE
                  'N'
               END AS BROAD_SALE_YN,
               CASE
                 WHEN G.INVI_GOODS_TYPE = '00' THEN
                  'Y'
                 ELSE
                  'N'
               END AS INVI_GOODS_TYPE_YN,
               CASE
                 WHEN G.ORDER_MEDIA_ALL_YN = '1' OR INSTR(G.ORDER_MEDIA, '62') > 0 THEN
                  'Y'
                 ELSE
                  'N'
               END AS ORDER_MEDIA_YN,
               CASE
                 WHEN NVL(G.SALE_END_DATE, SYSDATE + 1) > SYSDATE THEN
                  'Y'
                 ELSE
                  'N'
               END AS SALE_END_YN
        
          FROM TGOODS G, TCODE C1, TCODE C2
         WHERE C1.CODE_LGROUP = 'O505'
           AND C1.CODE_MGROUP = '11'
           AND C2.CODE_LGROUP = 'O505'
           AND C2.CODE_MGROUP = '12'
           AND G.GOODS_CODE = #{goodsCode ,jdbcType=VARCHAR}
    </select>   
    
	<select id="selectPaWempCheckGoods" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectPaWempCheckGoods */
               G.GOODS_CODE,
               NVL((SELECT CASE WHEN DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >=
                                            (SELECT DECODE(G.SOURCING_MEDIA, '01', REMARK, REMARK1)
                                               FROM TCODE
                                              WHERE CODE_LGROUP = 'O582'
                                                AND CODE_MGROUP = #{marginCode,jdbcType=VARCHAR}) THEN 'Y'
                                WHEN (SELECT COUNT(1)
                                        FROM TPAGOODSEVENT SD
                                       WHERE SYSDATE BETWEEN SD.START_DATE AND SD.END_DATE 
                                         AND SD.PA_GROUP_CODE = #{paGroupCode,jdbcType=VARCHAR}
                                         AND SD.USE_YN = '1'
                                         AND DECODE(GP.SALE_PRICE, 0, 0, ROUND((GP.SALE_PRICE - GP.BUY_PRICE) / GP.SALE_PRICE * 100, 2)) >= TO_NUMBER(FUN_GETCONFIG('PA_EVENT_LIMIT_MARGIN'))
                                         AND SD.GOODS_CODE = G.GOODS_CODE) > 0 THEN 'Y'
                                ELSE 'N' END
                      FROM TGOODSPRICE GP
                     WHERE GP.GOODS_CODE = G.GOODS_CODE
                       AND GP.APPLY_DATE = (SELECT MAX(GPS.APPLY_DATE)
                                              FROM TGOODSPRICE GPS
                                             WHERE GPS.GOODS_CODE = G.GOODS_CODE
                                               AND GPS.APPLY_DATE &lt;= SYSDATE)),'N') AS MARGIN_RATE,
               NVL((SELECT CASE WHEN GP.SALE_PRICE >= (SELECT DECODE(SOURCING_MEDIA, '01', REMARK, REMARK1)
                                                         FROM TCODE
                                                        WHERE CODE_LGROUP = 'O582'
                                                          AND CODE_MGROUP = #{minpriceCode,jdbcType=VARCHAR}) THEN 'Y'
                                ELSE 'N' END
                      FROM TGOODSPRICE GP
                     WHERE GP.GOODS_CODE = G.GOODS_CODE
                       AND GP.APPLY_DATE = (SELECT MAX(GPS.APPLY_DATE)
                                              FROM TGOODSPRICE GPS
                                             WHERE GPS.GOODS_CODE = G.GOODS_CODE
                                               AND GPS.APPLY_DATE &lt; SYSDATE)),'N') AS SALE_PRICE_YN,
               CASE WHEN CEIL(fun_get_order_able_qty(G.GOODS_CODE, '', G.WH_CODE) * #{paCode,jdbcType=VARCHAR}) >= 3 THEN 'Y'
                    ELSE 'N' END AS STOCK_QTY,
               CASE WHEN G.OMBUDSMAN_YN = '0' THEN 'Y'
                    ELSE 'N' END AS OMBUDSMAN_YN,
               CASE WHEN G.BROAD_SALE_YN = '0' THEN 'Y'
                    ELSE 'N' END AS BROAD_SALE_YN,
               CASE WHEN G.INVI_GOODS_TYPE = '00' THEN 'Y'
                    ELSE 'N' END AS INVI_GOODS_TYPE_YN,
               CASE WHEN G.ORDER_MEDIA_ALL_YN = '1' OR INSTR(G.ORDER_MEDIA, '62') > 0 THEN 'Y'
                    ELSE 'N' END AS ORDER_MEDIA_YN,
               CASE WHEN NVL(G.SALE_END_DATE, SYSDATE + 1) > SYSDATE THEN 'Y'
                    ELSE 'N' END AS SALE_END_YN,
               NVL(( SELECT 'N' 
					   FROM TPAAPITRACKING_LOG TR
					  WHERE TR.API_CODE = 'IF_PAWEMPAPI_01_001'
						AND TR.API_RESULT_CODE = '500'
						AND TR.TRACKING_NO > TO_CHAR(SYSDATE, 'YYYYMMDD')
						AND TR.INSERT_DATE > SYSDATE - 2/24
						AND TR.API_RESULT_MSG LIKE '%동일한%'
						AND TR.API_INPUT_PARAM LIKE '%' || G.GOODS_CODE || '%'
						AND rownum = 1 ),'Y') AS TRANS_FAIL
          FROM TGOODS G
         WHERE G.GOODS_CODE = #{goodsCode,jdbcType=VARCHAR}
    </select>
 	
 	
 	<!-- 대량 수정(동기화)  --> 	
 	<select id="selectMassTargetYn11stBySourcingCode" parameterType="hashMap" resultType="hashMap" >
         SELECT  /* pacommon.xml : pacommon.common.selectMassTargetYn11stBySourcingCode */
         		GD.SOURCING_CODE
              , PA_CODE
           FROM TPAPRODUCT   TG
              , TPA11STGOODS PG
              , TGOODS GD
              , TCODE TC
          WHERE TG.GOODS_CODE        = PG.GOODS_CODE
            AND TG.GOODS_CODE        = GD.GOODS_CODE
            AND PG.PA_STATUS         = '30'
            AND PG.PA_SALE_GB        = '20'
            AND TG.SALE_GB       	!= '19'
            AND GD.INVI_GOODS_TYPE   = '00'
            AND PG.TRANS_TARGET_YN   = '1'
          <!--    AND PG.MASS_TARGET_YN 	!= '1'-->
            AND TC.CODE_LGROUP       = 'B711'
            AND TC.CODE_MGROUP NOT IN ('SCM')
            AND TC.CODE_MGROUP       = GD.SOURCING_CODE
          GROUP BY GD.SOURCING_CODE
          	     , PG.PA_CODE
          HAVING COUNT(1) > #{checkCnt, jdbcType=NUMERIC} 
 	</select>
     
	<select id="selectMassTargetYnGmktBySourcingCode" parameterType="hashMap" resultType="hashMap" >
         SELECT  /* pacommon.xml : pacommon.common.selectMassTargetYnGmktBySourcingCode */
                G.SOURCING_CODE
              , GG.PA_CODE
          FROM TPAGMKTGOODS GG
             , TPAGOODS PG
             , TGOODS G
             , TCODE TC
         WHERE GG.GOODS_CODE    = PG.GOODS_CODE
           AND GG.PA_STATUS     = '30'
           AND PG.GOODS_CODE    = G.GOODS_CODE
           AND GG.TRANS_TARGET_YN = '1'
           AND GG.PA_SALE_GB    = '20'
           AND TC.CODE_LGROUP       = 'B711'
           AND TC.CODE_MGROUP NOT IN ('SCM') 
           AND TC.CODE_MGROUP       = G.SOURCING_CODE
           <!--AND GG.MASS_TARGET_YN 	   != '1'-->
         GROUP BY G.SOURCING_CODE , GG.PA_CODE
        HAVING COUNT(1) > #{checkCnt, jdbcType=NUMERIC} 
         
         UNION
         
         SELECT G.SOURCING_CODE
              , GG2.PA_CODE
           FROM TPAGMKTGOODS GG2
              , TPAGOODS PG2
              , TGOODS G
              , TCODE TC
          WHERE GG2.GOODS_CODE   = PG2.GOODS_CODE
            AND PG2.GOODS_CODE   = G.GOODS_CODE
            AND GG2.TRANS_TARGET_YN = '1'
            AND GG2.PA_STATUS       = '10'
            AND GG2.ITEM_NO IS NULL
            AND TC.CODE_LGROUP      = 'B711'
            AND TC.CODE_MGROUP NOT IN ('SCM') 
            AND TC.CODE_MGROUP      = G.SOURCING_CODE
            <!--AND GG2.MASS_TARGET_YN 	!= '1'-->
            AND EXISTS (SELECT '1'
                          FROM TPAGMKTGOODS GG3
                         WHERE GG3.GOODS_CODE = GG2.GOODS_CODE
                           AND GG3.PA_STATUS  = '30')
          GROUP BY G.SOURCING_CODE , GG2.PA_CODE
         HAVING COUNT(1) > #{checkCnt, jdbcType=NUMERIC}         
	</select>
	
	<select id="selectMassTargetYnCopnBySourcingCode" parameterType="hashMap" resultType="hashMap" >
          SELECT /* pacommon.xml : pacommon.common.selectMassTargetYnCopnBySourcingCode */
          		 PG.PA_CODE
               , T.SOURCING_CODE 
            FROM TPACOPNGOODS    PG
               , TGOODS          T
               , TCODE           TC
           WHERE PG.GOODS_CODE    = T.GOODS_CODE
             AND PG.TRANS_TARGET_YN   	= '1'
             AND PG.PA_SALE_GB    		= '20'
             AND PG.PA_STATUS IN ('30','40')
             AND TC.CODE_LGROUP   		= 'B711'
             AND TC.CODE_MGROUP       	= T.SOURCING_CODE
             AND TC.CODE_MGROUP NOT IN ('SCM') 
            <!--  AND PG.MASS_TARGET_YN 	   != '1'  -->
             GROUP BY SOURCING_CODE , PA_CODE
          HAVING COUNT(1) > #{checkCnt, jdbcType=NUMERIC} 
 	</select>
	
	<select id="selectMassTargetYnWempBySourcingCode" parameterType="hashMap" resultType="hashMap" >
	    SELECT /* pacommon.xml : pacommon.common.selectMassTargetYnWempBySourcingCode */
	           PG.PA_CODE 
	         , T.SOURCING_CODE   
	      FROM TPAPRODUCT      TG
	         , TPAWEMPGOODS    PG
	         , TGOODS          T
	         , TCODE           TC
	     WHERE TG.GOODS_CODE 		 = PG.GOODS_CODE
	       AND TG.GOODS_CODE 		 = T.GOODS_CODE
	       AND PG.TRANS_TARGET_YN    = '1'
	       AND PG.PA_SALE_GB 		 = '20'
	       AND PG.PA_STATUS  		 = '30'
           AND TC.CODE_LGROUP   	 = 'B711'
           AND TC.CODE_MGROUP        = T.SOURCING_CODE
           AND TC.CODE_MGROUP NOT IN ('SCM') 
           <!--  AND PG.MASS_TARGET_YN 	   != '1'  -->	       
	       AND NVL(T.SALE_END_DATE,SYSDATE+1) > SYSDATE
	       GROUP BY PG.PA_CODE 
	              , T.SOURCING_CODE
	       HAVING COUNT(1) >  #{checkCnt, jdbcType=NUMERIC} 
	</select>
	
	<select id="selectMassTargetYnIntpBySourcingCode" parameterType="hashMap" resultType="hashMap" >
	    SELECT /* pacommon.xml : pacommon.common.selectMassTargetYnIntpBySourcingCode */
	    	   PG.PA_CODE
	         , T.SOURCING_CODE
	      FROM TPAPRODUCT TG
	         , TPAINTPGOODS PG
	         , TGOODS T
			 , TCODE TC
	     WHERE TG.GOODS_CODE 	 = PG.GOODS_CODE
	       AND PG.GOODS_CODE 	 = T.GOODS_CODE
	       AND PG.PA_STATUS 	 = '30'
	       AND PG.TRANS_TARGET_YN = '1'
	       AND PG.PA_SALE_GB IN ('20', '30')
           AND TC.CODE_LGROUP   	 = 'B711'
           AND TC.CODE_MGROUP        = T.SOURCING_CODE
           AND TC.CODE_MGROUP NOT IN ('SCM') 
           <!--  AND PG.MASS_TARGET_YN 	   != '1'  -->	       	       
	       AND ((PG.PA_SALE_GB = 20 AND  NVL(T.SALE_END_DATE,SYSDATE+1) > SYSDATE )
	        OR (PG.PA_SALE_GB = 30))
	     GROUP BY PG.PA_CODE , T.SOURCING_CODE
	     HAVING COUNT(1) >  #{checkCnt, jdbcType=NUMERIC}
	</select>
	
	<select id="selectMassTargetYnLtonBySourcingCode" parameterType="hashMap" resultType="hashMap" >
		SELECT /* pacommon.xml : pacommon.common.selectMassTargetYnLtonBySourcingCode */
			   T.SOURCING_CODE
	         , PG.PA_CODE
	      FROM TPAGOODS TG
	         , TPALTONGOODS PG
	         , TGOODS T
	         , TCODE TC
	     WHERE TG.GOODS_CODE  = PG.GOODS_CODE
	       AND PG.GOODS_CODE  = T.GOODS_CODE
	       AND NVL(T.SALE_END_DATE, SYSDATE + 1) > SYSDATE
	       AND PG.TRANS_TARGET_YN 	= '1' 
	       AND PG.PA_SALE_GB        = '20'
	       AND PG.PA_STATUS         = '30'
	       AND PG.APPROVAL_STATUS   = '30'
           AND TC.CODE_LGROUP   	 = 'B711'
           AND TC.CODE_MGROUP        = T.SOURCING_CODE
           AND TC.CODE_MGROUP NOT IN ('SCM') 
           <!--  AND PG.MASS_TARGET_YN 	   != '1'  -->	 	       
	     GROUP BY T.SOURCING_CODE, PG.PA_CODE
	     HAVING COUNT(1) >  #{checkCnt, jdbcType=NUMERIC}	
	</select>
	
 	<update id="updateMassTargetYn11stBySourcingCode" parameterType="hashMap" >
         UPDATE /* pacommon.xml : pacommon.common.updateMassTargetYn11stBySourcingCode */
         		TPA11STGOODS PG
            SET MASS_TARGET_YN 	 	 = #{MASS_TARGET_YN		, jdbcType=VARCHAR} 
              , MASS_TARGET_CODE     = #{MASS_TARGET_CODE	, jdbcType=VARCHAR}
          WHERE PG.PA_CODE  		 = #{PA_CODE			, jdbcType=VARCHAR}
            AND PG.PA_STATUS         = '30'
            AND PG.PA_SALE_GB        = '20'
            AND PG.TRANS_TARGET_YN   = '1'
            AND MASS_TARGET_YN 		= 0
            AND EXISTS (SELECT 'X'
                          FROM TPAGOODS TG
                         WHERE TG.GOODS_CODE = PG.GOODS_CODE
                           AND TG.SALE_GB  != '19')        
            AND EXISTS (SELECT 'X' 
                          FROM TGOODS GD
                         WHERE GD.GOODS_CODE        = PG.GOODS_CODE
                           AND GD.SOURCING_CODE     = #{SOURCING_CODE, jdbcType=VARCHAR}
                           AND GD.INVI_GOODS_TYPE   = '00')
 	</update>
     
 	<update id="updateMassTargetYnGMKTBySourcingCode1" parameterType="hashMap" >
        UPDATE TPAGMKTGOODS GG  
           SET MASS_TARGET_YN   	= #{MASS_TARGET_YN		, jdbcType=VARCHAR} 
             , MASS_TARGET_CODE     = #{MASS_TARGET_CODE	, jdbcType=VARCHAR}         
         WHERE GG.PA_STATUS     	= '30'
           AND GG.TRANS_TARGET_YN 	= '1'
           AND GG.PA_SALE_GB    	= '20'
           AND GG.PA_CODE  		 	= #{PA_CODE, jdbcType=VARCHAR}
           AND MASS_TARGET_YN 		= 0
           AND EXISTS (SELECT 'X'
                         FROM TGOODS G
                        WHERE G.GOODS_CODE = GG.GOODS_CODE 
                          AND G.SOURCING_CODE = #{SOURCING_CODE, jdbcType=VARCHAR})
 	</update>
 	
 	<update id="updateMassTargetYnGMKTBySourcingCode2" parameterType="hashMap" >
         UPDATE TPAGMKTGOODS GG2 
            SET MASS_TARGET_YN    = #{MASS_TARGET_YN	, jdbcType=VARCHAR} 
              , MASS_TARGET_CODE  = #{MASS_TARGET_CODE	, jdbcType=VARCHAR}       
          WHERE GG2.PA_STATUS     = '10'
            AND GG2.ITEM_NO IS NULL
            AND GG2.PA_CODE  	  = #{PA_CODE, jdbcType=VARCHAR}
            AND MASS_TARGET_YN 	  = 0
            AND EXISTS (SELECT '1'
                          FROM TPAGMKTGOODS GG3
                         WHERE GG3.GOODS_CODE = GG2.GOODS_CODE
                           AND GG3.PA_STATUS  = '30')
            AND EXISTS (SELECT 'X'
                          FROM TGOODS G
                         WHERE G.GOODS_CODE    = GG2.GOODS_CODE 
                           AND G.SOURCING_CODE = #{SOURCING_CODE, jdbcType=VARCHAR})
 	</update>
	
 	<update id="updateMassTargetYnCopnBySourcingCode" parameterType="hashMap" >
         UPDATE TPACOPNGOODS PG 
            SET MASS_TARGET_YN   		= #{MASS_TARGET_YN	 , jdbcType=VARCHAR} 
              , MASS_TARGET_CODE     	= #{MASS_TARGET_CODE , jdbcType=VARCHAR}     
          WHERE PG.TRANS_TARGET_YN   	= '1'
            AND PG.PA_SALE_GB    		= '20'
            AND PG.PA_STATUS IN ('30','40')
            AND PG.PA_CODE  	 		= #{PA_CODE, jdbcType=VARCHAR}
            AND MASS_TARGET_YN 			= 0
            AND EXISTS (SELECT 'X'
                          FROM TGOODS G
                         WHERE G.GOODS_CODE    = PG.GOODS_CODE 
                           AND G.SOURCING_CODE = #{SOURCING_CODE, jdbcType=VARCHAR})
 	</update>
 	
 	<update id="updateMassTargetYnWempBySourcingCode" parameterType="hashMap" >
         UPDATE TPAWEMPGOODS PG 
            SET MASS_TARGET_YN   		= #{MASS_TARGET_YN		, jdbcType=VARCHAR} 
              , MASS_TARGET_CODE     	= #{MASS_TARGET_CODE	, jdbcType=VARCHAR}          
          WHERE PG.TRANS_TARGET_YN   	= '1'
            AND PG.PA_SALE_GB    		= '20'
            AND PG.PA_STATUS IN ('30','40')
            AND PG.PA_CODE  	 		= #{PA_CODE, jdbcType=VARCHAR}
            AND MASS_TARGET_YN 			= 0
            AND EXISTS (SELECT 'X'
                          FROM TGOODS G
                         WHERE G.GOODS_CODE    = PG.GOODS_CODE 
                           AND G.SOURCING_CODE = #{SOURCING_CODE, jdbcType=VARCHAR})
 	</update> 	
 	
 	<update id="updateMassTargetYnIntpBySourcingCode" parameterType="hashMap" >
         UPDATE TPAINTPGOODS PG 
            SET MASS_TARGET_YN   		= #{MASS_TARGET_YN		, jdbcType=VARCHAR} 
              , MASS_TARGET_CODE     	= #{MASS_TARGET_CODE	, jdbcType=VARCHAR}            
          WHERE PG.TRANS_TARGET_YN   	= '1'
            AND PG.PA_SALE_GB    		= '20'
            AND PG.PA_STATUS IN ('30','40')
            AND PG.PA_CODE  	 		= #{PA_CODE, jdbcType=VARCHAR}
            AND MASS_TARGET_YN 			= 0
            AND EXISTS (SELECT 'X'
                          FROM TGOODS G
                         WHERE G.GOODS_CODE    = PG.GOODS_CODE 
                           AND G.SOURCING_CODE = #{SOURCING_CODE, jdbcType=VARCHAR})
 	</update>
 	
 	<update id="updateMassTargetYnLtonBySourcingCode" parameterType="hashMap" >
         UPDATE TPALTONGOODS PG 
            SET MASS_TARGET_YN   		= #{MASS_TARGET_YN		, jdbcType=VARCHAR} 
              , MASS_TARGET_CODE     	= #{MASS_TARGET_CODE	, jdbcType=VARCHAR}            
          WHERE PG.TRANS_TARGET_YN   	= '1'
            AND PG.PA_SALE_GB    		= '20'
            AND PG.PA_STATUS IN ('30','40')
            AND PG.PA_CODE  	 		= #{PA_CODE, jdbcType=VARCHAR}
            AND MASS_TARGET_YN 			= 0
            AND EXISTS (SELECT 'X'
                          FROM TGOODS G
                         WHERE G.GOODS_CODE    = PG.GOODS_CODE 
                           AND G.SOURCING_CODE = #{SOURCING_CODE, jdbcType=VARCHAR})
 	</update>  	
 	
    <update id="execSP_PA_MASS_GOODS_UPDATE" statementType="CALLABLE" parameterType="hashMap">
        {call SP_PA_MASS_GOODS_UPDATE(
                           #{massTargetEp		, 	jdbcType=VARCHAR, mode=IN},
                           #{paGroupCode		,   jdbcType=VARCHAR, mode=IN},
                           #{modCase			,   jdbcType=VARCHAR, mode=IN},
                           #{out_code			,   jdbcType=NUMERIC, mode=OUT},
                           #{out_msg			,   jdbcType=VARCHAR, mode=OUT}
                           )}
    </update>
    
 	<resultMap id="selectGoodsDescribeDataMap" type="hashMap">
        <result column="DESCRIBE_EXT" property="DESCRIBE_EXT" jdbcType="CLOB"/>
    </resultMap>
    
    <select id="selectDescData" parameterType="hashMap" resultMap="selectGoodsDescribeDataMap">
        SELECT /* pacommon.xml : pacommon.pacommon.selectDescData by PaCommonDAO */
                NVL((SELECT REPLACE (DS.DESCRIBE_EXT, chr(10), '')
					  FROM TDESCRIBE DS
					 WHERE DS.DESCRIBE_CODE ='998'
					   AND DS.GOODS_CODE = TG.GOODS_CODE)
				  ,(SELECT DECODE(DS.WEB_FLAG, '1',  REPLACE(DS.DESCRIBE_EXT, chr(10), ''), DS.DESCRIBE_NOTE)
					  FROM TDESCRIBE DS
					 WHERE DS.DESCRIBE_CODE ='999'
					   AND DS.GOODS_CODE = TG.GOODS_CODE)) AS DESCRIBE_EXT
          FROM TGOODS TG
         WHERE TG.GOODS_CODE = #{goodsCode,jdbcType=VARCHAR}
 	</select>
    
    <resultMap id="selectPaNoticeDataMap" type="hashMap">
        <result column="GOODS_COM"  property="GOODS_COM"/>
        <result column="NOTICE_EXT" property="NOTICE_EXT" jdbcType="CLOB"/>
    </resultMap>
    
    <select id="selectPaNoticeData" parameterType="hashMap" resultMap="selectPaNoticeDataMap">
        SELECT /*+ INDEX_DESC (TNM IDX_TPANOTICEM_03)*/
	           NVL(TNM.NOTICE_EXT, '') AS NOTICE_EXT
	         , NVL((SELECT TSB.DESCRIBE_NOTE
	                  FROM TDESCRIBE TSB
	                 WHERE TSB.GOODS_CODE 	 = #{goodsCode , jdbcType=VARCHAR}
	                   AND TSB.DESCRIBE_CODE = '200'), '') AS GOODS_COM
	      FROM TPANOTICEM TNM
	         , TPANOTICETARGET TNT
	         , TPANOTICEAPPLY TNA
	     WHERE TNM.NOTICE_NO  	 = TNT.NOTICE_NO
	       AND TNT.GOODS_CODE 	 = #{goodsCode , jdbcType=VARCHAR}
	       AND TNM.USE_CODE   	 = '00'
	       AND TNT.NOTICE_NO  	 = TNA.NOTICE_NO
	       AND TNT.GOODS_CODE 	 = TNA.GOODS_CODE
	       AND TNA.PA_GROUP_CODE = #{paGroupCode , jdbcType=VARCHAR}
	       AND INSTR(TNM.PA_GROUP_CODE, #{paGroupCode , jdbcType=VARCHAR}) > 0
	       AND ROWNUM = 1
    </select>
 	
 	<update id="updateSsgGoodsAuthTrans" parameterType="com.cware.netshopping.domain.model.SpAuthTransInfo">
       UPDATE /* pacommon.xml: pacommon.pacommon.updateSsgGoodsAuthTrans by PaCommonController */
       	   	  TPASSGGOODS PG
          SET PG.TRANS_SALE_YN = '1'
            , PG.PA_SALE_GB    = '20'
            , PG.PA_STATUS 	   = '30'
            , PG.MODIFY_DATE   = #{modifyDate,  jdbcType=TIMESTAMP}
        WHERE PG.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR}
          AND PG.PA_SALE_GB    = '30'
          AND PG.PA_STATUS 	   = '30'
          AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateSsgGoodsExceptTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateSsgGoodsExceptTrans */
        	   TPASSGGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '30'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '20'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
 	
 	<update id="updateSsgGoodsEventTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateSsgGoodsEventTrans by PaCommonController */
        	   TPASSGGOODS PG
           SET PG.TRANS_SALE_YN = '1'
             , PG.PA_SALE_GB 	= '20'
             , PG.PA_STATUS 	= '30'
             , PG.MODIFY_DATE 	= SYSDATE
         WHERE PG.GOODS_CODE 	= #{goodsCode,   jdbcType=VARCHAR}
           AND PG.PA_SALE_GB 	= '30'
           AND PG.PA_STATUS 	= '30'
           AND PG.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updatePaSsgGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaSsgGoodsSync by PaCommonController */
        	   TPASSGGOODS P1
           SET P1.TRANS_TARGET_YN = '1'
           	 , P1.BRAND_ID    	  = NVL((SELECT BM.PA_BRAND_NO FROM TPABRANDMAPPING BM  WHERE BM.BRAND_CODE = #{newBrandCode, jdbcType=VARCHAR} AND BM.PA_GROUP_CODE = P1.PA_GROUP_CODE), '9999999999')
             , P1.ORPLC_ID		  = NVL((SELECT OM.PA_ORIGIN_CODE FROM TPAORIGINMAPPING OM WHERE OM.ORIGIN_CODE = #{newOriginCode,  jdbcType=VARCHAR} AND OM.PA_GROUP_CODE = P1.PA_GROUP_CODE),'1000000000')
    	     , P1.GOODS_NAME	  = #{newGoodsNameMc, jdbcType=VARCHAR}
             , P1.MODIFY_DATE 	  = SYSDATE
         WHERE P1.GOODS_CODE  	  = #{goodsCode, jdbcType=VARCHAR}
	</update>
	
	<update id="updateSsgTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateSsgTrans by PaCommonController */
        	   TPASSGGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
	</update>
	
	<update id="updatePaSsgGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaSsgGoodsSaleGb by PaCommonController */
        	   TPASSGGOODS PASG
           SET PASG.PA_SALE_GB    = '30'
             , PASG.TRANS_SALE_YN = '1'
             , PASG.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , PASG.MODIFY_ID     = '999999'
         WHERE PASG.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
    
    <update id="updateSsgStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateSsgStopSale */
               TPASSGGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
			 <if test ='ssgFoodYn != null and ssgFoodYn != "" and ssgFoodYn == "Y"'>
			 , CG.LAST_FOOD_SYNC_DATE = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
			 </if>
			 <if test ='disposalYn != null and disposalYn != "" and disposalYn == "Y"'>
             , CG.PA_STATUS       = '50'
             </if>
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
           <if test ='disposalYn == null or disposalYn == "" or disposalYn != "Y"'>
           AND CG.PA_SALE_GB      = '20'
           </if>
		   AND CG.PA_STATUS       IN ('30', '90')
    </update>
    
    <update id="updateSsgTransEntpSlip" parameterType="com.cware.netshopping.domain.model.PaEntpSlip">
        UPDATE /* pacommon.xml : pacommon.common.updateSsgTransEntpSlip */
               TPASSGGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = #{modifyId,   jdbcType=VARCHAR}
             , P.MODIFY_DATE     = #{modifyDate, jdbcType=TIMESTAMP}
         WHERE EXISTS ( SELECT G.GOODS_CODE
                          FROM TPAGOODS G
                             , TGOODS GD
                         WHERE G.GOODS_CODE = GD.GOODS_CODE
                           AND P.GOODS_CODE = G.GOODS_CODE
                           AND DECODE(GD.DELY_TYPE, '10', '100001', G.ENTP_CODE) = #{entpCode,   jdbcType=VARCHAR}
                           AND DECODE(GD.DELY_TYPE, '10', '003', G.SHIP_MAN_SEQ) = #{entpManSeq, jdbcType=VARCHAR}
                      )
    </update>
    
    <select id="selectSsgCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectSsgCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.ITEM_ID, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPASSGGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;&gt; '00'
					AND PG.PA_SALE_GB = CASE WHEN GD.SALE_GB = '19' THEN PG.PA_SALE_GB
		                                     ELSE '20' END
		            AND PG.PA_STATUS IN ('30', '90')
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
			    ) XA
    </select>
    
    <select id="selectPaGoodsOfferList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaGoodsOfferVO">
        SELECT /* pacommon.xml : pacommon.common.selectPaGoodsOfferList by PaCommonController-selectPaGoodsOfferList */
               PO.GOODS_CODE
             , PO.PA_GROUP_CODE
             , PO.PA_OFFER_TYPE
             , PO.PA_OFFER_CODE 
             , PO.PA_OFFER_EXT
             , PC.PA_OFFER_TYPE_NAME
             , PC.PA_OFFER_CODE_NAME
             , PC.IPT_MTHD_CD
          FROM TPAGOODSOFFER PO
             , TPAOFFERCODE PC
         WHERE PO.PA_GROUP_CODE = PC.PA_GROUP_CODE  
           AND PO.PA_OFFER_TYPE = PC.PA_OFFER_TYPE 
           AND PO.PA_OFFER_CODE = PC.PA_OFFER_CODE  
           AND PO.GOODS_CODE    = #{goodsCode,   jdbcType=VARCHAR}
           AND PO.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND PO.USE_YN = '1'
    </select>
    
    <select id="selectPaGoodsdtInfoList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.PaGoodsdtMapping">
        SELECT /* pacommon.xml : pacommon.common.selectPaGoodsdtInfoList by PaCommonController-selectPaGoodsdtInfoList */ 
               PD.GOODS_CODE 
             , DM.PA_CODE
             , PD.GOODSDT_CODE
             , DECODE(PD.GOODSDT_INFO,'없음','단일상품',PD.GOODSDT_INFO) AS GOODSDT_INFO
             , DECODE(PD.GOODSDT_INFO_KIND,'없음','단일상품',PD.GOODSDT_INFO_KIND) AS GOODSDT_INFO_KIND
             , DECODE(DM.TRANS_ORDER_ABLE_QTY, 0, DECODE(DT.SALE_GB, '00', NVL(CEIL(FUN_GET_ORDER_ABLE_QTY(PD.GOODS_CODE, PD.GOODSDT_CODE, GD.WH_CODE) * TC.CODE_GROUP),0), 0), DM.TRANS_ORDER_ABLE_QTY) AS TRANS_ORDER_ABLE_QTY
             , PD.SORT_TYPE 
             , DM.PA_OPTION_CODE
             , DM.TRANS_TARGET_YN
          FROM TPAGOODSDT PD
             , TPAGOODSDTMAPPING DM
             , TGOODS GD
             , TCODE TC
             , TGOODSDT DT
         WHERE PD.GOODS_CODE = DM.GOODS_CODE
           AND PD.GOODSDT_CODE = DM.GOODSDT_CODE
           AND PD.GOODS_CODE = GD.GOODS_CODE
           AND TC.CODE_LGROUP = 'O505'
           AND TC.CODE_MGROUP = DM.PA_CODE
           AND DT.GOODS_CODE = PD.GOODS_CODE
           AND DT.GOODSDT_CODE = PD.GOODSDT_CODE
           AND DM.PA_CODE = #{paCode, jdbcType=VARCHAR}
           AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
         ORDER BY PD.GOODS_CODE
                , PD.GOODSDT_CODE
    </select>
    
	<insert id="savePaPromoTargetHistory" parameterType="hashMap">
        INSERT INTO /* pacommon.xml : pacommon.common.savePaPromoTargetHistory by PaCommonController */
                    TPAPROMOTARGETHISTORY
			SELECT PMT.PROMO_NO
				 , TC.CODE_MGROUP AS PA_GROUP_CODE
				 , PMT.GOODS_CODE
				 , LPAD(NVL((SELECT MAX(SEQ)+1 FROM TPAPROMOTARGETHISTORY A WHERE A.PROMO_NO = PMT.PROMO_NO AND A.PA_GROUP_CODE = TC.CODE_MGROUP AND A.GOODS_CODE = PMT.GOODS_CODE),'1'),4,'0') AS SEQ
				 , 'I' AS PROC_GB
				 , NVL(PM.ALCOUT_PROMO_YN,'0') AS ALCOUT_PROMO_YN
				 , 'BATCH'
				 , SYSDATE
			  FROM TPROMOM PM
				 , TPPROMOTARGET PMT
				 , TCODE TC
				 , TCODE TC1
				 , TPAGOODS PG
			 WHERE PM.PROMO_NO			= PMT.PROMO_NO
			   AND PM.COUPON_YN			= '1'
			   AND PM.DO_TYPE			= '30'
			   AND PM.IMMEDIATELY_YN	= '1'
			   AND PM.PROMO_BDATE		&lt; SYSDATE
			   AND PM.PROMO_EDATE		> SYSDATE
			   AND PM.ALCOUT_PROMO_YN	= '1'
			   AND TC.CODE_LGROUP		= 'O500'
			   AND TC.CODE_MGROUP		= #{paGroupCode, jdbcType=VARCHAR}
			<if test='goodsCode != null and goodsCode != "" '>
				AND PMT.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
			</if>
			   AND (INSTR(PM.MEDIA_CODE, TC.REMARK1) > 0)
			   AND PM.USE_CODE			= '00'
			   AND TC1.CODE_LGROUP		= 'O501'
			   AND TC1.CODE_GROUP		= TC.CODE_MGROUP
			   AND PMT.GOODS_CODE		= PG.GOODS_CODE
			   AND (INSTR(PG.SALE_PA_CODE, TC1.CODE_MGROUP) > 0)
			   /*AND NOT EXISTS ( SELECT 'X' 
								  FROM TPAPROMOTARGETEXCEPT TPE
								 WHERE TPE.TARGET_CODE = PMT.GOODS_CODE
								   AND (INSTR(TPE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1)
						     	   AND ((TPE.PA_EXCEPT_BDATE &lt;= SYSDATE AND TPE.PA_EXCEPT_EDATE >= SYSDATE) OR TPE.PA_EXCEPT_BDATE IS NULL)
								   AND TPE.USE_YN = '1' ) 
			   AND NOT EXISTS ( SELECT 'X' 
                                        FROM TPAPROMOEXCEPTENTP PEE
                                           , TPAPROMOEXCEPTBRAND PEB
                                           , TGOODS TG 
                                       WHERE PMT.GOODS_CODE = TG.GOODS_CODE
                                         AND TG.ENTP_CODE = PEE.ENTP_CODE
                                         AND PEE.ENTP_CODE = PEB.ENTP_CODE
                                         AND TG.BRAND_CODE = PEB.BRAND_CODE
                                         AND PEB.USE_YN = '1'
                                         AND (INSTR(PEE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
                                         AND (PEB.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEB.PA_EXCEPT_EDATE >= SYSDATE)
                                    )  
               AND NOT EXISTS ( SELECT 'X' 
                                        FROM TPAPROMOEXCEPTENTP PEE
                                              , TGOODS TG 
                                      WHERE PMT.GOODS_CODE = TG.GOODS_CODE
                                         AND TG.ENTP_CODE = PEE.ENTP_CODE
                                        AND PEE.USE_YN = '1'
                                         AND (INSTR(PEE.PA_GROUP_CODE, TC.CODE_MGROUP) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
                                         AND (PEE.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEE.PA_EXCEPT_EDATE >= SYSDATE)
                                         AND PEE.ALL_BRAND_YN = '1'
                                  ) */
			   AND NOT EXISTS ( SELECT 1
								  FROM TPAPROMOTARGETHISTORY TPP
								 WHERE TPP.PROMO_NO = PMT.PROMO_NO
								   AND TPP.PA_GROUP_CODE = TC.CODE_MGROUP
								   AND TPP.GOODS_CODE = PMT.GOODS_CODE
								   AND TPP.PROC_GB = 'I'
								   AND TPP.SEQ = ( SELECT /*+INDEX_DESC (TPP2 PK_TPAPROMOTARGETHISTORY)*/
														  TPP2.SEQ
													 FROM TPAPROMOTARGETHISTORY TPP2
													WHERE TPP2.PROMO_NO = TPP.PROMO_NO
													  AND TPP2.PA_GROUP_CODE = TPP.PA_GROUP_CODE
													  AND TPP2.GOODS_CODE = TPP.GOODS_CODE
													  AND rownum = 1
												 )
							  )
							  
		 UNION ALL
		 
			SELECT PM.PROMO_NO
				 , TPP.PA_GROUP_CODE
				 , TPP.GOODS_CODE
				 , LPAD(TPP.SEQ + 1,4,'0') AS SEQ
				 , 'D' AS PROC_GB
				 , NVL(PM.ALCOUT_PROMO_YN,'0') AS ALCOUT_PROMO_YN
				 , 'BATCH'
				 , SYSDATE 
			  FROM TPROMOM PM
				 , TPAPROMOTARGETHISTORY TPP
			 WHERE PM.COUPON_YN			= '1'
			   AND PM.DO_TYPE			= '30'
			   AND PM.IMMEDIATELY_YN	= '1'
			   AND PM.ALCOUT_PROMO_YN	= '1'
			   AND PM.PROMO_NO			= TPP.PROMO_NO
			   AND TPP.PROC_GB			= 'I'
			   AND TPP.PA_GROUP_CODE	= #{paGroupCode, jdbcType=VARCHAR}
			   AND TPP.rowid = ( SELECT /*+INDEX_DESC (PPMT PK_TPAPROMOTARGETHISTORY)*/
										PPMT.rowid
								   FROM TPAPROMOTARGETHISTORY PPMT
								  WHERE PPMT.PROMO_NO = TPP.PROMO_NO
									AND PPMT.PA_GROUP_CODE = TPP.PA_GROUP_CODE
									AND PPMT.GOODS_CODE = TPP.GOODS_CODE
									AND rownum = 1
							   )
			   AND (PM.PROMO_EDATE &lt; SYSDATE 
				OR PM.USE_CODE &lt;> '00' 						   
				OR EXISTS  ( SELECT 'X' 
								  FROM TPAPROMOTARGETEXCEPT TPE
								 WHERE TPE.TARGET_CODE = TPP.GOODS_CODE
								   AND (INSTR(TPE.PA_GROUP_CODE, TPP.PA_GROUP_CODE) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1)
						     	   AND ((TPE.PA_EXCEPT_BDATE &lt;= SYSDATE AND TPE.PA_EXCEPT_EDATE >= SYSDATE) OR TPE.PA_EXCEPT_BDATE IS NULL)
								    /* AND TPE.PA_EXCEPT_MARGIN IS NULL */
								   AND TPE.USE_YN = '1' )
			    OR EXISTS  ( SELECT 'X' 
                                        FROM TPAPROMOEXCEPTENTP PEE
                                           , TPAPROMOEXCEPTBRAND PEB
                                           , TGOODS TG 
                                       WHERE TPP.GOODS_CODE = TG.GOODS_CODE
                                         AND TG.ENTP_CODE = PEE.ENTP_CODE
                                         AND PEE.ENTP_CODE = PEB.ENTP_CODE
                                         AND TG.BRAND_CODE = PEB.BRAND_CODE
                                         AND PEB.USE_YN = '1'
                                         AND (INSTR(PEE.PA_GROUP_CODE, TPP.PA_GROUP_CODE) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
                                         AND (PEB.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEB.PA_EXCEPT_EDATE >= SYSDATE)
                                    )  
                OR EXISTS  ( SELECT 'X' 
                                        FROM TPAPROMOEXCEPTENTP PEE
                                              , TGOODS TG 
                                      WHERE TPP.GOODS_CODE = TG.GOODS_CODE
                                         AND TG.ENTP_CODE = PEE.ENTP_CODE
                                        AND PEE.USE_YN = '1'
                                         AND (INSTR(PEE.PA_GROUP_CODE, TPP.PA_GROUP_CODE) > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1)
                                         AND (PEE.PA_EXCEPT_BDATE &lt;= SYSDATE AND PEE.PA_EXCEPT_EDATE >= SYSDATE)
                                         AND PEE.ALL_BRAND_YN = '1'
                                  ) 
				 OR NOT EXISTS ( SELECT 1
								   FROM TPPROMOTARGET PT
								  WHERE PT.PROMO_NO = TPP.PROMO_NO
									AND PT.GOODS_CODE = TPP.GOODS_CODE
							   )
				   )
    </insert>
    
    <select id="selectPaPromoGoodsPriceList" parameterType="hashMap" resultType="com.cware.netshopping.domain.model.PaPromoGoodsPrice">
        SELECT /* pacommon.xml : pacommon.common.selectPaPromoGoodsPriceList by PaCommonController */
			   XXA.GOODS_CODE
			 , XXA.PA_CODE
			 , XXA.APPLY_DATE
			 , XXA.PROMO_NO
			 , XXA.DO_AMT
			 , XXA.OWN_COST
			 , XXA.ENTP_COST
			 , XXA.ALCOUT_PROMO_YN
		  FROM ( SELECT XA.PROMO_NO
					  , XA.PA_CODE
					  , XA.GOODS_CODE
					  , XA.APPLY_DATE
					  , XA.DO_AMT
					  , XA.OWN_COST
					  , XA.ENTP_COST
					  , XA.ALCOUT_PROMO_YN
				   FROM ( SELECT TPP.PROMO_NO
							   , TPP.PA_GROUP_CODE
							   , TPP.GOODS_CODE
							   , PGP.PA_CODE
							   , PGP.APPLY_DATE
							   , PGP.SALE_PRICE
							   , PGP.DC_AMT
							   , PGP.LUMP_SUM_DC_AMT
							   , GP.BUY_PRICE
							   , PM.DO_RATE
							   , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
									(CASE WHEN PM.LIMIT_AMT > 0
										THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
													THEN PM.LIMIT_AMT
													ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
													END )
										  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
										   END )
									  ELSE PM.DO_AMT END AS DO_AMT
							   , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN 
									TRUNC( ( CASE WHEN PM.LIMIT_AMT > 0 THEN 
												( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT THEN PM.LIMIT_AMT
                          							   ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
														END 
												)
												  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
												   END 
										   ) * (100 - NVL(PM.GRP_UNIT_ENTP_BND_VAL, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
									  ELSE NVL(PM.GRP_UNIT_OCMP_BND_VAL,0) END AS OWN_COST
									  
							   , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
									(CASE WHEN PM.LIMIT_AMT > 0
										THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
													THEN PM.LIMIT_AMT
													ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
													END )
										  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
										   END )
									- TRUNC( ( CASE WHEN PM.LIMIT_AMT > 0 THEN 
												( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT THEN PM.LIMIT_AMT
                          							   ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
														END 
												)
												  ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
												   END 
										   ) * (100 - NVL(PM.GRP_UNIT_ENTP_BND_VAL, 0)) / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT')))
									  ELSE NVL(PM.GRP_UNIT_ENTP_BND_VAL,0) END AS ENTP_COST
							   /* , (SELECT VAL FROM TCONFIG WHERE ITEM = 'PA_LIMIT_MARGIN' AND ROWNUM = 1) AS MIN_MARGIN_RATE */
				               , (SELECT TMR.MIN_MARGIN_RATE 
				                    FROM TPAPROMOMINMARGINRATE TMR
				                   WHERE TMR.PA_GROUP_CODE = #{paGroupCode,	jdbcType=VARCHAR}
				                     AND TMR.PA_CODE = PGP.PA_CODE
				                     AND ROWNUM = 1) AS MIN_MARGIN_RATE /* new minMarginRate 20220920 */
							   , TPP.ALCOUT_PROMO_YN
							   , PM.PROMO_BDATE
							   , PM.PROMO_EDATE
							   , GP.ARS_OWN_DC_AMT
                 			   , PGP.LUMP_SUM_OWN_DC_AMT
                 			   , (SELECT 'X' FROM TPAPROMOMARGINEXCEPT PPE WHERE PPE.GOODS_CODE = GP.GOODS_CODE AND PPE.PA_GROUP_CODE = TPP.PA_GROUP_CODE AND USE_YN = '1'  AND ROWNUM = 1) AS PROMO_MARGIN_EXCEPT 
							   , GD.ENTP_CODE
							   , GD.BRAND_CODE
							FROM TPROMOM PM
							   , TPAPROMOTARGETHISTORY TPP
							   , TCODE TC
							   , TPAGOODSPRICE PGP
							   , TGOODSPRICE GP
							   , TCODE TC1
							   , TGOODS GD
						   WHERE TPP.GOODS_CODE = GD.GOODS_CODE
						     AND PM.COUPON_YN = '1'
							 AND PM.DO_TYPE = '30'
							 AND PM.IMMEDIATELY_YN = '1'
							 AND PM.PROMO_NO = TPP.PROMO_NO
							 AND TPP.rowid = (SELECT /*+INDEX_DESC (PPMT PK_TPAPROMOTARGETHISTORY)*/
													 PPMT.rowid
												FROM TPAPROMOTARGETHISTORY PPMT
											   WHERE PPMT.PROMO_NO = TPP.PROMO_NO
												 AND PPMT.PA_GROUP_CODE = TPP.PA_GROUP_CODE
												 AND PPMT.GOODS_CODE = TPP.GOODS_CODE
												 AND rownum = 1
											 )
							 AND TPP.PROC_GB = 'I'
							 AND TC.CODE_LGROUP = 'O501'
							 AND TC.CODE_GROUP = TPP.PA_GROUP_CODE
							 AND PGP.GOODS_CODE = TPP.GOODS_CODE
							 AND PGP.PA_CODE = TC.CODE_MGROUP
							 AND PGP.APPLY_DATE = (SELECT /*+ INDEX_DESC (PGP2 PK_TPAGOODSPRICE)*/
														  PGP2.APPLY_DATE
													 FROM TPAGOODSPRICE PGP2
													WHERE PGP2.GOODS_CODE = PGP.GOODS_CODE
													  AND PGP2.APPLY_DATE &lt; SYSDATE
													  AND PGP2.PA_CODE = PGP.PA_CODE
													  AND ROWNUM = 1)
							 AND PGP.GOODS_CODE = GP.GOODS_CODE
							 AND PGP.PRICE_SEQ = GP.PRICE_SEQ
							 AND TC1.CODE_LGROUP = 'O582'
							 AND TC1.CODE_MGROUP = DECODE(TPP.PA_GROUP_CODE,'01','10','02','30','04','50','05','60','06','70','07','80','08','82','09','84','10','86','11', '88', '')
   							 AND TPP.ALCOUT_PROMO_YN = '1'
							 AND TPP.PA_GROUP_CODE = #{paGroupCode,	jdbcType=VARCHAR}
							<if test='goodsCode != null and goodsCode != "" '>
								AND TPP.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
							</if>
						) XA
			       LEFT OUTER JOIN TPAPROMOTARGETEXCEPT TPE ON  TPE.TARGET_CODE = XA.GOODS_CODE AND TPE.USE_YN = '1' AND (INSTR(TPE.PA_GROUP_CODE, '10' ) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1)    		
														   AND SYSDATE BETWEEN TPE.PA_EXCEPT_BDATE AND TPE.PA_EXCEPT_EDATE AND TPE.TARGET_GB = '00'
				   
				   LEFT OUTER JOIN TPAPROMOEXCEPTENTP PEE ON PEE.ENTP_CODE = XA.ENTP_CODE AND (INSTR(PEE.PA_GROUP_CODE, '10') > 0  OR PEE.PA_GROUP_CODE_ALL_YN = 1) AND PEE.USE_YN = '1'
				   LEFT OUTER JOIN TPAPROMOEXCEPTBRAND PEB ON PEB.BRAND_CODE = XA.BRAND_CODE AND PEE.ENTP_CODE = PEB.ENTP_CODE  AND PEB.USE_YN = '1'
				  WHERE DECODE(XA.PROMO_MARGIN_EXCEPT,NULL,TRUNC((XA.SALE_PRICE -XA.ARS_OWN_DC_AMT -XA.LUMP_SUM_OWN_DC_AMT -XA.OWN_COST - XA.BUY_PRICE) / XA.SALE_PRICE * 100), 99) > MIN_MARGIN_RATE
					AND ((PEE.ENTP_CODE IS NULL) 
						 OR (PEB.ENTP_CODE IS NULL AND SYSDATE BETWEEN PEE.PA_EXCEPT_BDATE AND PEE.PA_EXCEPT_EDATE )
						 OR (SYSDATE BETWEEN PEB.PA_EXCEPT_BDATE AND PEB.PA_EXCEPT_EDATE))
					AND (TPE.TARGET_CODE IS NULL OR ((XA.SALE_PRICE - XA.DC_AMT - XA.LUMP_SUM_DC_AMT - XA.DO_AMT) >= TPE.PA_EXCEPT_MARGIN) )
					
					AND ( EXISTS ( SELECT 1
									 FROM TPAPROMOGOODSPRICE PP
									WHERE PP.GOODS_CODE = XA.GOODS_CODE
									  AND PP.PA_CODE = XA.PA_CODE
									  AND PP.APPLY_DATE = XA.APPLY_DATE
									  AND PP.ALCOUT_PROMO_YN = XA.ALCOUT_PROMO_YN
									  AND PP.DO_AMT &lt; XA.DO_AMT
									  AND PP.PROMO_SEQ =  (SELECT /*+ INDEX_DESC (PP2 PK_TPAPROMOGOODSPRICE)*/
					                                              PP2.PROMO_SEQ
					                                         FROM TPAPROMOGOODSPRICE PP2
					                                        WHERE PP2.GOODS_CODE = PP.GOODS_CODE
					                                          AND PP2.PA_CODE    = PP.PA_CODE
					                                          AND PP2.APPLY_DATE = PP.APPLY_DATE
					                                          AND ROWNUM = 1)
								 )
						OR NOT EXISTS ( SELECT 1
										  FROM TPAPROMOGOODSPRICE PP
										 WHERE PP.GOODS_CODE = XA.GOODS_CODE
										   AND PP.PA_CODE = XA.PA_CODE
										   AND PP.APPLY_DATE = XA.APPLY_DATE
										   AND PP.ALCOUT_PROMO_YN = XA.ALCOUT_PROMO_YN
									  )
						)

			  UNION ALL
				 SELECT XA.PROMO_NO
				 	  , XA.PA_CODE
				 	  , XA.GOODS_CODE
				 	  , XA.APPLY_DATE 
				 	  , XA.DO_AMT
				 	  , XA.OWN_COST
				 	  , XA.ENTP_COST
				 	  , XA.ALCOUT_PROMO_YN
				   FROM (
						 SELECT PM.PROMO_NO
							  , PGP.PA_CODE
							  , PGP.GOODS_CODE
							  , PGP.APPLY_DATE
							  , 0 AS DO_AMT
							  , 0 AS OWN_COST
							  , 0 AS ENTP_COST
							  , TPP.ALCOUT_PROMO_YN
							  , CASE WHEN PM.AMT_RATE_FLAG = '2' THEN
																	   (CASE WHEN PM.LIMIT_AMT > 0
																			 THEN ( CASE WHEN (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0,  FUN_GETCONFIG('AMT_ROUND_POINT')))) > PM.LIMIT_AMT
																						 THEN PM.LIMIT_AMT
																			 			 ELSE (TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
																					 END )
																			 ELSE ( TRUNC(PGP.SALE_PRICE * PM.DO_RATE / 100, DECODE(PM.DO_TYPE, '20', 0, '31', 0, FUN_GETCONFIG('AMT_ROUND_POINT'))))
								 										END )
								ELSE PM.DO_AMT END AS ORG_PROMO_DO_AMT
							  , PGP.DC_AMT
							  , PGP.SALE_PRICE
							  , PGP.LUMP_SUM_DC_AMT	
						   FROM TPROMOM PM
							  , TPAPROMOTARGETHISTORY TPP
							  , TCODE TC
							  , TPAGOODSPRICE PGP
		 			      WHERE PM.COUPON_YN = '1'
							AND PM.DO_TYPE = '30'
							AND PM.IMMEDIATELY_YN = '1'
							AND PM.PROMO_NO = TPP.PROMO_NO
							AND TPP.rowid = (SELECT /*+INDEX_DESC (PPMT PK_TPAPROMOTARGETHISTORY)*/
													PPMT.rowid
											   FROM TPAPROMOTARGETHISTORY PPMT
											  WHERE PPMT.PROMO_NO = TPP.PROMO_NO
												AND PPMT.PA_GROUP_CODE = TPP.PA_GROUP_CODE
												AND PPMT.GOODS_CODE = TPP.GOODS_CODE
												AND rownum = 1
											)
							AND TPP.PROC_GB = 'D'
							AND TC.CODE_LGROUP = 'O501'
							AND TC.CODE_GROUP = TPP.PA_GROUP_CODE
							AND PGP.GOODS_CODE = TPP.GOODS_CODE
							AND PGP.PA_CODE = TC.CODE_MGROUP
							AND PGP.APPLY_DATE = (SELECT /*+ INDEX_DESC (PGP2 PK_TPAGOODSPRICE)*/
														 PGP2.APPLY_DATE
													FROM TPAGOODSPRICE PGP2
												   WHERE PGP2.GOODS_CODE = PGP.GOODS_CODE
													 AND PGP2.APPLY_DATE &lt; SYSDATE
													 AND PGP2.PA_CODE = PGP.PA_CODE
													 AND ROWNUM = 1)
							AND EXISTS (SELECT 1 
										  FROM TPAPROMOGOODSPRICE PP 
										 WHERE PP.PA_CODE = PGP.PA_CODE 
										   AND PP.GOODS_CODE = PGP.GOODS_CODE
										   AND PP.APPLY_DATE = PGP.APPLY_DATE
										   AND PP.ALCOUT_PROMO_YN = TPP.ALCOUT_PROMO_YN
										   AND PP.PROMO_NO = TPP.PROMO_NO
										   AND PP.DO_AMT > 0
						                   AND PP.PROMO_SEQ = (SELECT /*+ INDEX_DESC (PP2 PK_TPAPROMOGOODSPRICE)*/
						                                              PP2.PROMO_SEQ
						                                         FROM TPAPROMOGOODSPRICE PP2
						                                        WHERE PP2.GOODS_CODE = PP.GOODS_CODE
						                                          AND PP2.PA_CODE    = PP.PA_CODE
						                                          AND PP2.APPLY_DATE = PP.APPLY_DATE
						                                          AND ROWNUM = 1)
									   )
							AND TPP.ALCOUT_PROMO_YN = '1'
							AND TPP.PA_GROUP_CODE = #{paGroupCode,	jdbcType=VARCHAR}
							<if test='goodsCode != null and goodsCode != "" '>
								AND TPP.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
							</if>
						) XA
			      LEFT OUTER JOIN TPAPROMOTARGETEXCEPT TPE ON  TPE.TARGET_CODE = XA.GOODS_CODE AND TPE.USE_YN = '1' AND (INSTR(TPE.PA_GROUP_CODE, '10' ) > 0  OR TPE.PA_GROUP_CODE_ALL_YN = 1)
			      										  AND SYSDATE BETWEEN TPE.PA_EXCEPT_BDATE AND TPE.PA_EXCEPT_EDATE AND TPE.TARGET_GB = '00'
				 WHERE (TPE.TARGET_CODE IS NULL OR ( TPE.PA_EXCEPT_MARGIN > (XA.SALE_PRICE - XA.DC_AMT  - XA.DO_AMT - XA.LUMP_SUM_DC_AMT) ) )
				 
			   ) XXA
		ORDER BY XXA.GOODS_CODE, XXA.DO_AMT DESC, XXA.OWN_COST, XXA.PROMO_NO
    </select>

    <insert id="insertPaPromoGoodsPrice" parameterType="com.cware.netshopping.domain.model.PaPromoGoodsPrice">
        INSERT INTO /* pacommon.xml : pacommon.common.insertPaPromoGoodsPrice by PaCommonController */
                    TPAPROMOGOODSPRICE
                   ( GOODS_CODE
                   , PA_CODE
                   , APPLY_DATE
                   , PROMO_SEQ
                   , PROMO_NO
                   , DO_AMT
                   , OWN_COST
                   , ENTP_COST
                   , INSERT_ID
                   , INSERT_DATE
                   , ALCOUT_PROMO_YN
                   )
            VALUES ( #{goodsCode,     jdbcType=VARCHAR}
                   , #{paCode,        jdbcType=VARCHAR}
                   , #{applyDate,     jdbcType=TIMESTAMP}
                   , (SELECT LPAD(NVL(MAX(PROMO_SEQ),0)+1,4,'0')
                   	    FROM TPAPROMOGOODSPRICE 
					   WHERE GOODS_CODE	= #{goodsCode, jdbcType=VARCHAR}
						 AND PA_CODE	= #{paCode,    jdbcType=VARCHAR}
						 AND APPLY_DATE	= #{applyDate, jdbcType=TIMESTAMP}
						 AND ALCOUT_PROMO_YN = '1')
                   , #{promoNo,       jdbcType=VARCHAR}
                   , #{doAmt,         jdbcType=NUMERIC}
                   , #{ownCost,       jdbcType=NUMERIC}
                   , #{entpCost,      jdbcType=NUMERIC}
                   , 'BATCH'
                   , SYSDATE
                   , #{alcoutPromoYn, jdbcType=VARCHAR}
                   )
    </insert>
    
    <select id="selectPaSoldOutordList" parameterType="hashMap" resultType="hashMap">
    	SELECT /* pacommon.xml : pacommon.common.selectPaGmktSoldOutordList by PaCommonController */
               PM.PA_ORDER_NO
             , PM.PA_ORDER_SEQ
             , PM.PA_GROUP_CODE
             , PM.PA_CODE
             , TC.CODE_SNAME AS SITE_GB 
             , PM.ORDER_CANCEL_YN
             , PM.ORDER_NO
             , PM.MAPPING_SEQ
             , '100001' AS RESULT_CODE
             , PM.ORDER_CANCEL_YN
             , PM.PA_CODE
           <choose>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "05"'>
           	 , COI.VENDOR_ITEM_ID
	         , COI.SHIPPING_COUNT
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "08"'>
             , LTO.EPD_NO AS GOODS_CODE
             , LTO.EITM_NO
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "10"'>
           	 , SOL.SHPP_NO
           	 , SOL.ITEM_ID
           	 , SOL.SHPP_SEQ
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "13"'>
           	 , TOL.ORDER_PRODUCT_OPTION_NO
           	 , PM.PA_PROC_QTY
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "14"'>
           	 , PM.PA_PROC_QTY
           	</when>
           	
           </choose>           
          FROM TPAORDERM PM
             , TCODE TC
           <choose>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "05"'>
           	 , TPACOPNORDERITEMLIST COI
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "08"'>
           	 , TPALTONORDERLIST LTO
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "10"'>
           	 , TPASSGORDERLIST SOL
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "12"'>
           	 , TPAHALFORDERLIST HOL
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "13"'>
           	 , TPATDEALORDERLIST TOL
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "14"'>
           	 , TPAFAPLEORDERLIST TFL
           	</when>
           </choose>
         WHERE 1=1
           AND PM.ORDER_CANCEL_YN IN ('05', '06')
           AND PM.PA_ORDER_GB = '10'
           AND PM.PA_GROUP_CODE = #{paGroupCode, jdbcType=NUMERIC}
           AND TC.CODE_LGROUP ='O500'
           AND TC.CODE_MGROUP = PM.PA_GROUP_CODE
           <choose>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "05"'>
           AND PM.PA_SHIP_NO   = COI.SHIPMENT_BOX_ID
	       AND PM.PA_ORDER_SEQ = COI.ITEM_SEQ
	       AND PM.PA_ORDER_NO  = COI.ORDER_ID
           	</when>	
            <when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "08"'>
		   AND LTO.OD_NO = PM.PA_ORDER_NO
           AND LTO.OD_SEQ = PM.PA_ORDER_SEQ
		   AND LTO.OD_TYP_CD = PM.PA_ORDER_GB
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "10"'>
		   AND PM.PA_ORDER_NO  = SOL.ORORD_NO
           AND PM.PA_ORDER_SEQ = SOL.ORORD_ITEM_SEQ
           AND PM.PA_SHIP_NO   = SOL.SHPP_NO
           AND PM.PA_SHIP_SEQ  = SOL.SHPP_SEQ
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "12"'>
		   AND PM.PA_ORDER_NO  = HOL.ORD_NO
		   AND PM.PA_ORDER_SEQ = HOL.ORD_NO_NM
		   AND PM.PA_ORDER_GB  = HOL.PA_ORDER_GB
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "13"'>
           AND TOL.ORDER_NO = PM.PA_ORDER_NO
           AND TOL.OPTION_MANAGEMENT_CD = PM.PA_ORDER_SEQ
           	</when>
           	<when test = 'paGroupCode != null and paGroupCode != "" and paGroupCode == "14"'>
           AND TFL.ORDER_ID = PM.PA_ORDER_NO
           AND TFL.ITEM_ID  = PM.PA_ORDER_SEQ
           	</when>
           </choose>
           AND PM.INSERT_DATE > SYSDATE - 90
    </select>
    
    <select id="selectPaRefIdForCounsel" parameterType="String" resultType="String">
        SELECT /* order.xml : custcenter.order.selectPaRefIdForBulkOrderCs */ 
        	NVL(MAX(REMARK), '65187') AS REMARK
		  FROM TCODE TC 
		 WHERE TC.CODE_LGROUP = 'B044' 
		   AND TC.REMARK1 LIKE '%'||#{mediaCode,jdbcType=VARCHAR}||'%'
		   AND TC.USE_YN = '1'
    </select>
    
    <select id="selectCounselInfo" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.pacommon.selectCounselInfo by PaCommonDAO */
        	   DT.CUST_NO, DT.GOODS_CODE, DT.GOODSDT_CODE, DT.MEDIA_CODE, GD.GOODS_NAME, CD.CODE_SNAME AS PROC_ID
		  FROM TPAORDERM PM, TORDERDT DT, TGOODS GD, TCODE CD
		 WHERE PM.ORDER_NO 	    = DT.ORDER_NO
		   AND PM.ORDER_G_SEQ   = DT.ORDER_G_SEQ
		   AND PM.ORDER_D_SEQ   = DT.ORDER_D_SEQ
		   AND PM.PA_ORDER_GB   = DT.ORDER_GB
		   AND DT.GOODS_CODE    = GD.GOODS_CODE
		   AND CD.CODE_LGROUP   ='O500'
   		   AND CD.CODE_MGROUP   = PM.PA_GROUP_CODE
   		   AND PM.ORDER_NO 	    = #{ORDER_NO,jdbcType=VARCHAR}
		   AND PM.PA_ORDER_SEQ  = #{PA_ORDER_SEQ,jdbcType=VARCHAR}
		  <if test='MAPPING_SEQ != null and MAPPING_SEQ != "" '>
           AND PM.MAPPING_SEQ = #{MAPPING_SEQ, jdbcType=VARCHAR}
          </if>
    </select>
    
    <select id="selectReceiverSmsHp" parameterType="hashMap" resultType="String">
        SELECT /* pacommon.xml : pacommon.pacommon.selectReceiverSmsHp by PaCommonDAO */
               RECEIVER_HP
          FROM (SELECT A.RECEIVER_HP1||A.RECEIVER_HP2||A.RECEIVER_HP3 AS RECEIVER_HP
                  FROM TRECEIVER A
                 WHERE A.CUST_NO = #{CUST_NO,jdbcType=VARCHAR}
                   AND A.DEFAULT_YN = '1'
               ) TA
         WHERE ROWNUM = 1
    </select>

	<insert id="insertPaSsgGoodsDtMapping" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaSsgGoodsDtMapping by PaCommonController */
		       TPASSGGOODSDTMAPPING ( GOODS_CODE
		                            , GOODSDT_CODE
		                            , GOODSDT_SEQ
		                            , PA_CODE
		                            , GOODSDT_INFO
		                            , USE_YN
		                            , INSERT_ID
		                            , INSERT_DATE
		                            , MODIFY_ID
		                            , MODIFY_DATE
		                             )
		                        SELECT PD.GOODS_CODE
		                            , PD.GOODSDT_CODE
		                            , (SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(SD.GOODSDT_SEQ)) + 1), 4, '0'), '0001') 
		                                 FROM TPASSGGOODSDTMAPPING SD
		                                WHERE SD.GOODS_CODE   = GD.GOODS_CODE
		                                  AND SD.GOODSDT_CODE = GD.GOODSDT_CODE
		                                  AND SD.PA_CODE      = #{paCode,    jdbcType=VARCHAR})
		                            , #{paCode, jdbcType=VARCHAR}
		                            , GD.GOODSDT_INFO
		                            , '1'
		                            , '999999'
		                            , SYSDATE
		                            , '999999'
		                            , SYSDATE
		                         FROM TPAGOODSDT PD
		                             , TGOODSDT GD
		                        WHERE PD.GOODS_CODE   = #{goodsCode, jdbcType=VARCHAR}
		                          AND PD.GOODS_CODE   = GD.GOODS_CODE
		                          AND PD.GOODSDT_CODE = GD.GOODSDT_CODE
		                          AND GD.SALE_GB &lt;&gt; '19'
		                          AND NOT EXISTS ( SELECT '1'
		                                             FROM TPASSGGOODSDTMAPPING GDS
		                                            WHERE GDS.GOODS_CODE   = GD.GOODS_CODE
		                                              AND GDS.GOODSDT_CODE = GD.GOODSDT_CODE
		                                              AND GDS.PA_CODE      = #{paCode, jdbcType=VARCHAR}
		                                         )
	</insert>

	<insert id="insertPaSsgGoodsDtMappingData" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaSsgGoodsDtMappingData by PaCommonController */
	           TPASSGGOODSDTMAPPING ( GOODS_CODE
	                                , GOODSDT_CODE
	                                , GOODSDT_SEQ
	                                , PA_CODE
	                                , PA_OPTION_CODE
	                                , GOODSDT_INFO
	                                , USE_YN
	                                , TRANS_ORDER_ABLE_QTY
	                                , INSERT_ID
	                                , INSERT_DATE
	                                , MODIFY_ID
	                                , MODIFY_DATE )
		            SELECT PD.GOODS_CODE
		                 , PD.GOODSDT_CODE
		                 , '0001'
		                 , PG.PA_CODE
		                 , ''
		                 , #{goodsdtInfo, jdbcType=VARCHAR}
		                 , '1'
		                 , 0
		                 , '999999'
		                 , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		                 , '999999'
		                 , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		              FROM TPAGOODSDT   PD
		                 , TPASSGGOODS PG
		             WHERE PD.GOODS_CODE   = PG.GOODS_CODE
		               AND PD.GOODS_CODE   = #{goodsCode,   jdbcType=VARCHAR}
		               AND PD.GOODSDT_CODE = #{goodsdtCode, jdbcType=VARCHAR}
		               AND NOT EXISTS ( SELECT 1 
		                                  FROM TPASSGGOODSDTMAPPING LMP 
		                                 WHERE LMP.PA_CODE      = PG.PA_CODE 
		                                   AND LMP.GOODS_CODE   = PD.GOODS_CODE 
		                                   AND LMP.GOODSDT_CODE = PD.GOODSDT_CODE )
	</insert>
	
	<update id="updateSsgGoodsDtInfo" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateSsgGoodsDtInfo by PaCommonController */
        	   TPASSGGOODSDTMAPPING PSM
           SET PSM.USE_YN = '0'
             , PSM.MODIFY_DATE = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PSM.PA_CODE      = #{paCode, 	 jdbcType=VARCHAR}
           AND PSM.GOODS_CODE   = #{goodsCode,   jdbcType=VARCHAR}
           AND PSM.GOODSDT_CODE = #{goodsdtCode, jdbcType=VARCHAR}
    </update>
    
    <insert id="insertPaSsgGoodsDtMappingUdata" parameterType="com.cware.netshopping.domain.model.SpPaGoodsDtInfo">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaSsgGoodsDtMappingUdata by PaCommonController */
	           TPASSGGOODSDTMAPPING ( GOODS_CODE
	                                , GOODSDT_CODE
	                                , GOODSDT_SEQ
	                                , PA_CODE
	                                , PA_OPTION_CODE
	                                , GOODSDT_INFO
	                                , USE_YN
	                                , TRANS_ORDER_ABLE_QTY
	                                , INSERT_ID
	                                , INSERT_DATE
	                                , MODIFY_ID
	                                , MODIFY_DATE 
	                                )
                           	 SELECT   #{goodsCode,   jdbcType=VARCHAR}
	                         	    , #{goodsdtCode, jdbcType=VARCHAR}
	                         	    , ( SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(SD.GOODSDT_SEQ)) + 1), 4, '0'), '0001') 
			                              FROM TPASSGGOODSDTMAPPING SD
			                             WHERE SD.GOODS_CODE   = #{goodsCode,   jdbcType=VARCHAR}
			                               AND SD.GOODSDT_CODE = #{goodsdtCode, jdbcType=VARCHAR}
			                               AND SD.PA_CODE      = #{paCode,      jdbcType=VARCHAR} )
			                        , #{paCode,      jdbcType=VARCHAR}
			                        , ''
			                        , #{goodsdtInfo, jdbcType=VARCHAR}
			                        , '1'
			                        , 0
			                        , '999999'
			                        , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
					                , '999999'
					                , TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS') 
                           	    FROM DUAL
	</insert>
	
	 <select id="selectPaSsgGoodsOfferCodeCheck" parameterType="hashMap" resultType="int">
		SELECT COUNT(1)
		  FROM TGOODS T 
			 , TPAGOODSTARGET GT
			 , (SELECT DISTINCT GOODS_CODE
			 		 , OFFER_TYPE 
			 	  FROM TOFFER 
			 	 WHERE OFFER_TYPE = '20'
			 	   AND USE_YN	  = '1'
			 	   AND GOODS_CODE = #{goodsCode, jdbcType=VARCHAR} ) TR
		 WHERE T.GOODS_CODE = TR.GOODS_CODE
		   AND T.GOODS_CODE = GT.GOODS_CODE
		   AND GT.PA_GROUP_CODE = '10'
		   AND GT.PA_GOODS_CODE IS NULL
		   AND GT.PA_SALE_GB IS NULL 
		   AND NOT EXISTS ( SELECT '1'
                              FROM TGOODSSSGFOOD SF
                             WHERE SF.GOODS_CODE = T.GOODS_CODE
                               AND SF.USE_YN = '1' )
	</select>
	
	<select id="selectPaSsgGoodsOfferList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaSsgGoodsVO">
		SELECT SG.PA_CODE
			 , SG.GOODS_CODE
			 , SG.ITEM_ID
			 , 'N' AS SSG_FOOD_YN
		  FROM (SELECT DISTINCT GOODS_CODE
					 , OFFER_TYPE
				  FROM TOFFER
				 WHERE OFFER_TYPE = '20'
				   AND USE_YN = '1'
				 <if test='goodsCode != null and goodsCode != "" '>
                   AND GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                 </if> ) T
			 , TPASSGGOODS SG
		 WHERE T.GOODS_CODE = SG.GOODS_CODE
		   AND SG.PA_SALE_GB = '20'
		   AND SG.PA_STATUS = '30'
		   AND SG.ITEM_ID IS NOT NULL
		   AND NOT EXISTS ( SELECT '1'
                          FROM TGOODSSSGFOOD SF
                         WHERE SF.GOODS_CODE = T.GOODS_CODE
                           AND SF.USE_YN = '1' )
      UNION ALL
      
        SELECT SG.PA_CODE
             , SG.GOODS_CODE
             , SG.ITEM_ID
             , 'Y' AS SSG_FOOD_YN
          FROM (SELECT DISTINCT GOODS_CODE
                     , OFFER_TYPE
                  FROM TOFFER
                 WHERE OFFER_TYPE = '20'
                   AND USE_YN = '1'
                 <if test='goodsCode != null and goodsCode != "" '>
                   AND GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
                 </if>
                ) T
             , TPASSGGOODS SG
         WHERE T.GOODS_CODE = SG.GOODS_CODE
           AND SG.PA_SALE_GB = '20'
           AND SG.PA_STATUS = '30'
           AND SG.ITEM_ID IS NOT NULL
           AND EXISTS ( SELECT '1'
                          FROM TGOODSSSGFOOD SF, TPASSGGOODS SG
                         WHERE SF.GOODS_CODE = T.GOODS_CODE
                           AND SF.GOODS_CODE = SG.GOODS_CODE
                           AND SF.USE_YN = '1'
                           AND SF.MODIFY_DATE &gt;= NVL(SG.LAST_FOOD_SYNC_DATE, SF.MODIFY_DATE))
	</select>
	
	<update id="updatePaWempGoodsGroupNoticeNo" parameterType="hashMap">
         UPDATE /* pacommon.xml: pacommon.pacommon.updatePaWempGoodsGroupNoticeNo by PaCommonDAO */
        	   TPAWEMPGOODS PG
           SET PG.PA_PRODUCT_GROUP_NOTICE_NO = NULL
             , PG.MODIFY_DATE = TO_DATE(#{dateTime , jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE PG.GOODS_CODE  = #{goodsCode , jdbcType=VARCHAR}
    </update>

	<select id="selectPriceChangeYn" parameterType="com.cware.netshopping.domain.PaGoodsPriceVO" resultType="String">
        SELECT /* pacommon.xml: pacommon.pacommon.selectPriceChangeYn by PaCommonController */
        			DECODE(AA.GP_GOODS_PRICE - PP_GOODS_PRICE, 0, 'N', 'Y') AS 
		  FROM (SELECT GP.SALE_PRICE + GP.ARS_DC_AMT + GP.LUMP_SUM_DC_AMT AS GP_GOODS_PRICE,
		               PP.SALE_PRICE + PP.DC_AMT + PP.LUMP_SUM_DC_AMT AS PP_GOODS_PRICE
		             FROM TGOODSPRICE GP
		             		, TPAGOODSPRICE PP
		         	WHERE GP.GOODS_CODE = PP.GOODS_CODE
			           AND PP.PA_CODE 		= #{paCode, jdbcType=VARCHAR}
			           AND GP.GOODS_CODE 	= #{goodsCode, jdbcType=VARCHAR}     
		                AND GP.APPLY_DATE 	= #{applyDate, jdbcType=TIMESTAMP}
			           AND PP.ROWID = (SELECT /*+ INDEX_DESC (P PK_TPAGOODSPRICE)*/
								                            P.ROWID
								                   FROM TPAGOODSPRICE P
								                  WHERE P.GOODS_CODE = PP.GOODS_CODE
								                      AND P.PA_CODE = PP.PA_CODE
								                      AND P.TRANS_DATE IS NOT NULL								                      
								                      AND ROWNUM = 1)
			           AND ROWNUM = 1 )AA
    </select>
    
    <select id="selectPaNoticeTargetList" resultType="com.cware.netshopping.domain.PaNoticeApplyVO">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPaNoticeTargetList by PaCommonController */ 
		     	'I' AS PROC_GB
		       , PN.NOTICE_NO
		       , TC.CODE_MGROUP AS PA_GROUP_CODE
		       , PNT.GOODS_CODE
		       , PN.NOTICE_BDATE
		       , PN.NOTICE_EDATE
		  FROM TPANOTICEM PN
		       , TPANOTICETARGET PNT
		       , TPAGOODS PG
		       , TCODE TC
		       , TCODE TC1
	     WHERE PN.NOTICE_NO    = PNT.NOTICE_NO
		   AND PN.USE_CODE 	   = '00'
		   AND SYSDATE BETWEEN PN.NOTICE_BDATE AND PN.NOTICE_EDATE
		   AND PNT.GOODS_CODE  = PG.GOODS_CODE
		   AND TC.CODE_LGROUP  = 'O500'
		   AND TC1.CODE_LGROUP = 'O501'
		   AND TC.CODE_MGROUP IN ('04','10')
		   AND TC1.CODE_GROUP IN ('04','10')
		   AND (INSTR(PN.PA_GROUP_CODE, TC.CODE_MGROUP) > 0)
		   AND TC1.CODE_GROUP  = TC.CODE_MGROUP
		   AND (INSTR(PG.SALE_PA_CODE, TC1.CODE_MGROUP) > 0)
		   AND NOT EXISTS( SELECT 1
	  	                     FROM TPANOTICEAPPLY TPA
	       			        WHERE TPA.NOTICE_NO 	= PNT.NOTICE_NO
	                	      AND TPA.PA_GROUP_CODE = TC.CODE_MGROUP
	                   	      AND TPA.GOODS_CODE 	= PNT.GOODS_CODE)
		           
	   UNION ALL
	   
	    SELECT 'D' AS PROC_GB
	         , PN.NOTICE_NO
	         , TPA.PA_GROUP_CODE
	         , TPA.GOODS_CODE
	         , PN.NOTICE_BDATE
	         , PN.NOTICE_EDATE
	      FROM TPANOTICEM PN
	         , TPANOTICEAPPLY TPA
	         , TPAGOODS PG
	     WHERE PN.NOTICE_NO   = TPA.NOTICE_NO
	       AND TPA.GOODS_CODE = PG.GOODS_CODE
	       AND TPA.PA_GROUP_CODE IN ('04','10')
	       AND (PN.NOTICE_EDATE &lt; SYSDATE
	                OR PN.USE_CODE &lt;> '00'
	                OR NOT EXISTS ( SELECT 1
				                      FROM TPANOTICETARGET PNT
				                     WHERE PNT.NOTICE_NO  = TPA.NOTICE_NO
				                       AND PNT.GOODS_CODE = TPA.GOODS_CODE )
         	   )
    </select>
    
    <insert id="insertPaNoticeApply" parameterType="com.cware.netshopping.domain.PaNoticeApplyVO" >
		INSERT INTO TPANOTICEAPPLY( /* pacommon.xml : pacommon.common.insertPaNoticeApply */
		        NOTICE_NO
		      , PA_GROUP_CODE
		      , GOODS_CODE
		      , INSERT_ID
		      , INSERT_DATE
		      , MODIFY_ID
		      , MODIFY_DATE
		        )
			VALUES(
	            #{noticeNo    , jdbcType=VARCHAR}
	          , #{paGroupCode ,	jdbcType=VARCHAR}
	          , #{goodsCode   , jdbcType=VARCHAR}      
	          , 'SYSTEM'
	          , SYSDATE
	          , 'SYSTEM'
	          , SYSDATE
	          )
    </insert>
    
    <delete id="deletePaNoticeApply" parameterType="String">
        DELETE /* pacommon.xml : pacommon.common.deletePaNoticeApply */ 
          FROM TPANOTICEAPPLY
         WHERE NOTICE_NO     = #{noticeNo    , jdbcType=VARCHAR}
           AND PA_GROUP_CODE = #{paGroupCode , jdbcType=VARCHAR}          
           AND GOODS_CODE 	 = #{goodsCode   , jdbcType=VARCHAR}
    </delete>
    
	<insert id="insertPaKakaoGoods" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaKakaoGoods by PaCommonController */
			   TPAKAKAOGOODS( PA_CODE
                           , GOODS_CODE
                           , GOODS_NAME
                           , PA_GROUP_CODE
                           , PA_SALE_GB
                           , PA_STATUS
                           , CATEGORY_ID
                           , MANUFACTURER
                           , BRAND
                           , PRODUCT_ORGIN_AREA_INFO
                           , TRANS_TARGET_YN
                           , TRANS_SALE_YN
                           , INSERT_ID
                           , INSERT_DATE
                           , MODIFY_ID
                           , MODIFY_DATE
                           , MASS_TARGET_YN
                           , MASS_TARGET_CODE                                 
                           )
                    VALUES ( #{paCode,      jdbcType=VARCHAR}
                           , #{goodsCode,   jdbcType=VARCHAR}
                           , #{goodsNameMc, jdbcType=VARCHAR}
                           , #{paGroupCode, jdbcType=VARCHAR}
                           , '20'
                           , '10'
                           , #{paLmsdKey,   jdbcType=VARCHAR}
                           , #{makerNo,   jdbcType=VARCHAR}
                           , #{brandNo, jdbcType=VARCHAR}
                           , #{paOriginCode, jdbcType=VARCHAR}
                           , '1'
                           , '0'
                           , '999999'
                           , SYSDATE
                           , '999999'
                           , SYSDATE
                           , NVL(#{massTargetYn		, jdbcType=VARCHAR},'0')
                           , #{massTargetCode	, jdbcType=VARCHAR}                             
                           )
	</insert>
	
    <update id="updateKakaoTrans" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updateKakaoTrans by PaCommonController */
        	   TPAKAKAOGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
	</update>
	
	<update id="updatePaKakaoGoodsSync" parameterType="com.cware.netshopping.domain.model.SpPaGoodsInfo">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaKakaoGoodsSync by PaCommonController */
        	   TPAKAKAOGOODS TPK
           SET TPK.TRANS_TARGET_YN = '1'
           	 , TPK.BRAND    	  = NVL((SELECT BM.PA_BRAND_NO FROM TPABRANDMAPPING BM  WHERE BM.BRAND_CODE = #{newBrandCode, jdbcType=VARCHAR} AND BM.PA_GROUP_CODE = TPK.PA_GROUP_CODE), '9999')
             , TPK.PRODUCT_ORGIN_AREA_INFO = NVL((SELECT OM.PA_ORIGIN_CODE FROM TPAORIGINMAPPING OM WHERE OM.ORIGIN_CODE = #{newOriginCode,  jdbcType=VARCHAR} AND OM.PA_GROUP_CODE = TPK.PA_GROUP_CODE),'1000')
    	     , TPK.GOODS_NAME	  = #{newGoodsNameMc, jdbcType=VARCHAR}
             , TPK.MODIFY_DATE 	  = SYSDATE
         WHERE TPK.GOODS_CODE  	  = #{goodsCode, jdbcType=VARCHAR}
	</update>
	
	<insert id="insertPaKakaoGoodsImage" parameterType="com.cware.netshopping.domain.model.PaGoodsTargetRec">
		INSERT INTO /* pacommon.xml: pacommon.pacommon.insertPaKakaoGoodsImage by PaCommonController */
			   TPAKAKAOGOODSIMAGE 
			SELECT PA_GROUP_CODE
				 , GOODS_CODE
				 , IMAGE_GB
				 , IMAGE_URL
				 , STOA_IMAGE
				 , '' AS KAKAO_IMAGE
				 , null AS UPLOAD_DATE
				 , '00' AS UPLOAD_STATUS
				 , '999999' AS INSERT_ID
				 , SYSDATE AS INSERT_DATE
				 , '999999' AS MODIFY_ID
				 , SYSDATE AS MODIFY_DATE
			  FROM ( SELECT B.PA_GROUP_CODE
						  , B.GOODS_CODE
						  , A.CODE_MGROUP AS IMAGE_GB
						  , B.IMAGE_URL
						  , DECODE(A.CODE_MGROUP, 'P', IMAGE_P, 'AP', IMAGE_AP, 'BP', IMAGE_BP, 'CP', IMAGE_CP, 'DP', IMAGE_DP, NULL) AS STOA_IMAGE
					   FROM TCODE A
						  , TPAGOODSIMAGE B
					   WHERE A.CODE_LGROUP = 'O701'
						 AND B.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
						 AND B.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				   ) WHERE STOA_IMAGE IS NOT NULL
	</insert>
	
	<update id="updatePaKakaoGoodsSaleGb" parameterType="hashMap">
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaSsgGoodsSaleGb by PaCommonController */
        	   TPAKAKAOGOODS KG
           SET KG.PA_SALE_GB    = '30'
             , KG.TRANS_SALE_YN = '1'
             , KG.MODIFY_DATE   = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , KG.MODIFY_ID     = '999999'
         WHERE KG.GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </update>
	
    <delete id="deletePaKakaoGoodsImage" parameterType="hashMap">
        DELETE /* pacommon.xml : pacommon.common.deletePaKakaoGoodsImage */ 
          FROM TPAKAKAOGOODSIMAGE
         WHERE PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
           AND GOODS_CODE    = #{goodsCode, jdbcType=VARCHAR}
    </delete>
    
    <update id="updateKakaoStopSale" parameterType="hashMap">
        UPDATE /* pacommon.xml : pacommon.common.updateKakaoStopSale */
               TPAKAKAOGOODS CG
		   SET CG.PA_SALE_GB      = '30'
			 , CG.TRANS_SALE_YN   = '1'
			 , CG.MODIFY_ID       = #{userId, jdbcType=VARCHAR}
			 , CG.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
		 WHERE CG.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
		   AND CG.PA_CODE         = #{paCode, jdbcType=VARCHAR}
		   AND CG.PA_SALE_GB      = '20'
		   AND CG.PA_STATUS       = '30'
    </update>
    
    <select id="selectCurKakaoShipStopSaleList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectCurKakaoShipStopSaleList */ 
			   PG.GOODS_CODE
			 , SG.PA_CODE
			 , NVL(SG.PRODUCT_ID, SG.GOODS_CODE) AS PA_GOODS_CODE
		  FROM TPAGOODS     PG
			 , TPAKAKAOGOODS  SG
			 , TGOODS       GD
		 WHERE PG.GOODS_CODE     = SG.GOODS_CODE
		   AND PG.GOODS_CODE     = GD.GOODS_CODE
		   AND SG.PA_SALE_GB     = '20'
		   AND SG.PA_STATUS      = '30'
		   AND SG.PA_CODE        = #{paCode, jdbcType=VARCHAR}
		   AND DECODE(GD.DELY_TYPE, '10', '100001', PG.ENTP_CODE) = #{entpCode, jdbcType=VARCHAR}
		   AND PG.SHIP_COST_CODE = #{shipCostCode, jdbcType=VARCHAR}
    </select>
    
    <select id="selectKakaoCurSaleStopList" parameterType="hashMap" resultType="hashMap">
        SELECT /* pacommon.xml : pacommon.common.selectKakaoCurSaleStopList */ 
			   XA.GOODS_CODE
			 , XA.PA_SALE_GB
			 , XA.PA_CODE
			 , XA.PA_GOODS_CODE
		  FROM ( SELECT GD.GOODS_CODE
					  , FUN_GET_PA_SALE_GB(GD.SALE_GB, GD.SALE_START_DATE, GD.SALE_END_DATE) AS PA_SALE_GB
					  , PG.PA_SALE_GB                                                        AS OLD_SALE_GB
					  , PG.PA_CODE
					  , NVL(PG.PRODUCT_ID, PG.GOODS_CODE) AS PA_GOODS_CODE
				   FROM TGOODS        GD
					  , TPAKAKAOGOODS  PG
				  WHERE GD.GOODS_CODE     = PG.GOODS_CODE
					AND GD.SALE_GB       &lt;&gt; '00'
					AND PG.PA_SALE_GB = '20'
					AND PG.PA_STATUS  = '30'
				<if test='goodsCode != null and goodsCode != ""'>
					AND GD.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
				</if>
					AND GD.MODIFY_DATE &gt; SYSDATE - 30 ) XA
    </select>
    
    <insert id="insertTPaRetentionGoods" parameterType="hashMap" >
		INSERT INTO TPARETENTIONGOODS( /* pacommon.xml : pacommon.common.insertTPaRetentionGoods */
	         PA_CODE
	       , PA_GROUP_CODE
	       , GOODS_CODE
	       , PA_GOODS_CODE
	       , SEQ
	       , STATUS
	       , MEMO
	       , TARGET_YN
	       , INSERT_ID
	       , INSERT_DATE
	        )
		VALUES
           ( #{paCode			,   jdbcType=VARCHAR}
           , #{paGroupCode		,   jdbcType=VARCHAR}
           , #{goodsCode		,   jdbcType=VARCHAR}
           , #{paGoodsCode		,   jdbcType=VARCHAR}
           , (SELECT NVL(LPAD(TO_CHAR(MAX(TO_NUMBER(SD.SEQ)) + 1), 5, '0'), '00001') 
			    FROM TPARETENTIONGOODS SD
			   WHERE SD.PA_CODE			= #{paCode		, jdbcType=VARCHAR}
			     AND SD.GOODS_CODE		= #{goodsCode	, jdbcType=VARCHAR}
			     AND SD.PA_GROUP_CODE	= #{paGroupCode	, jdbcType=VARCHAR} 
	    	 ) 
           , #{status	,   jdbcType=VARCHAR}
           , #{memo		,   jdbcType=VARCHAR}
           , #{targetYn	,   jdbcType=VARCHAR}
           , 'BATCH'
           , SYSDATE
            )
    </insert>
    
	<select id="selectPaRetentionGoodsList" parameterType="hashMap" resultType="hashMap">
		SELECT SG.PA_CODE
			 , SG.PA_GROUP_CODE
			 , SG.GOODS_CODE
			 , SG.STATUS
		  FROM TPARETENTIONGOODS SG
		 WHERE SG.TRANS_TARGET_YN = '1'
		   AND SG.SEQ = (SELECT MAX(GS.SEQ)
		   				   FROM TPARETENTIONGOODS GS
		   				  WHERE GS.PA_CODE	 		= SG.PA_CODE
		   				    AND GS.PA_GROUP_CODE 	= SG.PA_GROUP_CODE
		   				    AND GS.GOODS_CODE		= SG.GOODS_CODE )
	</select>	
	
	<select id="selectPaRetentionGoodsCnt" parameterType="hashMap" resultType="int">
		SELECT COUNT(1)
		  FROM TPARETENTIONGOODS SG
		 WHERE SG.TRANS_TARGET_YN = '1'
		   AND SG.PA_CODE	    = #{paCode 		, jdbcType=VARCHAR}
		   AND SG.GOODS_CODE    = #{goodsCode 	, jdbcType=VARCHAR}
		   AND SG.PA_GROUP_CODE = #{paGroupCode , jdbcType=VARCHAR}
	</select>
	
	<update id="execSP_PA_GOODS_RESET" statementType="CALLABLE" parameterType="hashMap">
        {call SP_PA_GOODS_RESET(
                           #{goodsCode		, 	jdbcType=VARCHAR, mode=IN},
                           #{paGroupCode	,   jdbcType=VARCHAR, mode=IN},
                           #{argModCase		,   jdbcType=VARCHAR, mode=IN},
                           #{out_code		,   jdbcType=NUMERIC, mode=OUT},
                           #{out_msg		,   jdbcType=VARCHAR, mode=OUT}
                           )}
    </update>
	
    <update id="updatePaSsgGoodsFoodSync" parameterType="hashMap" >
        UPDATE /* pacommon.xml: pacommon.pacommon.updatePaSsgGoodsFoodSync by PaCommonController */
               TPASSGGOODS P
           SET P.TRANS_TARGET_YN = '1'
             , P.MODIFY_ID       = '999999'
             , P.MODIFY_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
             , P.LAST_FOOD_SYNC_DATE     = TO_DATE(#{dateTime, jdbcType=VARCHAR}, 'YYYY/MM/DD HH24:MI:SS')
         WHERE P.GOODS_CODE      = #{goodsCode, jdbcType=VARCHAR}
    </update>

    <select id="selectPromoMarginExceptYn" parameterType="hashMap" resultType="int">
		SELECT /* pacommon.xml: pacommon.pacommon.selectPromoMarginExceptYn by PaCommonController */
		       COUNT(1)
		  FROM TPAPROMOMARGINEXCEPT TPM
		 WHERE TPM.GOODS_CODE    = #{goodsCode	, jdbcType=VARCHAR}
		   AND TPM.PA_GROUP_CODE = #{paGroupCode, jdbcType=VARCHAR}
		   AND TPM.USE_YN        = '1' 
	</select>

	<select id="selectPaMinMarginRate" parameterType="hashMap" resultType="String">
        SELECT /* pacommon.xml : pacommon.pacommon.selectPaMinMarginRate by PaCommonDAO */
        	   TPM.MIN_MARGIN_RATE
          FROM TPAPROMOMINMARGINRATE TPM
         WHERE TPM.PA_GROUP_CODE = #{paGroupCode , jdbcType=VARCHAR}
           AND TPM.PA_CODE 		 = #{paCode 	 , jdbcType=VARCHAR}
           AND ROWNUM = 1
    </select>
    
    <select id="selectPaSsgGoodsCollectYnCheck" parameterType="hashMap" resultType="int">
        SELECT /* pacommon.xml: pacommon.pacommon.selectPaSsgGoodsCollectYnCheck by PaCommonController */
               COUNT(1)
          FROM TGOODS T 
             , TPAGOODSTARGET GT
         WHERE T.GOODS_CODE = GT.GOODS_CODE
           AND T.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
           AND T.COLLECT_YN = '1'
           AND GT.PA_GROUP_CODE = '10'
           AND GT.PA_GOODS_CODE IS NULL
           AND GT.PA_SALE_GB IS NULL 
    </select>
    
    <select id="selectPaSsgCollectGoodsList" parameterType="hashMap" resultType="com.cware.netshopping.domain.PaSsgGoodsVO">
        SELECT /* pacommon.xml: pacommon.pacommon.selectPaSsgCollectGoodsList by PaCommonController */
               SG.PA_CODE
             , SG.GOODS_CODE
             , SG.ITEM_ID
          FROM TGOODS T
             , TPASSGGOODS SG
         WHERE T.GOODS_CODE = SG.GOODS_CODE
           AND SG.PA_SALE_GB = '20'
           AND SG.PA_STATUS = '30'
           AND SG.ITEM_ID IS NOT NULL
           AND T.COLLECT_YN = '1'
           <if test='goodsCode != null and goodsCode != "" '>
             AND T.GOODS_CODE = #{goodsCode, jdbcType=VARCHAR}
           </if>
    </select>
    
    <select id="selectOrderGoodsListDt" parameterType="string" resultType="hashMap">
        SELECT /* pacommon.xml: pacommon.pacommon.selectOrderGoodsListDt by PaCommonController */
                 A.GOODS_CODE,
                 A.GOODSDT_CODE
            FROM TORDERDT A, TGOODS B, TGOODSDT C
           WHERE A.ORDER_NO = #{ORDER_NO,jdbcType=VARCHAR}
             AND A.ORDER_G_SEQ = #{ORDER_G_SEQ,jdbcType=VARCHAR}
             AND A.GOODS_CODE = B.GOODS_CODE
             AND B.GIFT_YN = '0'
             AND B.GOODS_CODE = C.GOODS_CODE
             AND A.GOODSDT_CODE = C.GOODSDT_CODE
             AND C.SALE_GB = '00'
    </select>
    
    <update id="updateSalesNoGoodsdt" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TGOODSDT SET /* pacommon.xml: pacommon.pacommon.updateSalesNoGoodsdt by PaCommonController */
                 SALE_GB        = #{saleGb,jdbcType=VARCHAR},
                 MODIFY_DATE    = #{modifyDate,jdbcType=TIMESTAMP},
                 MODIFY_ID      = #{modifyId,jdbcType=VARCHAR}
           where GOODS_CODE     = #{goodsCode,jdbcType=VARCHAR}
             and GOODSDT_CODE   = #{goodsdtCode,jdbcType=VARCHAR}
    </update>
    
    <insert id="insertSalenogoods" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
        <selectKey keyProperty="saleNoSeq" resultType="string" order="BEFORE">
	        SELECT NVL(LPAD(MAX(TO_NUMBER(SALE_NO_SEQ) + 1),'5','0'),'00001')
			  FROM TSALENOGOODS
			 WHERE GOODS_CODE = #{goodsCode,jdbcType=VARCHAR}
			   AND GOODSDT_CODE = #{goodsdtCode,jdbcType=VARCHAR}
	    </selectKey>
	    
        insert INTO TSALENOGOODS ( /* pacommon.xml: pacommon.pacommon.insertSalenogoods by PaCommonController*/
                                  GOODS_CODE,
                                  GOODSDT_CODE,
                                  SALE_NO_SEQ,
                                  SALE_GB,
                                  INSERT_DATE,
                                  INSERT_ID )
                        VALUES (
                                #{goodsCode,jdbcType=VARCHAR},
                                #{goodsdtCode,jdbcType=VARCHAR},
                                #{saleNoSeq,jdbcType=VARCHAR},
                                #{saleGb,jdbcType=VARCHAR},
                                #{insertDate,jdbcType=TIMESTAMP},
                                #{insertId,jdbcType=VARCHAR})

    </insert>
    
    <select id="getSaleGb"  parameterType="string" resultType="string">
          SELECT /* pacommon.xml: pacommon.pacommon.getSaleGb by PaCommonController */
                 MIN(B.SALE_GB) AS SALE_GB
            FROM TGOODS   A,
                 TGOODSDT B
           WHERE A.GOODS_CODE  = B.GOODS_CODE
             AND A.GOODS_CODE = #{goods_code,jdbcType=VARCHAR}
             AND B.GOODSDT_CODE != '000'
    </select>
    
    <update id="updateGoodsSaleGb" parameterType="hashMap">
          update TGOODS SET /*pacommon.xml: pacommon.pacommon.updateGoodsSaleGb by PaCommonController */
                 SALE_GB     = #{saleGbGoods,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP},
                 MODIFY_ID   = #{modifyId,jdbcType=VARCHAR}
           WHERE GOODS_CODE  = #{goods_code,jdbcType=VARCHAR}
    </update>
    
    <select id="getCgCnt"  parameterType="string" resultType="int">
         select /* pacommon.xml: pacommon.pacommon.getCgCnt by PaCommonController */
                 COUNT(*) AS CNT
           FROM  TCATEGORYGOODS
          WHERE  DISPLAY_YN = '1'
            AND  GOODS_CODE = #{goods_code,jdbcType=VARCHAR}
    </select>
    
    <select id="selectCgList"  parameterType="hashMap" resultType="hashMap">
         select /*  pacommon.xml: pacommon.pacommon.selectCgList by PaCommonController */
                CATEGORY_CODE
           FROM TCATEGORYGOODS
           WHERE DISPLAY_YN  = '1'
             AND GOODS_CODE  = #{goods_code,jdbcType=VARCHAR}
    </select>
    
    <update id="updateCategory" databaseId="Oracle" parameterType="string">
          update TCATEGORY SET /* pacommon.xml: pacommon.pacommon.updateCategory by PaCommonController */
                 DISPLAY_GOODS_CNT = DISPLAY_GOODS_CNT - 1
           WHERE CATEGORY_CODE IN ( SELECT CATEGORY_CODE
                                      FROM TCATEGORY
                                   CONNECT BY
                                     PRIOR P_CATEGORY_CODE = CATEGORY_CODE
                                     START WITH CATEGORY_CODE = #{category_code,jdbcType=VARCHAR}
                                   )
    </update>
    
    <update id="updateCategorygoods" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TCATEGORYGOODS SET /*  pacommon.xml: pacommon.pacommon.updateCategorygoods  */
                 DISPLAY_YN = '0',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update>
    
    <update id="updatePresentation" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TPRESENTATION SET /*  pacommon.xml: pacommon.pacommon.updatePresentation */
                 DISPLAY_YN = '0',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update>
    
    <select id="getScgCnt"  parameterType="string" resultType="int">
         select /*  pacommon.xml: pacommon.pacommon.getScgCnt */
                COUNT(*) AS CNT
           FROM  TSCATEGORYGOODS
          WHERE  DISPLAY_YN = '1'
            AND  GOODS_CODE = #{goods_code,jdbcType=VARCHAR}
    </select>
    
    <select id="selectScgList"  parameterType="hashMap" resultType="hashMap">
         select /*  pacommon.xml: pacommon.pacommon.selectScgList */
                CATEGORY_CODE
           FROM TSCATEGORYGOODS
           WHERE DISPLAY_YN  = '1'
             AND GOODS_CODE  = #{goods_code,jdbcType=VARCHAR}
    </select>
    
    <update id="updateStcategory" databaseId="Oracle" parameterType="string">
          update TSCATEGORY SET /*  pacommon.xml: pacommon.pacommon.updateStcategory */
                 DISPLAY_GOODS_CNT = DISPLAY_GOODS_CNT - 1
           WHERE CATEGORY_CODE IN ( SELECT CATEGORY_CODE
                                      FROM TSCATEGORY
                                   CONNECT BY
                                     PRIOR P_CATEGORY_CODE = CATEGORY_CODE
                                     START WITH CATEGORY_CODE = #{category_code,jdbcType=VARCHAR}
                                   )
    </update>
    
    <update id="updateStcategorygoods" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TSCATEGORYGOODS SET /*  pacommon.xml: pacommon.pacommon.updateStcategorygoods */
                 DISPLAY_YN = '0',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update> 
    
    <update id="updateStpresentation" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TSPRESENTATION SET /*  pacommon.xml: pacommon.pacommon.updateStpresentation */
                 DISPLAY_YN = '0',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update>
    
    <select id="getCgCnt2"  parameterType="string" resultType="int">
         select /*  pacommon.xml: pacommon.pacommon.getCgCnt2 */
                 COUNT(*) AS CNT
           FROM  TCATEGORYGOODS
          WHERE  DISPLAY_YN = '0'
            AND  GOODS_CODE = #{goods_code,jdbcType=VARCHAR}
    </select>
    
    <select id="selectCgList2"  parameterType="hashMap" resultType="hashMap">
         select /*  pacommon.xml: pacommon.pacommon.selectCgList2 */
                CATEGORY_CODE
           FROM TCATEGORYGOODS
           WHERE DISPLAY_YN  = '0'
             AND GOODS_CODE  = #{goods_code,jdbcType=VARCHAR}
    </select>   
    
    <update id="updateCategory2" databaseId="Oracle" parameterType="string">
          update TCATEGORY SET  /*  pacommon.xml: pacommon.pacommon.updateCategory2 */
                 DISPLAY_GOODS_CNT = DISPLAY_GOODS_CNT + 1
           WHERE CATEGORY_CODE IN ( SELECT CATEGORY_CODE
                                      FROM TCATEGORY
                                   CONNECT BY
                                     PRIOR P_CATEGORY_CODE = CATEGORY_CODE
                                     START WITH CATEGORY_CODE = #{category_code,jdbcType=VARCHAR}
                                   )
    </update>
    
    <update id="updateCategorygoods2" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TCATEGORYGOODS SET  /*  pacommon.xml: pacommon.pacommon.updateCategorygoods2 */
                 DISPLAY_YN = '1',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update>    
    
    <update id="updatePresentation2" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TPRESENTATION SET /* pacommon.xml: pacommon.pacommon.updatePresentation2 */
                 DISPLAY_YN = '1',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update>
    
    <select id="getScgCnt2"  parameterType="string" resultType="int">
         select /* pacommon.xml: pacommon.pacommon.getScgCnt2 */
                COUNT(*) AS CNT
           FROM  TSCATEGORYGOODS
          WHERE  DISPLAY_YN = '0'
            AND  GOODS_CODE = #{goods_code,jdbcType=VARCHAR}
    </select>
    
    <select id="selectScgList2"  parameterType="hashMap" resultType="hashMap">
         select /*  pacommon.xml: pacommon.pacommon.selectScgList2 */
                CATEGORY_CODE
           FROM TSCATEGORYGOODS
           WHERE DISPLAY_YN  = '0'
             AND GOODS_CODE  = #{goods_code,jdbcType=VARCHAR}
    </select>
    
    <update id="updateStcategory2" databaseId="Oracle" parameterType="string">
          update TSCATEGORY SET /*  pacommon.xml: pacommon.pacommon.updateStcategory2 */
                 DISPLAY_GOODS_CNT = DISPLAY_GOODS_CNT + 1
           WHERE CATEGORY_CODE IN ( SELECT CATEGORY_CODE
                                      FROM TSCATEGORY
                                   CONNECT BY
                                     PRIOR P_CATEGORY_CODE = CATEGORY_CODE
                                     START WITH CATEGORY_CODE = #{category_code,jdbcType=VARCHAR}
                                   )
    </update>
    
    <update id="updateStcategorygoods2" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TSCATEGORYGOODS SET /*  pacommon.xml: pacommon.pacommon.updateStcategorygoods2*/
                 DISPLAY_YN = '1',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update>
    
    <update id="updateStpresentation2" parameterType="com.cware.netshopping.domain.model.SaleNoGoods">
          update TSPRESENTATION SET /*  pacommon.xml: pacommon.pacommon.updateStpresentation2*/
                 DISPLAY_YN = '1',
                 MODIFY_ID  = #{modifyId,jdbcType=VARCHAR},
                 MODIFY_DATE = #{modifyDate,jdbcType=TIMESTAMP}
           WHERE GOODS_CODE  = #{goodsCode,jdbcType=VARCHAR}
    </update>
    
    <select id="getSetgoods"  parameterType="hashMap" resultType="hashMap">
         select /*  pacommon.xml: pacommon.pacommon.getSetgoods*/
                A.GOODS_CODE AS SET_GOODS_CODE,
                B.GOODSDT_CODE AS SET_GOODSDT_CODE,
                MAX(C.SALE_GB) AS SALE_GB
           FROM TSETGOODS A,
                TGOODSDT B,
                TGOODS C
          WHERE A.GOODS_CODE = B.GOODS_CODE
            AND A.IN_GOODS_CODE = C.GOODS_CODE
            AND A.GOODS_CODE IN (SELECT GOODS_CODE
                                   FROM TSETGOODS
                                  WHERE IN_GOODS_CODE = #{goods_code,jdbcType=VARCHAR})
       GROUP BY A.GOODS_CODE,
                B.GOODSDT_CODE
       ORDER BY A.GOODS_CODE,
                B.GOODSDT_CODE
    </select>
    
    <insert id="insertMobileOrderCancelHis" parameterType="com.cware.netshopping.domain.model.Mobileordercancelhis" >
        INSERT /*pacommon.xml: pacommon.pacommon.insertMobileOrderCancelHis */ 
               INTO TMOBILEORDERCANCELHIS (
               ORDER_NO
             , ORDER_G_SEQ
             , ORDER_D_SEQ
             , ORDER_W_SEQ
             , GOODS_CODE
             , INSERT_ID
             , INSERT_DATE
             , MODIFY_ID
             , MODIFY_DATE
               )
        VALUES(
               #{orderNo,jdbcType=VARCHAR}
             , #{orderGSeq, jdbcType=VARCHAR}
             , #{orderDSeq, jdbcType=VARCHAR}
             , #{orderWSeq, jdbcType=VARCHAR}
             , (SELECT GOODS_CODE
                  FROM TORDERDT
                 WHERE ORDER_NO = #{orderNo,jdbcType=VARCHAR}
                   AND ORDER_G_SEQ = #{orderGSeq, jdbcType=VARCHAR}
                   AND ORDER_D_SEQ = #{orderDSeq, jdbcType=VARCHAR}
                   AND ORDER_W_SEQ = #{orderWSeq, jdbcType=VARCHAR})
             , #{insertId,jdbcType=VARCHAR}
             , #{insertDate,jdbcType=TIMESTAMP}
             , #{modifyId,jdbcType=VARCHAR}
             , #{modifyDate,jdbcType=TIMESTAMP})
    </insert>
        
    <update id="execSP_PAGOODS_RETENTION" statementType="CALLABLE" parameterType="hashMap">
        {call SP_PAGOODS_RETENTION(
                           #{arg_pa_group_code,   jdbcType=VARCHAR, mode=IN},
                           #{arg_goods_code,   jdbcType=VARCHAR, mode=IN},
                           #{arg_status, jdbcType=VARCHAR, mode=IN},
                           #{rtn_code,   jdbcType=VARCHAR, mode=OUT},
                           #{rtn_msg,   jdbcType=VARCHAR, mode=OUT}
                           )}
       	/* pacommon.xml: pacommon.pacommon.execSP_PAGOODS_RETENTION */ 
    </update>
    
</mapper>